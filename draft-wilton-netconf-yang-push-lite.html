<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>YANG Datastore Telemetry (YANG Push Lite)</title>
<meta content="Robert Wilton" name="author">
<meta content="
       YANG Push Lite is a YANG datastore telemetry solution, as an alternative specification to the Subscribed Notifications and YANG Push solution, specifically optimized for the efficient observability of operational data. 
    " name="description">
<meta content="xml2rfc 3.25.0" name="generator">
<meta content="YANG Push" name="keyword">
<meta content="Observability" name="keyword">
<meta content="Network Telemetry" name="keyword">
<meta content="Operational Data" name="keyword">
<meta content="draft-wilton-netconf-yang-push-lite-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.25.0
    Python 3.12.8
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.5
    lxml 5.3.0
    platformdirs 4.3.6
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.3
    setuptools 70.3.0
    wcwidth 0.2.13
-->
<link href="draft-wilton-netconf-yang-push-lite.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">YANG-Push Lite</td>
<td class="right">January 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Wilton</td>
<td class="center">Expires 27 July 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Configuration</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-wilton-netconf-yang-push-lite-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-01-23" class="published">23 January 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-07-27">27 July 2025</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">R. Wilton</div>
<div class="org">Cisco Systems</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">YANG Datastore Telemetry (YANG Push Lite)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">YANG Push Lite is a YANG datastore telemetry solution, as an alternative specification to the Subscribed Notifications and YANG Push solution, specifically optimized for the efficient observability of operational data.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://rgwilton.github.io/draft-yp-observability/draft-wilton-netconf-yp-observability.html">https://rgwilton.github.io/draft-yp-observability/draft-wilton-netconf-yp-observability.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-wilton-netconf-yang-push-lite/">https://datatracker.ietf.org/doc/draft-wilton-netconf-yang-push-lite/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Network Configuration Working Group mailing list (<span><a href="mailto:netconf@ietf.org">mailto:netconf@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/netconf/">https://mailarchive.ietf.org/arch/browse/netconf/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/netconf/">https://www.ietf.org/mailman/listinfo/netconf/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/rgwilton/draft-yp-observability">https://github.com/rgwilton/draft-yp-observability</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 27 July 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-document-status" class="internal xref">Document Status</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-acknowledgement-to-the-auth" class="internal xref">Acknowledgement to the authors of RFC 8639 and RFC 8641</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-summary-of-open-issues-pote" class="internal xref">Summary of Open Issues &amp; Potential Enhancements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-conventions" class="internal xref">Conventions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-background-and-motivation-f" class="internal xref">Background and Motivation for YANG Push Lite</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-complexities-in-modelling-t" class="internal xref">Complexities in Modelling the Operational State Datastore</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-another-section" class="internal xref">Another section</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-functional-changes-between-" class="internal xref">Functional changes between YANG Push Lite and YANG Push</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.1">
                    <p id="section-toc.1-1.5.2.4.2.1.1"><a href="#section-5.4.1" class="auto internal xref">5.4.1</a>.  <a href="#name-changed-functionality" class="internal xref">Changed Functionality</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.2">
                    <p id="section-toc.1-1.5.2.4.2.2.1"><a href="#section-5.4.2" class="auto internal xref">5.4.2</a>.  <a href="#name-removed-functionality" class="internal xref">Removed Functionality</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.3">
                    <p id="section-toc.1-1.5.2.4.2.3.1"><a href="#section-5.4.3" class="auto internal xref">5.4.3</a>.  <a href="#name-added-functionality" class="internal xref">Added Functionality</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-yang-push-lite-overview" class="internal xref">YANG Push Lite Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-relationship-to-rfc-5277" class="internal xref">Relationship to RFC 5277</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-definitions" class="internal xref">Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-sensor-paths-and-selection-" class="internal xref">Sensor paths and selection filters</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-the-filters-container" class="internal xref">The "filters" Container</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-decomposing-subscriptions" class="internal xref">Decomposing Subscriptions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-datastore-event-streams" class="internal xref">Datastore Event Streams</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-event-records" class="internal xref">Event Records</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1.2.1">
                    <p id="section-toc.1-1.9.2.1.2.1.1"><a href="#section-9.1.1" class="auto internal xref">9.1.1</a>.  <a href="#name-notifications-for-subscribe" class="internal xref">Notifications for Subscribed Content</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-types-of-subscription-event" class="internal xref">Types of subscription event monitoring</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="auto internal xref">9.3</a>.  <a href="#name-periodic-events" class="internal xref">Periodic events</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a href="#section-9.4" class="auto internal xref">9.4</a>.  <a href="#name-on-change-events" class="internal xref">On-Change events</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4.2.1">
                    <p id="section-toc.1-1.9.2.4.2.1.1"><a href="#section-9.4.1" class="auto internal xref">9.4.1</a>.  <a href="#name-on-change-notifiable-datast" class="internal xref">On-Change Notifiable Datastore Nodes</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4.2.2">
                    <p id="section-toc.1-1.9.2.4.2.2.1"><a href="#section-9.4.2" class="auto internal xref">9.4.2</a>.  <a href="#name-on-change-considerations" class="internal xref">On-Change Considerations</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.5">
                <p id="section-toc.1-1.9.2.5.1"><a href="#section-9.5" class="auto internal xref">9.5</a>.  <a href="#name-combined-period-and-on-chan" class="internal xref">Combined period and on-change subscriptions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.6">
                <p id="section-toc.1-1.9.2.6.1"><a href="#section-9.6" class="auto internal xref">9.6</a>.  <a href="#name-streaming-updates" class="internal xref">Streaming Updates</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-receivers" class="internal xref">Receivers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-transports" class="internal xref">Transports</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.1">
                    <p id="section-toc.1-1.10.2.1.2.1.1"><a href="#section-10.1.1" class="auto internal xref">10.1.1</a>.  <a href="#name-requirements-for-yang-push-" class="internal xref">Requirements for Yang Push Lite Transport Specifications</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1.2.2">
                    <p id="section-toc.1-1.10.2.1.2.2.1"><a href="#section-10.1.2" class="auto internal xref">10.1.2</a>.  <a href="#name-transport-connectivity-for-" class="internal xref">Transport Connectivity for a Configured Subscription</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-encodings" class="internal xref">Encodings</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2.2.1">
                    <p id="section-toc.1-1.10.2.2.2.1.1"><a href="#section-10.2.1" class="auto internal xref">10.2.1</a>.  <a href="#name-new-encoding-format" class="internal xref">New encoding format</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2.2.2">
                    <p id="section-toc.1-1.10.2.2.2.2.1"><a href="#section-10.2.2" class="auto internal xref">10.2.2</a>.  <a href="#name-combined-periodic-and-on-ch" class="internal xref">Combined periodic and on-change subscription</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2.2.3">
                    <p id="section-toc.1-1.10.2.2.2.3.1"><a href="#section-10.2.3" class="auto internal xref">10.2.3</a>.  <a href="#name-dscp-marking" class="internal xref">DSCP Marking</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-setting-up-and-managing-sub" class="internal xref">Setting up and Managing Subscriptions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-configured-subscriptions" class="internal xref">Configured Subscriptions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.1">
                    <p id="section-toc.1-1.11.2.1.2.1.1"><a href="#section-11.1.1" class="auto internal xref">11.1.1</a>.  <a href="#name-configured-subscription-sta" class="internal xref">Configured Subscription State Machine</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.2">
                    <p id="section-toc.1-1.11.2.1.2.2.1"><a href="#section-11.1.2" class="auto internal xref">11.1.2</a>.  <a href="#name-creating-a-configured-subsc" class="internal xref">Creating a Configured Subscription</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.3">
                    <p id="section-toc.1-1.11.2.1.2.3.1"><a href="#section-11.1.3" class="auto internal xref">11.1.3</a>.  <a href="#name-modifying-a-configured-subs" class="internal xref">Modifying a Configured Subscription</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.4">
                    <p id="section-toc.1-1.11.2.1.2.4.1"><a href="#section-11.1.4" class="auto internal xref">11.1.4</a>.  <a href="#name-deleting-a-configured-subsc" class="internal xref">Deleting a Configured Subscription</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.5">
                    <p id="section-toc.1-1.11.2.1.2.5.1"><a href="#section-11.1.5" class="auto internal xref">11.1.5</a>.  <a href="#name-resetting-a-configured-subs" class="internal xref">Resetting a Configured Subscription's Receiver</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-dynamic-subscriptions" class="internal xref">Dynamic Subscriptions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.1">
                    <p id="section-toc.1-1.11.2.2.2.1.1"><a href="#section-11.2.1" class="auto internal xref">11.2.1</a>.  <a href="#name-dynamic-subscription-state-" class="internal xref">Dynamic Subscription State Machine</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.2">
                    <p id="section-toc.1-1.11.2.2.2.2.1"><a href="#section-11.2.2" class="auto internal xref">11.2.2</a>.  <a href="#name-establishing-a-dynamic-subs" class="internal xref">Establishing a Dynamic Subscription</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.3">
                    <p id="section-toc.1-1.11.2.2.2.3.1"><a href="#section-11.2.3" class="auto internal xref">11.2.3</a>.  <a href="#name-deleting-a-dynamic-subscrip" class="internal xref">Deleting a Dynamic Subscription</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.4">
                    <p id="section-toc.1-1.11.2.2.2.4.1"><a href="#section-11.2.4" class="auto internal xref">11.2.4</a>.  <a href="#name-killing-a-dynamic-subscript" class="internal xref">Killing a Dynamic Subscription</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.5">
                    <p id="section-toc.1-1.11.2.2.2.5.1"><a href="#section-11.2.5" class="auto internal xref">11.2.5</a>.  <a href="#name-rpc-failures" class="internal xref">RPC Failures</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#section-11.3" class="auto internal xref">11.3</a>.  <a href="#name-implementation-consideratio" class="internal xref">Implementation Considerations (from RFC 8639)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.4">
                <p id="section-toc.1-1.11.2.4.1"><a href="#section-11.4" class="auto internal xref">11.4</a>.  <a href="#name-event-record-delivery" class="internal xref">Event Record Delivery</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-subscription-lifecycle-noti" class="internal xref">Subscription Lifecycle Notifications</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref">12.1</a>.  <a href="#name-subscription-started" class="internal xref">"subscription-started"</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="auto internal xref">12.2</a>.  <a href="#name-subscription-terminated" class="internal xref">"subscription-terminated"</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a href="#section-12.3" class="auto internal xref">12.3</a>.  <a href="#name-replay-completed" class="internal xref">"replay-completed"</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-performance-reliability-and" class="internal xref">Performance, Reliability, and Subscription Monitoring</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="auto internal xref">13.1</a>.  <a href="#name-subscription-monitoring" class="internal xref">Subscription Monitoring</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-13.2" class="auto internal xref">13.2</a>.  <a href="#name-robustness-and-reliability" class="internal xref">Robustness and Reliability</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a href="#section-13.3" class="auto internal xref">13.3</a>.  <a href="#name-publisher-capacity" class="internal xref">Publisher Capacity</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="auto internal xref">14</a>. <a href="#name-conformance-and-capabilitie" class="internal xref">Conformance and Capabilities</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#section-14.1" class="auto internal xref">14.1</a>.  <a href="#name-subscription-content-schema" class="internal xref">Subscription Content Schema Identification</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="auto internal xref">15</a>. <a href="#name-yang" class="internal xref">YANG</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#section-15.1" class="auto internal xref">15.1</a>.  <a href="#name-ietf-yp-lite-yang-tree" class="internal xref">ietf-yp-lite YANG tree</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#section-15.2" class="auto internal xref">15.2</a>.  <a href="#name-ietf-yp-lite-yang-model" class="internal xref">ietf-yp-lite YANG Model</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#section-16" class="auto internal xref">16</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.1">
                <p id="section-toc.1-1.16.2.1.1"><a href="#section-16.1" class="auto internal xref">16.1</a>.  <a href="#name-receiver-authorization" class="internal xref">Receiver Authorization</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.2">
                <p id="section-toc.1-1.16.2.2.1"><a href="#section-16.2" class="auto internal xref">16.2</a>.  <a href="#name-yang-module-security-consid" class="internal xref">YANG Module Security Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#section-17" class="auto internal xref">17</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#section-18" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19">
            <p id="section-toc.1-1.19.1"><a href="#section-19" class="auto internal xref"></a><a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.1">
                <p id="section-toc.1-1.19.2.1.1"><a href="#section-19.1" class="auto internal xref"></a><a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.2">
                <p id="section-toc.1-1.19.2.2.1"><a href="#section-19.2" class="auto internal xref"></a><a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20">
            <p id="section-toc.1-1.20.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-example-configured-transpor" class="internal xref">Example Configured Transport Augmentation (from RFC 8639)</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21">
            <p id="section-toc.1-1.21.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-subscription-errors-from-rf" class="internal xref">Subscription Errors (from RFC 8641)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.1">
                <p id="section-toc.1-1.21.2.1.1"><a href="#appendix-B.1" class="auto internal xref">B.1</a>.  <a href="#name-rpc-failures-2" class="internal xref">RPC Failures</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.2">
                <p id="section-toc.1-1.21.2.2.1"><a href="#appendix-B.2" class="auto internal xref">B.2</a>.  <a href="#name-failure-notifications" class="internal xref">Failure Notifications</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.22">
            <p id="section-toc.1-1.22.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-examples" class="internal xref">Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.22.2.1">
                <p id="section-toc.1-1.22.2.1.1"><a href="#appendix-C.1" class="auto internal xref">C.1</a>.  <a href="#name-example-of-an-style-push-up" class="internal xref">Example of an RFC8641 style push-update notification</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.22.2.2">
                <p id="section-toc.1-1.22.2.2.1"><a href="#appendix-C.2" class="auto internal xref">C.2</a>.  <a href="#name-example-of-periodic-updates" class="internal xref">Example of periodic updates using the new style update message</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.22.2.3">
                <p id="section-toc.1-1.22.2.3.1"><a href="#appendix-C.3" class="auto internal xref">C.3</a>.  <a href="#name-example-of-an-on-change-upd" class="internal xref">Example of an on-change-update notification using the new style update message</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.22.2.4">
                <p id="section-toc.1-1.22.2.4.1"><a href="#appendix-C.4" class="auto internal xref">C.4</a>.  <a href="#name-example-of-an-on-change-del" class="internal xref">Example of an on-change-delete notification using the new style update message</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.22.2.5">
                <p id="section-toc.1-1.22.2.5.1"><a href="#appendix-C.5" class="auto internal xref">C.5</a>.  <a href="#name-subscription-rpc-examples-f" class="internal xref">Subscription RPC examples (from RFC 8641)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.22.2.5.2.1">
                    <p id="section-toc.1-1.22.2.5.2.1.1"><a href="#appendix-C.5.1" class="auto internal xref">C.5.1</a>.  <a href="#name-establish-subscription-rpc" class="internal xref">"establish-subscription" RPC</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.22.2.5.2.2">
                    <p id="section-toc.1-1.22.2.5.2.2.1"><a href="#appendix-C.5.2" class="auto internal xref">C.5.2</a>.  <a href="#name-delete-subscription-rpc" class="internal xref">"delete-subscription" RPC</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.22.2.5.2.3">
                    <p id="section-toc.1-1.22.2.5.2.3.1"><a href="#appendix-C.5.3" class="auto internal xref">C.5.3</a>.  <a href="#name-resync-subscription-rpc" class="internal xref">"resync-subscription" RPC</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.23">
            <p id="section-toc.1-1.23.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-authors-address" class="internal xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="document-status">
<section id="section-1">
      <h2 id="name-document-status">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-document-status" class="section-name selfRef">Document Status</a>
      </h2>
<p id="section-1-1"><em>RFC Editor: If present, please remove this section before publication.</em><a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Based on the feedback received during the IETF 121 NETCONF session, this document has currently been written as a self-contained lightweight protocol and document replacement for <span>[<a href="#RFC8639" class="cite xref">RFC8639</a>]</span> and <span>[<a href="#RFC8641" class="cite xref">RFC8641</a>]</span>, defining a separate configuration data model.<a href="#section-1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledgement-to-the-authors-of-rfc-8639-and-rfc-8641">
<section id="section-2">
      <h2 id="name-acknowledgement-to-the-auth">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-acknowledgement-to-the-auth" class="section-name selfRef">Acknowledgement to the authors of RFC 8639 and RFC 8641</a>
      </h2>
<p id="section-2-1">This document is intended to be a lightweight alternative for <span>[<a href="#RFC8639" class="cite xref">RFC8639</a>]</span> and <span>[<a href="#RFC8641" class="cite xref">RFC8641</a>]</span>, but it intentionally reuses substantial parts of the design and data model of those RFCs.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">For ease of reference, this document, sourced much of the starting text and basis for the <em>yang-push-lite</em> YANG model directly from those RFCs, rather than either starting from scratch or creating a separate document that would contain numerous references back to sections in those RFCs and correspondingly would be hard to read and follow.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">Hence, the authors of this draft would like to sincerely thank and acknowledge the very significant previous effort put into those RFCs by authors, contributors and reviewers.  We would particularly like to thank the authors: Eric Voit, Alex Clemm, Alberto Gonzalez Prieto, Einar Nilsen-Nygaard, Ambika Prasad Tripathy, but also everyone who contributed to the underlying work from which this document is derived.<a href="#section-2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="summary-of-open-issues-potential-enhancements">
<section id="section-3">
      <h2 id="name-summary-of-open-issues-pote">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-summary-of-open-issues-pote" class="section-name selfRef">Summary of Open Issues &amp; Potential Enhancements</a>
      </h2>
<p id="section-3-1">This section lists some other potential issues and enhancements that should be discussed and considered as part of this work.  If there is continued interest in this work, i.e., it becomes adopted, then these should move to github issues.<a href="#section-3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3-2">
<li id="section-3-2.1">
          <p id="section-3-2.1.1">Should we consider a version of the JSON encoding that excludes module prefixes (either everywhere, or perhaps only include the top module prefix).  The reasoning for considering this is to potentially better align the JSON data with how the schema data may be modeled in other data systems, e.g., Kafka.  Obviously, this requires that there be no duplicate data node names in different module namespaces, but most sane device schemas would avoid this anyway.<a href="#section-3-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-3-2.2">
          <p id="section-3-2.2.1">Document how sub-subscriptions can be used to split a higher level subscription into multiple smaller more efficient subscriptions for the device (that can be handled concurrently).<a href="#section-3-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-3-2.3">
          <p id="section-3-2.3.1">Currently the encoding and transport parameters are per subscription, but it may make more sense for these to be per receiver definition.  I.e., if you want to use different transports and encodings to the same receiver this should still be possible, but would require a second receiver to be defined with the same destination IP address, but a different name.  Currently, the newly proposed encoding format is configured per subscription (mirroring equivalent transport and encoding configuration), but alternatively it could be configured per receiver.<a href="#section-3-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-3-2.4">
          <p id="section-3-2.4.1">We should consider how a subscription could support multiple subscription paths.  One potential tricky aspect of this is to determine the shared common ancestor path to all the subscriptions.  Related to this is whether XPath 1.0 is the best way of specifying these bind points, or whether it should be modelled as something closer to the NACM node-instance-identifier <span>[<a href="#RFC6536" class="cite xref">RFC6536</a>]</span>, but perhaps using something closer to the JSON style encoding of instance identifier <span>[<a href="#RFC7951" class="cite xref">RFC7951</a>]</span>, section 6.11; or JSON PATH <span>[<a href="#RFC9535" class="cite xref">RFC9535</a>]</span>.<a href="#section-3-2.4.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-3-2.5">
          <p id="section-3-2.5.1">We want to align on-change and periodic messages together using the same schema:<a href="#section-3-2.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-2.5.2.1">
              <p id="section-3-2.5.2.1.1">Should on-change deletes be a separate message type, or just contain an empty datastore snapshot?  If it uses the same message then is a separate flag to indicate a delete necessary?<a href="#section-3-2.5.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3-2.5.2.2">
              <p id="section-3-2.5.2.2.1">Should the data be encoded from the root of the tree, or relative to the subscription point?  If it is relative to the subscription point then what does<a href="#section-3-2.5.2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
        <li id="section-3-2.6">
          <p id="section-3-2.6.1">What level of subscription filtering do we need and want to support?  For example, I doubt that anyone allows for full XPath filtering of operational data subscriptions because they are likely to be very computationally expensive to implement.  Is there an easier way of expressing the filter requirements rather than using subtree filtering.  Note, this could be added in a future release.<a href="#section-3-2.6.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-3-2.7">
          <p id="section-3-2.7.1">Do we need to fold in any text from RFC 8640? and RESTCONF.  I.e., there was this text in the one of the previous docs:   Bindings for subscribed event record delivery for NETCONF and RESTCONF are defined in <span>[<a href="#RFC8640" class="cite xref">RFC8640</a>]</span> and [RESTCONF-Notif], respectively.<a href="#section-3-2.7.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-3-2.8">
          <p id="section-3-2.8.1">Handling lists with separate producers of list entries.<a href="#section-3-2.8.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-3-2.9">
          <p id="section-3-2.9.1">Do we need to allow a dynamic subscription to be modified?  If we do, then it would be better to change the establish-subscription RPC to have an optional existing subscription-id rather than define a separate RPC.  I would propose that such a modify-subscription would be equivalent to deleting and recreating a subscription other than reusing the same subscription-id.<a href="#section-3-2.9.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-3-2.10">
          <p id="section-3-2.10.1">Should we allow for strings names rather than numeric ids for configured subscriptions?<a href="#section-3-2.10.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-3-2.11">
          <p id="section-3-2.11.1">Should DSCP marking be configured under the receiver or the subscription?  Or perhaps in both places with DSCP marking at the subscription overriding a default set on the receiver?<a href="#section-3-2.11.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-3-2.12">
          <p id="section-3-2.12.1">When a subscription is terminated, should be <span class="bcp14">MUST NOT</span> send any more notifications after the terminated message, or <span class="bcp14">SHOULD NOT</span>?  For a dynamic subscription, should the RPC be synchronous and not reply until it knows that all queues have been drained?<a href="#section-3-2.12.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-3-2.13">
          <p id="section-3-2.13.1">If a subscription references a filter, then should that be included inline in the subscription started notification (as per the RFC 8641 text), or should it indicate that it is a referenced filter?<a href="#section-3-2.13.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-3-2.14">
          <p id="section-3-2.14.1">Check agree that if a subscription has multiple receivers, then the encoding (and transport and dscp markings???) for all of those receivers must be the same.<a href="#section-3-2.14.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-3-2.15">
          <p id="section-3-2.15.1">We should allow devices to limit which datastores subscriptions can be made against (e.g., not candidate or factory-default as some obvious examples).  Should these be advertised in the capabilities?<a href="#section-3-2.15.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-3-2.16">
          <p id="section-3-2.16.1">If this work progresses we want to create bis versions of the transports so that they augment into the new data model paths.<a href="#section-3-2.16.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-3-2.17">
          <p id="section-3-2.17.1">I've introduced a new basic path filter<a href="#section-3-2.17.1" class="pilcrow">¶</a></p>
</li>
      </ol>
</section>
</div>
<div id="conventions">
<section id="section-4">
      <h2 id="name-conventions">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-conventions" class="section-name selfRef">Conventions</a>
      </h2>
<p id="section-4-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">All <em>YANG tree diagrams</em> used in this document follow the notation
defined in <span>[<a href="#RFC8340" class="cite xref">RFC8340</a>]</span>.<a href="#section-4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="introduction">
<section id="section-5">
      <h2 id="name-introduction">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-5-1"><span>[<a href="#I-D.ietf-nmop-yang-message-broker-integration" class="cite xref">I-D.ietf-nmop-yang-message-broker-integration</a>]</span> describes an architecture for how YANG datastore telemetry, e.g., <span>[<a href="#RFC8641" class="cite xref">RFC8641</a>]</span>, can be integrated effectively with message brokers, e.g., <span>[<a href="#Kafka" class="cite xref">Kafka</a>]</span>, that forms part of a wider architecture for a <em>Network Anomaly Detection Framework</em>, specified in <span>[<a href="#I-D.ietf-nmop-network-anomaly-architecture" class="cite xref">I-D.ietf-nmop-network-anomaly-architecture</a>]</span>.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">This document specifies "YANG Push Lite", an lightweight alternative to Subscribed Notifications <span>[<a href="#RFC8639" class="cite xref">RFC8639</a>]</span> and YANG Push <span>[<a href="#RFC8641" class="cite xref">RFC8641</a>]</span>. This document specifies a separate YANG datastore telemetry solution, which can be implemented independently, and if desired alongside <span>[<a href="#RFC8639" class="cite xref">RFC8639</a>]</span> and <span>[<a href="#RFC8641" class="cite xref">RFC8641</a>]</span>.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">At a high level, YANG Push Lite is designed to solve a similar set of requirements as YANG Push, and it reuses a significant amount of the ideas and solution from YANG Push.  YANG Push Lite defines a separate data model to allow concurrent implementation of both protocols, but many of the data nodes are copied from YANG Push and have the same, or very similar definitions.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">The following sections give the background for the solution, and highlight the key ways that this specification differs from the specifications that is based on.<a href="#section-5-4" class="pilcrow">¶</a></p>
<div id="background-and-motivation-for-yang-push-lite">
<section id="section-5.1">
        <h3 id="name-background-and-motivation-f">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-background-and-motivation-f" class="section-name selfRef">Background and Motivation for YANG Push Lite</a>
        </h3>
<p id="section-5.1-1">A push based telemetry solution, as described both in this document and also the YANG Push solution described by <span>[<a href="#RFC8639" class="cite xref">RFC8639</a>]</span> and <span>[<a href="#RFC8641" class="cite xref">RFC8641</a>]</span>, is beneficial because it allows operational data to be exported by publishers more immediately and efficiently compared to legacy poll based mechanisms, such as SNMP <span>[<a href="#RFC3411" class="cite xref">RFC3411</a>]</span>.  Some further background information on the general motivations for push based telemetry, which equally apply here, can be found in the <em>Motivation</em> (section 1.1) of <span>[<a href="#RFC8639" class="cite xref">RFC8639</a>]</span> and the Introduction (section 1) of <span>[<a href="#RFC8641" class="cite xref">RFC8641</a>]</span>.  The remainder of this section is focused on the reasons why a new lightweight version of YANG Push has been specified, and what problems is aims to solve.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">Early implementation efforts of the <span>[<a href="#I-D.ietf-nmop-yang-message-broker-integration" class="cite xref">I-D.ietf-nmop-yang-message-broker-integration</a>]</span> architecture hit issues with using either of the two common YANG datastore telemetry solutions that have been specified, i.e., YANG Push <span>[<a href="#RFC8641" class="cite xref">RFC8641</a>]</span> or <span>[<a href="#gNMI" class="cite xref">gNMI</a>]</span>.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">gNMI is specified by the OpenConfig Industry Consortium.  It is more widely implemented, but operators report that some inter-operability issues between device implementations cause problems.  Many of the OpenConfig protocols and data models are also expected to evolve more rapidly than IETF protocols and models that are expected to have a more gradual pass of evolution once an RFC has been published.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">YANG Push <span>[<a href="#RFC8641" class="cite xref">RFC8641</a>]</span> was standardized by the IETF in 2019, but market adoption has been rather slow.  In, 2023/2024, where vendors started implementing, or considering implementing, YANG Push, it was seen that some of the ways that the features have been specified in the solution make it expensive and difficult to write performant implementations, particularly when considering the complexities and distributed nature of operational data.  In addition, some design choices of how the data is encoded (e.g., YANG Patch <span>[<a href="#RFC8072" class="cite xref">RFC8072</a>]</span>) make more sense when considering changes in configuration data, but make less sense when the goal is to export a subset of the operational data off the device in an efficient fashion.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5">Hence, during 2024, the vendors and operators working towards YANG telemetry solutions agreed to a plan to implement a subset of <span>[<a href="#RFC8639" class="cite xref">RFC8639</a>]</span> and <span>[<a href="#RFC8641" class="cite xref">RFC8641</a>]</span>, including common agreements of features that are not needed and would not be implemented, and deviations from the standard for some aspects of encoding YANG data.  In addition, the implementation efforts identified the minimal subset of functionality needed to support the initial telemetry use cases, and areas of potential improvement and optimization to the overall YANG Push telemetry solution (which has been written up as a set of small internet drafts).<a href="#section-5.1-5" class="pilcrow">¶</a></p>
<p id="section-5.1-6">Out of these work, consensus was building to specify a cut down version of Subscribed Notifications <span>[<a href="#RFC8639" class="cite xref">RFC8639</a>]</span> and YANG Push <span>[<a href="#RFC8641" class="cite xref">RFC8641</a>]</span> that is both more focussed on the operational telemetry use case, and is also easier to implement, by relaxing some of the constraints on consistency on the device, and removing, or simplifying some of the operational features.  This also resulted in this specification, YANG Push Lite.<a href="#section-5.1-6" class="pilcrow">¶</a></p>
<p id="section-5.1-7">The implementation efforts also gave arise to potential improvements to the protocol and encoding<a href="#section-5.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="OperationalModellingComplexities">
<section id="section-5.2">
        <h3 id="name-complexities-in-modelling-t">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-complexities-in-modelling-t" class="section-name selfRef">Complexities in Modelling the Operational State Datastore</a>
        </h3>
<p id="section-5.2-1">The YANG abstraction of a single datastore of related consistent data works very well for configuration that has a strong requirement to be self consistent, and that is always updated, and validated, in a transactional way.  But for producers of telemetry data, the YANG abstraction of a single operational datastore is not really possible for devices managing a non-trivial quantity of operational data.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">Some systems may store their operational data in a single logical database, yet it is less likely that the operational data can always be updated in a transactional way, and often for memory efficiency reasons such a database does not store individual leaves, but instead semi-consistent records of data at a container or list entry level.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">For other systems, the operational information may be distributed across multiple internal nodes (e.g., linecards), and potentially many different process daemons within those distributed nodes.  Such systems generally cannot exhibit full consistency <span>[<a href="#Consistency" class="cite xref">Consistency</a>]</span> of the operational data (which would require transactional semantics across all daemons and internal nodes), only offering an eventually consistent <span>[<a href="#EventualConsistency" class="cite xref">EventualConsistency</a>]</span> view of the data instead.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4">In practice, many network devices will manage their operational data as a combination of some data being stored in a central operational datastore, and other, higher scale, and potentially more frequently changing data (e.g., statistics or FIB information) being stored elsewhere in a more memory efficient and performant way.<a href="#section-5.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="another-section">
<section id="section-5.3">
        <h3 id="name-another-section">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-another-section" class="section-name selfRef">Another section</a>
        </h3>
<p id="section-5.3-1">YANG-Push is a key part of these architectures, but through experience of implementing YANG-Push specifically for the use cases described in the above architecture documents, it became clear that there are aspects of YANG-Push that are not optimal for these use cases for neither producer or consumer, particular as they relate to operational data.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">For the consumer of the telemetry data, there is a requirement to associate a schema with the instance-data that will be provided by a subscription.  One approach is to fetch and build the entire schema for the device, e.g., by fetching YANG library, and then use the subscription XPath to select the relevant subtree of the schema that applies only to the subscription.  The problem with this approach is that if the schema ever changes, e.g., after a software update, then it is reasonably likely of some changes occurring with the global device schema even if there are no changes to the schema subtree under the subscription path.  Hence, it would be helpful to identify and version the schema associated with a particular subscription path, and also to encoded the instance data relatively to the subscription path rather than as an absolute path from the root of the operational datastore.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="DifferencesFromYangPush">
<section id="section-5.4">
        <h3 id="name-functional-changes-between-">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-functional-changes-between-" class="section-name selfRef">Functional changes between YANG Push Lite and YANG Push</a>
        </h3>
<p id="section-5.4-1">This non-normative section highlights the significant functional changes where the YANG Push Lite implementation differs from YANG Push.  However, in all cases, the text in this document, from <a href="#terminology" class="auto internal xref">Section 7</a> onwards, provides the normative definition of the YANG Push Lite specification, except for any text or sections that explicitly indicate that they are informative rather being normative.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<div id="changed-functionality">
<section id="section-5.4.1">
          <h4 id="name-changed-functionality">
<a href="#section-5.4.1" class="section-number selfRef">5.4.1. </a><a href="#name-changed-functionality" class="section-name selfRef">Changed Functionality</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-5.4.1-1.1">
              <p id="section-5.4.1-1.1.1">All YANG Push Lite notifications messages use <span>[<a href="#I-D.draft-netana-netconf-notif-envelope" class="cite xref">I-D.draft-netana-netconf-notif-envelope</a>]</span> rather than <span>[<a href="#RFC5277" class="cite xref">RFC5277</a>]</span> used by YANG Push.  This does not affect other message streams generated by the device (e.g., YANG Push), that still generate <span>[<a href="#RFC5277" class="cite xref">RFC5277</a>]</span> compliant messages.<a href="#section-5.4.1-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.4.1-1.2">
              <p id="section-5.4.1-1.2.1">Receivers are always configured separately from the subscription and are referenced.<a href="#section-5.4.1-1.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.4.1-1.3">
              <p id="section-5.4.1-1.3.1">Transport and Encoding parameters are configured as part of a receiver definition, and are used by all subscriptions directed towards a given receiver.<a href="#section-5.4.1-1.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.4.1-1.4">
              <p id="section-5.4.1-1.4.1">Although configured subscriptions can still use multiple receivers there are more restrictions on the specification of those receivers.  I.e., they must be configured with the same encoding (<strong>TODO, and perhaps transport and DSCP marking?</strong>).<a href="#section-5.4.1-1.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.4.1-1.5">
              <p id="section-5.4.1-1.5.1">Period and on-change message uses a common message format, allowing for combined period and on-change subscriptions.<a href="#section-5.4.1-1.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.4.1-1.6">
              <p id="section-5.4.1-1.6.1">On-Change dampening.  Rather than be specified by the client, the publisher is allows to rate-limit how frequently on-change events may be delivered for a particular data node that is changing rapidly.  In addition, if the state of a data node changes and changes back over a dampening period, then a publisher is not required to notify the client.<a href="#section-5.4.1-1.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.4.1-1.7">
              <p id="section-5.4.1-1.7.1">Dynamic subscriptions are no longer mandatory to implement, either or both of Configured and Dynamic Subscriptions may be implemented in YANG Push Lite.<a href="#section-5.4.1-1.7.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.4.1-1.8">
              <p id="section-5.4.1-1.8.1">The solution focuses solely on datastore subscriptions that use a standard event stream, which cannot have filtered applied.<a href="#section-5.4.1-1.8.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.4.1-1.9">
              <p id="section-5.4.1-1.9.1">The lifecycle events of when a subscription-started or subscription-terminated may be sent differs from RFC 8639/RFC 8649:<a href="#section-5.4.1-1.9.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4.1-1.9.2.1">
                  <p id="section-5.4.1-1.9.2.1.1">Subscription-started notifications are also sent for dynamic subscriptions.<a href="#section-5.4.1-1.9.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-5.4.1-1.10">
              <p id="section-5.4.1-1.10.1">Some of the requirements on transport have been relaxed.<a href="#section-5.4.1-1.10.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="removed-functionality">
<section id="section-5.4.2">
          <h4 id="name-removed-functionality">
<a href="#section-5.4.2" class="section-number selfRef">5.4.2. </a><a href="#name-removed-functionality" class="section-name selfRef">Removed Functionality</a>
          </h4>
<p id="section-5.4.2-1">This section lists functionality specified in <span>[<a href="#RFC8639" class="cite xref">RFC8639</a>]</span> and YANG Push which is not specified in YANG Push Lite.<a href="#section-5.4.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4.2-2.1">
              <p id="section-5.4.2-2.1.1">Negotiation and hints of failed subscriptions.<a href="#section-5.4.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.4.2-2.2">
              <p id="section-5.4.2-2.2.1">The RPC to modify an existing dynamic subscription, instead the subscription must be terminated and re-established.<a href="#section-5.4.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.4.2-2.3">
              <p id="section-5.4.2-2.3.1">The ability to suspend and resume a dynamic subscription.  Instead a dynamic subscription is terminated if the device cannot reliably fulfill the subscription or a receiver is too slow causing the subscription to be back pressured.<a href="#section-5.4.2-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.4.2-2.4">
              <p id="section-5.4.2-2.4.1">Specifying a subscription stop time, and the corresponding subscription-completed notification have been removed.<a href="#section-5.4.2-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.4.2-2.5">
              <p id="section-5.4.2-2.5.1">Replaying of buffered event records are not supported.  The nearest equivalent is requesting a sync-on-start replay when the subscription transport session comes up which will reply the current state.<a href="#section-5.4.2-2.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.4.2-2.6">
              <p id="section-5.4.2-2.6.1">QoS weighting and dependency has been removed due to the complexity of implementation.<a href="#section-5.4.2-2.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.4.2-2.7">
              <p id="section-5.4.2-2.7.1">Support for reporting subscription error hints has been removed.  The device <span class="bcp14">SHOULD</span> reject subscriptions that are likely to overload the device, but more onus is places on the operator configuring the subscriptions or setting up the dynamic subscriptions to ensure that subscriptions are reasonable, as they would be expected to do for any other configuration.<a href="#section-5.4.2-2.7.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.4.2-2.8">
              <p id="section-5.4.2-2.8.1">The "subscription-state-notif" extension has been removed.<a href="#section-5.4.2-2.8.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="added-functionality">
<section id="section-5.4.3">
          <h4 id="name-added-functionality">
<a href="#section-5.4.3" class="section-number selfRef">5.4.3. </a><a href="#name-added-functionality" class="section-name selfRef">Added Functionality</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-5.4.3-1.1">
              <p id="section-5.4.3-1.1.1">Device capabilities are reported via XXX and additional models that augment that data model.<a href="#section-5.4.3-1.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="overview">
<section id="section-6">
      <h2 id="name-yang-push-lite-overview">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-yang-push-lite-overview" class="section-name selfRef">YANG Push Lite Overview</a>
      </h2>
<p id="section-6-1">This document specifies a lightweight telemetry solution that provides a subscription service for updates from a datastore.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">Subscriptions specify when notification messages (also referred to as <em>push updates</em>) should be sent, what data to include in update records, and where those notifications should be sent to.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">A YANG Push lite subscription comprises:<a href="#section-6-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-4.1">
          <p id="section-6-4.1.1">a target datastore for the subscription, as per <span>[<a href="#RFC8342" class="cite xref">RFC8342</a>]</span>.<a href="#section-6-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-4.2">
          <p id="section-6-4.2.1">a set of selection filters to choose which datastore nodes the subscription is monitoring or sampling, as described in <a href="#pathsAndFilters" class="auto internal xref">Section 8</a>.<a href="#section-6-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-4.3">
          <p id="section-6-4.3.1">an indication of how update event notifications for the data nodes are triggered.  I.e., either periodic sampling, on-change event-driven, or both.  These are described in <strong>TODO, add reference</strong>.<a href="#section-6-4.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-4.4">
          <p id="section-6-4.4.1">a chosen encoding of the messages, e.g., JSON.<a href="#section-6-4.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-4.5">
          <p id="section-6-4.5.1">a set of one or more receivers for which datastore updates and subscription notifications are sent, as described in <a href="#receivers" class="auto internal xref">Section 10</a>;<a href="#section-6-4.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-4.5.2.1">
              <p id="section-6-4.5.2.1.1">for configured subscriptions, the receivers parameters are configured, and specify transport, receiver, and encoding parameters.<a href="#section-6-4.5.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6-4.5.2.2">
              <p id="section-6-4.5.2.2.1">for dynamic subscriptions, the receiver uses the same transport session on which the dynamic subscription has been created.<a href="#section-6-4.5.2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
      </ul>
<p id="section-6-5">If a subscription is valid and acceptable to the publisher, and if a suitable connection can be made to one or more receivers associated with a subscription, then the publisher will enact the subscription, periodically sampling or monitoring changes to the chosen datastore's data nodes that match the selection filter.  Push updates are subsequently sent by the publisher to the receiver, as per the terms of the subscription.<a href="#section-6-5" class="pilcrow">¶</a></p>
<p id="section-6-6">Subscriptions may be set up in two ways: either through configuration - or YANG RPCs to create and manage dynamic subscriptions.  These two mechanisms are described in <a href="#ConfiguredAndDynamic" class="auto internal xref">Section 11</a>.<a href="#section-6-6" class="pilcrow">¶</a></p>
<p id="section-6-7">Changes to the state of subscription are notified to receivers as subscription lifecycle notifications.  These are described in <a href="#LifecycleNotifications" class="auto internal xref">Section 12</a>.<a href="#section-6-7" class="pilcrow">¶</a></p>
<p id="section-6-8">NACM <span>[<a href="#RFC8341" class="cite xref">RFC8341</a>]</span> based access control is used to ensure the receivers only get access to the information for which they are allowed.  This is further described in <a href="#security" class="auto internal xref">Section 16</a>.<a href="#section-6-8" class="pilcrow">¶</a></p>
<p id="section-6-9">While the functionality defined in this document is transport agnostic, transports like the Network Configuration Protocol (NETCONF) <span>[<a href="#RFC6241" class="cite xref">RFC6241</a>]</span> or RESTCONF <span>[<a href="#RFC8040" class="cite xref">RFC8040</a>]</span> can be used to configure or dynamically signal subscriptions.  In the case of configured subscription, the transport used for carrying the subscription notifications is entirely independent from the protocol used to configure the subscription, and other transports, e.g., <span>[<a href="#I-D.draft-ietf-netconf-udp-notif" class="cite xref">I-D.draft-ietf-netconf-udp-notif</a>]</span> defines a simple UDP based transport for Push notifications. Transport considerations are described in <a href="#transports" class="auto internal xref">Section 10.1</a>.<a href="#section-6-9" class="pilcrow">¶</a></p>
<p id="section-6-10"><strong>TODO Introduce capabilities and operational monitoring</strong><a href="#section-6-10" class="pilcrow">¶</a></p>
<p id="section-6-11">This document defines a YANG data model, that includes RPCs and notifications, for configuring and managing subscriptions and associated configuration, and to define the format of a <em>Push Update</em> message.  The YANG model is defined in <a href="#yp-lite-tree" class="auto internal xref">Section 15.1</a> and associated tree view in <a href="#yp-lite-tree" class="auto internal xref">Section 15.1</a>.  The YANG data model defined in this document conforms to the Network Management Datastore Architecture defined in <span>[<a href="#RFC8342" class="cite xref">RFC8342</a>]</span>.<a href="#section-6-11" class="pilcrow">¶</a></p>
<div id="relationship-to-rfc-5277">
<section id="section-6.1">
        <h3 id="name-relationship-to-rfc-5277">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-relationship-to-rfc-5277" class="section-name selfRef">Relationship to RFC 5277</a>
        </h3>
<p id="section-6.1-1">All of the notifications defined in this specification, i.e., both the datastore update message and subscription lifecycle update notifications <a href="#LifecycleNotifications" class="auto internal xref">Section 12</a> use the notification envelope format defined in <span>[<a href="#I-D.draft-netana-netconf-notif-envelope" class="cite xref">I-D.draft-netana-netconf-notif-envelope</a>]</span>.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">As such, this specification does not make use of the notification format defined in <span>[<a href="#RFC5277" class="cite xref">RFC5277</a>]</span>, but devices may also use <span>[<a href="#RFC5277" class="cite xref">RFC5277</a>]</span> notifications for other YANG notifications, e.g., for the "NETCONF" event stream defined in <span>[<a href="#RFC5277" class="cite xref">RFC5277</a>]</span>.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="terminology">
<section id="section-7">
      <h2 id="name-definitions">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-definitions" class="section-name selfRef">Definitions</a>
      </h2>
<p id="section-7-1">This document reuses the terminology defined in <span>[<a href="#RFC7950" class="cite xref">RFC7950</a>]</span>, <span>[<a href="#RFC8341" class="cite xref">RFC8341</a>]</span>, <span>[<a href="#RFC8342" class="cite xref">RFC8342</a>]</span>, <span>[<a href="#RFC8639" class="cite xref">RFC8639</a>]</span> and <span>[<a href="#RFC8641" class="cite xref">RFC8641</a>]</span>.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">The following terms are taken from <span>[<a href="#RFC8342" class="cite xref">RFC8342</a>]</span>:<a href="#section-7-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-3.1">
          <p id="section-7-3.1.1"><em>Datastore</em>: A conceptual place to store and access information.  A datastore might be implemented, for example, using files, a database, flash memory locations, or combinations thereof.  A datastore maps to an instantiated YANG data tree.<a href="#section-7-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-3.2">
          <p id="section-7-3.2.1"><em>Client</em>: An entity that can access YANG-defined data on a server, over some network management protocol.<a href="#section-7-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-3.3">
          <p id="section-7-3.3.1"><em>Configuration</em>: Data that is required to get a device from its initial default state into a desired operational state.  This data is modeled in YANG using "config true" nodes.  Configuration can originate from different sources.<a href="#section-7-3.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-3.4">
          <p id="section-7-3.4.1"><em>Configuration datastore</em>: A datastore holding configuration.<a href="#section-7-3.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-7-4">The following terms are taken from <span>[<a href="#RFC8639" class="cite xref">RFC8639</a>]</span>:<a href="#section-7-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-5.1">
          <p id="section-7-5.1.1"><em>Configured subscription</em>: A subscription installed via configuration into a configuration datastore.<a href="#section-7-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-5.2">
          <p id="section-7-5.2.1"><em>Dynamic subscription</em>: A subscription created dynamically by a
subscriber via a Remote Procedure Call (RPC).<a href="#section-7-5.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-5.3">
          <p id="section-7-5.3.1"><em>Event</em>: An occurrence of something that may be of interest.
Examples include a configuration change, a fault, a change in
status, crossing a threshold, or an external input to the system.<a href="#section-7-5.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-5.4">
          <p id="section-7-5.4.1"><em>Event occurrence time</em>: A timestamp matching the time an
originating process identified as when an event happened.<a href="#section-7-5.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-5.5">
          <p id="section-7-5.5.1"><em>Event record</em>: A set of information detailing an event.<a href="#section-7-5.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-5.6">
          <p id="section-7-5.6.1"><em>Event stream</em>: A continuous, chronologically ordered set of events
aggregated under some context.<a href="#section-7-5.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-5.7">
          <p id="section-7-5.7.1"><em>Event stream filter</em>: Evaluation criteria that may be applied
against event records in an event stream.  Event records pass the
filter when specified criteria are met.<a href="#section-7-5.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-5.8">
          <p id="section-7-5.8.1"><em>Notification message</em>: Information intended for a receiver
indicating that one or more events have occurred.<a href="#section-7-5.8.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-5.9">
          <p id="section-7-5.9.1"><em>Publisher</em>: An entity responsible for streaming notification
messages per the terms of a subscription.<a href="#section-7-5.9.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-5.10">
          <p id="section-7-5.10.1"><em>Receiver</em>: A target to which a publisher pushes subscribed event
records.  For dynamic subscriptions, the receiver and subscriber
are the same entity.<a href="#section-7-5.10.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-5.11">
          <p id="section-7-5.11.1"><em>Subscriber</em>: A client able to request and negotiate a contract for
the generation and push of event records from a publisher.  For
dynamic subscriptions, the receiver and subscriber are the same
entity.<a href="#section-7-5.11.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-7-6">The following terms are taken from <span>[<a href="#RFC8641" class="cite xref">RFC8641</a>]</span>:<a href="#section-7-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-7.1">
          <p id="section-7-7.1.1"><em>Datastore node</em>: A node in the instantiated YANG data tree
associated with a datastore.  In this document, datastore nodes
are often also simply referred to as "objects".<a href="#section-7-7.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-7.2">
          <p id="section-7-7.2.1"><em>Datastore node update</em>: A data item containing the current value of
a datastore node at the time the datastore node update was
created, as well as the path to the datastore node.<a href="#section-7-7.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-7.3">
          <p id="section-7-7.3.1"><em>Datastore subscription</em>: A subscription to a stream of datastore
node updates.<a href="#section-7-7.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-7.4">
          <p id="section-7-7.4.1"><em>Datastore subtree</em>: A datastore node and all its descendant
datastore nodes.<a href="#section-7-7.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-7.5">
          <p id="section-7-7.5.1"><em>On-change subscription</em>: A datastore subscription with updates that
are triggered when changes in subscribed datastore nodes are
detected.<a href="#section-7-7.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-7.6">
          <p id="section-7-7.6.1"><em>Periodic subscription</em>: A datastore subscription with updates that
are triggered periodically according to some time interval.<a href="#section-7-7.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-7.7">
          <p id="section-7-7.7.1"><em>Selection filter</em>: Evaluation and/or selection criteria that may be
applied against a targeted set of objects.<a href="#section-7-7.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-7.8">
          <p id="section-7-7.8.1"><em>Update record</em>: A representation of one or more datastore node
updates.  In addition, an update record may contain which type of
update led to the datastore node update (e.g., whether the
datastore node was added, changed, or deleted).  Also included in
the update record may be other metadata, such as a subscription ID
of the subscription for which the update record was generated.  In
this document, update records are often also simply referred to as
"updates".<a href="#section-7-7.8.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-7.9">
          <p id="section-7-7.9.1"><em>Update trigger</em>: A mechanism that determines when an update record
needs to be generated.<a href="#section-7-7.9.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-7.10">
          <p id="section-7-7.10.1"><em>YANG-Push</em>: The subscription and push mechanism for datastore
updates that is specified in <span>[<a href="#RFC8641" class="cite xref">RFC8641</a>]</span>.<a href="#section-7-7.10.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-7-8">This document introduces the following terms:<a href="#section-7-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-9.1">
          <p id="section-7-9.1.1"><em>Subscription</em>: A registration with a publisher, stipulating the
information that one or more receivers wish to have pushed from
the publisher without the need for further solicitation.<a href="#section-7-9.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-9.2">
          <p id="section-7-9.2.1"><em>Subscription Identifier</em>: A numerical identifier for a configured or dynamic subscription.  Also referred to as the subscription-id.<a href="#section-7-9.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-9.3">
          <p id="section-7-9.3.1"><em>YANG-Push-Lite</em>: The light weight subscription and push mechanism for datastore updates that is specified in this document.<a href="#section-7-9.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-7-10">All <em>YANG tree diagrams</em> used in this document follow the notation
defined in <span>[<a href="#RFC8340" class="cite xref">RFC8340</a>]</span>.<a href="#section-7-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pathsAndFilters">
<section id="section-8">
      <h2 id="name-sensor-paths-and-selection-">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-sensor-paths-and-selection-" class="section-name selfRef">Sensor paths and selection filters</a>
      </h2>
<p id="section-8-1">In order to know which data nodes are monitored, a subscription must specify both the selection filters and the datastore against which these selection filters will be applied.  This information is used to choose, and subsequently push, data from the publisher's datastore to the receivers.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">The following selection filter types are included in the YANG Push lite data model and may be applied against a datastore:<a href="#section-8-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-3.1">
          <p id="section-8-3.1.1"><em>paths</em>: A list of basic path selection filters, that as a very restricted subset of an XPath filter, defines a path to a set of data node in the schema.  For each YANG list element on the path, the keys may either be wildcarded, or key entries to identify an exact list element, or regex expressions may be used on the keys to select a subset of list entries. <strong>TODO, does this need a basic form of inclusion/exclusion of elements at the end of the filter?</strong><a href="#section-8-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-3.2">
          <p id="section-8-3.2.1"><em>subtree</em>: A subtree selection filter identifies one or more datastore subtrees.  When specified, update records will only come from the datastore nodes of selected datastore subtree(s).  The syntax and semantics correspond to those specified in <span>[<a href="#RFC6241" class="cite xref">RFC6241</a>]</span>, Section 6.<a href="#section-8-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-8-3.3">
          <p id="section-8-3.3.1"><em>xpaths</em>: A list of <em>xpath</em> selection filter is a full XPath expression that returns a node set.  (XPath is a query language for selecting nodes in an XML document; see <span>[<a href="#XPATH" class="cite xref">XPATH</a>]</span> for details.)  When specified, updates will only come from the selected datastore nodes.<a href="#section-8-3.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-8-4">These filters are intended to be used as selectors that define which objects are within the scope of a subscription.  A publisher <span class="bcp14">MUST</span> support basic path filters, and <span class="bcp14">MAY</span> also support subtree or xpath filters.  <strong>TODO, do we really need full XPath filters, does anyone intend to support this?</strong><a href="#section-8-4" class="pilcrow">¶</a></p>
<p id="section-8-5">XPath itself provides powerful filtering constructs, and care must be used in filter definition.  Consider an XPath filter that only passes a datastore node when an interface is up.  It is up to the receiver to understand the implications of the presence or absence of objects in each update.<a href="#section-8-5" class="pilcrow">¶</a></p>
<p id="section-8-6">For path and xpath based filters, each subscription may use a list of selection filters.  Each of these filter paths is processed by the publisher independently, and if two or more filter paths end up selecting overlapping data nodes then the publisher <span class="bcp14">MAY</span> notify duplicate values for those data nodes, but the encoded data that is returned <span class="bcp14">MUST</span> always be syntactically valid, i.e., as per section 5.3 of <span>[<a href="#RFC8342" class="cite xref">RFC8342</a>]</span>.<a href="#section-8-6" class="pilcrow">¶</a></p>
<div id="the-filters-container">
<section id="section-8.1">
        <h3 id="name-the-filters-container">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-the-filters-container" class="section-name selfRef">The "filters" Container</a>
        </h3>
<p id="section-8.1-1">The "filters" container maintains a list of all datastore subscription filters that persist outside the lifecycle of a single subscription.  This enables predefined filters that may be referenced by more than one subscription.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">Below is a tree diagram for the "filters" container.  All objects contained in this tree are described in the YANG module in <a href="#ietf-yp-lite-yang" class="auto internal xref">Section 15</a>.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<span id="name-filters-container"></span><figure id="figure-1">
          <div class="lang-yangtree sourcecode" id="section-8.1-3.1">
<pre>
module: ietf-yp-lite
  +--rw datastore-telemetry
     +--rw filters
        +--rw filter* [name]
           +--rw name             string
           +--rw (filter-spec)?
              +--:(paths)
              |  +--rw paths*     string
              +--:(subtree)
              |  +--rw subtree?   &lt;anydata&gt; {ypl:subtree}?
              +--:(xpaths)
                 +--rw xpaths*    yang:xpath1.0 {ypl:xpath}?
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-filters-container" class="selfRef">'filters' container</a>
          </figcaption></figure>
</section>
</div>
<div id="decomposing-subscriptions">
<section id="section-8.2">
        <h3 id="name-decomposing-subscriptions">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-decomposing-subscriptions" class="section-name selfRef">Decomposing Subscriptions</a>
        </h3>
<p id="section-8.2-1">In order to address the issues described in <a href="#OperationalModellingComplexities" class="auto internal xref">Section 5.2</a>, YANG Push Lite allows for client specified filters to be decomposed into more specific filters by the server.  This is to facilitate publishers that internally group some of their operational data fields together into larger structures for efficiency (referred to as <em>bag of data</em>).  E.g., each entry in the <em>/ietf-interfaces:interface/interface</em> list could be represents as a bag of data internally within a publisher. In particular:<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-8.2-2">
<li id="section-8.2-2.1">
            <p id="section-8.2-2.1.1">A Publisher <span class="bcp14">MAY</span> decompose a client specified subscription filter path into a set of non-overlapping subscription filter paths that collectively cover the same data.  The publisher is allowed to return data for each of these decomposed subscription filter paths in separate update messages, and with separate, perhaps more precise, timestamps.<a href="#section-8.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-8.2-2.2">
            <p id="section-8.2-2.2.1">A Publisher <span class="bcp14">MAY</span> split large lists into multiple separate update messages, each with separate timestamps.  E.g., if a device has 10,000 entries in a list, it may return them in a single response, or it may split them into multiple smaller messages, perhaps for 500 interfaces at a time. <strong>TODO We need a mechanism so that the client knows all list entries have been returned, and hence it can delete stale entries?  E.g., something like a <em>more</em> flag and <em>complete</em> flag.</strong><a href="#section-8.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-8.2-2.3">
            <p id="section-8.2-2.3.1">A Publisher is allowed to generate on-change notifications at a <em>bag</em> level, and hence that contain other associated fields that may not have changed, rather than restricting the on-change notifications strictly to only those fields that have changed.  E.g., if a subscribers registers on the path <em>/ietf-interfaces:interfaces/interface[name = *]/oper-status</em>, and if interface <em>eth1</em> had a change in oper-status, then rather than just publishing the updated oper-status leaf, the publisher may instead publish all the data associated with that interface entry, i.e., everything under <em>/ietf-interfaces:interface/interface[name = eth1]</em>.  <strong>TODO Does it have to be the entire subtree that is published?  Do we need to add a capability annotation to indicate that point.</strong><a href="#section-8.2-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-8.2-3">To ensure that clients can reasonably process data returned via decomposed filters then:<a href="#section-8.2-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-8.2-4">
<li id="section-8.2-4.1">
            <p id="section-8.2-4.1.1">If a filter is decomposed into more specific filters then all data <span class="bcp14">MUST</span> still be encoded relative to the initial subscription filter.<a href="#section-8.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-8.2-4.2">
            <p id="section-8.2-4.2.1"><em>update</em> notifications <span class="bcp14">MUST</span> indicate the actual filter that the data satisfies.<a href="#section-8.2-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-8.2-4.3">
            <p id="section-8.2-4.3.1"><strong>TODO Indicate when a given periodic interval has completed.</strong><a href="#section-8.2-4.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
</section>
</div>
<div id="events">
<section id="section-9">
      <h2 id="name-datastore-event-streams">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-datastore-event-streams" class="section-name selfRef">Datastore Event Streams</a>
      </h2>
<p id="section-9-1">In YANG Push Lite, a subscription, based on the selected filters, will generate a stream of update records that is called an event stream.  Each subscription logically has a different stream of update records, even if multiple subscriptions use the same filters.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">Depending on the type of subscription, these update records either indicate the current state for a subtree of data nodes in a datastore, or, in the case of an on-change registration, they may also indicate when an a data node subtree has changed, or has been deleted.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">that report the current<a href="#section-9-3" class="pilcrow">¶</a></p>
<p id="section-9-4">An event stream is a named entity on a publisher; this entity exposes
a continuously updating set of YANG-defined event records.  An event
record is an instantiation of a "notification" YANG statement.  If
the "notification" is defined as a child to a data node, the
instantiation includes the hierarchy of nodes that identifies the
data node in the datastore (see Section 7.16.2 of <span>[<a href="#RFC7950" class="cite xref">RFC7950</a>]</span>).  Each
event stream is available for subscription.  Identifying a) how event
streams are defined (other than the NETCONF stream), b) how event
records are defined/generated, and c) how event records are assigned
to event streams is out of scope for this document.<a href="#section-9-4" class="pilcrow">¶</a></p>
<p id="section-9-5">There is only one reserved event stream name in this document:
"NETCONF".  The "NETCONF" event stream contains all NETCONF event
record information supported by the publisher, except where an event
record has explicitly been excluded from the stream.  Beyond the
"NETCONF" stream, implementations <span class="bcp14">MAY</span> define additional event
streams.<a href="#section-9-5" class="pilcrow">¶</a></p>
<p id="section-9-6">As YANG-defined event records are created by a system, they may be
assigned to one or more streams.  The event record is distributed to
a subscription's receiver(s) where (1) a subscription includes the
identified stream and (2) subscription filtering does not exclude the
event record from that receiver.<a href="#section-9-6" class="pilcrow">¶</a></p>
<p id="section-9-7">Access control permissions may be used to silently exclude event
records from an event stream for which the receiver has no read
access.  See <span>[<a href="#RFC8341" class="cite xref">RFC8341</a>]</span>, Section 3.4.6 for an example of how this
might be accomplished.  Note that per Section 2.7 of this document,
subscription state change notifications are never filtered out.<a href="#section-9-7" class="pilcrow">¶</a></p>
<p id="section-9-8">If no access control permissions are in place for event records on an
event stream, then a receiver <span class="bcp14">MUST</span> be allowed access to all the event
records.  If subscriber permissions change during the lifecycle of a
subscription and event stream access is no longer permitted, then the
subscription <span class="bcp14">MUST</span> be terminated.<a href="#section-9-8" class="pilcrow">¶</a></p>
<p id="section-9-9">Event records <span class="bcp14">MUST NOT</span> be delivered to a receiver in a different
order than the order in which they were placed on an event stream.<a href="#section-9-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-10.1">
          <p id="section-9-10.1.1">The specification of update policies that contain conditions that
trigger the generation and pushing of new update records.  There
are two types of subscriptions, distinguished by how updates are
triggered:<a href="#section-9-10.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-10.1.2.1">
              <p id="section-9-10.1.2.1.1">For periodic subscriptions, the update trigger is specified by
  two parameters that define when updates are to be pushed.
  These parameters are (1) the period interval with which to
  report updates and (2) an "anchor-time", i.e., a reference
  point in time that can be used to calculate at which points in
  time periodic updates need to be assembled and sent.<a href="#section-9-10.1.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9-10.1.2.2">
              <p id="section-9-10.1.2.2.1">For on-change subscriptions, an update trigger occurs whenever
 a change in the subscribed information is detected.  The
 following additional parameters are included:<a href="#section-9-10.1.2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-10.1.2.2.2.1">
                  <p id="section-9-10.1.2.2.2.1.1">"sync-on-start": This parameter defines whether or not a
   complete "push-update" (Section 3.7) of all subscribed data
   will be sent at the beginning of a subscription.  Such early
   synchronization establishes the frame of reference for
   subsequent updates.<a href="#section-9-10.1.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
</li>
      </ul>
<div id="event-records">
<section id="section-9.1">
        <h3 id="name-event-records">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-event-records" class="section-name selfRef">Event Records</a>
        </h3>
<p id="section-9.1-1">There are two types of event records:<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-9.1-2">
<li id="section-9.1-2.1">
            <p id="section-9.1-2.1.1"><em>update</em> records that are used to report the current state of a set of data nodes for either periodic, on-change, or resync notifications.<a href="#section-9.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-9.1-2.2">
            <p id="section-9.1-2.2.1"><em>datanode-delete</em> records are only used during on-change notifications to indicate that a data node at the given path has been deleted.<a href="#section-9.1-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-9.1-3">The schema for these two notifications is given in the following tree diagrams:<a href="#section-9.1-3" class="pilcrow">¶</a></p>
<span id="name-update-notification"></span><figure id="figure-2">
          <div class="lang-yangtree sourcecode" id="section-9.1-4.1">
<pre>
    +---n update
    |  +--ro id?                   subscription-id
    |  +--ro subscription-path?    yang:xpath1.0
    |  +--ro target-path?          string
    |  +--ro snapshot-type?        enumeration
    |  +--ro observation-time?     yang:date-and-time
    |  +--ro datastore-snapshot?   &lt;anydata&gt;
    |  +--ro incomplete?           empty
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-update-notification" class="selfRef">'update' notification</a>
          </figcaption></figure>
<span id="name-datanode-delete-notificatio"></span><figure id="figure-3">
          <div class="lang-yangtree sourcecode" id="section-9.1-5.1">
<pre>
    +---n datanode-delete
       +--ro id?                  subscription-id
       +--ro subscription-path?   yang:xpath1.0
       +--ro target-path?         string
       +--ro observation-time?    yang:date-and-time
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-datanode-delete-notificatio" class="selfRef">'datanode-delete' notification</a>
          </figcaption></figure>
<p id="section-9.1-6">The normative definitions for the notifications fields is given in the YANG module.  The fields can be informatively summarized as:<a href="#section-9.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.1-7.1">
            <p id="section-9.1-7.1.1"><em>id</em> - identifies the subscription the message relates to.<a href="#section-9.1-7.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.1-7.2">
            <p id="section-9.1-7.2.1"><em>subscription-path</em> - identifies the absolute instance-data path to which all data is encoded relative to.<a href="#section-9.1-7.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.1-7.3">
            <p id="section-9.1-7.3.1"><em>target-path</em> - identifies the data node that is being acted on, either providing the replacement data for, or that data node that is being deleted.<a href="#section-9.1-7.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.1-7.4">
            <p id="section-9.1-7.4.1"><em>snapshot-type</em> - for <em>update</em> notifications, this indicates what type of event causes the update message to be sent.  I.e., a periodic notification, or an on-change message because some of the data in the subtree contained in the notification has changed, or a resync message to replay the initiate state after the subscription has started.<a href="#section-9.1-7.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.1-7.5">
            <p id="section-9.1-7.5.1"><em>observation-time</em> - the time that the data was sampled, or when the on-change event occurred that caused the message to be published.<a href="#section-9.1-7.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.1-7.6">
            <p id="section-9.1-7.6.1"><em>datastore-snapshot</em> - the full replacement data subtree for the content at the target-path.  Only needed for <em>update</em> messages.<a href="#section-9.1-7.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.1-7.7">
            <p id="section-9.1-7.7.1"><em>incomplete</em> - indicates that the <em>update</em> message is incomplete in some way.<a href="#section-9.1-7.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div id="notifications-for-subscribed-content">
<section id="section-9.1.1">
          <h4 id="name-notifications-for-subscribe">
<a href="#section-9.1.1" class="section-number selfRef">9.1.1. </a><a href="#name-notifications-for-subscribe" class="section-name selfRef">Notifications for Subscribed Content</a>
          </h4>
<p id="section-9.1.1-1">Along with the subscribed content, there are other objects that might
be part of a "push-update" or "push-change-update" notification.<a href="#section-9.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.1.1-2.1">
              <p id="section-9.1.1-2.1.1">An "id" (that identifies the subscription).<a href="#section-9.1.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-9.1.1-2.2">
              <p id="section-9.1.1-2.2.1">An "incomplete-update" leaf.  This leaf indicates that the message is incomplete for any reason.  For example, perhaps a periodic subscription expects to retrieve data from multiple data sources, but one of those data sources is unavailable.  Normally, a receiver can use the absence of a field in an update message to implicitly indicate that the field has been deleted, but that should not be inferred if the incomplete-update leaf is present because<a href="#section-9.1.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-9.1.1-3">not all
  changes that have occurred since the last update are actually
  included with this update.  In other words, the publisher has
  failed to fulfill its full subscription obligations.  (For
  example, a datastore was unable to provide the full set of
  datastore nodes to a publisher process.)  To facilitate the
  resynchronization of on-change subscriptions, a publisher <span class="bcp14">MAY</span>
  subsequently send a "push-update" containing a full selection
  snapshot of subscribed data.<a href="#section-9.1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="types-of-subscription-event-monitoring">
<section id="section-9.2">
        <h3 id="name-types-of-subscription-event">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-types-of-subscription-event" class="section-name selfRef">Types of subscription event monitoring</a>
        </h3>
<p id="section-9.2-1">Subscription can either be based on sampling the requested data on a periodic cadence, and/or being notified when the requested data changes.  This specification also allows for subscriptions that both notify on-changes but also with a periodic cadence, which can help ensure that the system eventually converges on the right state, even if an on-change notification was somehow lost or mis-processed somewhere in the data processing pipeline.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="periodic-events">
<section id="section-9.3">
        <h3 id="name-periodic-events">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-periodic-events" class="section-name selfRef">Periodic events</a>
        </h3>
<p id="section-9.3-1">In a periodic subscription, the data included as part of an update
record corresponds to data that could have been read using a
retrieval operation.  Only the state that exists in the system at the time that it is being read is reported, periodic updates never explicitly indicate that any data-nodes or list entries have been deleted.  Instead, deletions must be inferred by the receiver from the absence of data during a particular collection event.<a href="#section-9.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.3-2.1">
            <p id="section-9.3-2.1.1">For periodic subscriptions, triggered updates will occur at the
boundaries of a specified time interval.  These boundaries can be
calculated from the periodic parameters:<a href="#section-9.3-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.3-2.1.2.1">
                <p id="section-9.3-2.1.2.1.1">a <em>period</em> that defines the duration between push updates.<a href="#section-9.3-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-9.3-2.1.2.2">
                <p id="section-9.3-2.1.2.2.1">an <em>anchor-time</em>; update intervals fall on the points in time
that are a multiple of a <em>period</em> from an <em>anchor-time</em>.  If an
<em>anchor-time</em> is not provided, then the publisher chooses a suitable anchor-time, e.g., perhaps the time that the subscription was first instantiated by the publisher.<a href="#section-9.3-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="section-9.3-3">The anchor time and period are particularly useful, in fact required, for when the collected telemetry data is being stored in a time-series database and the subscription is setup to ensure that each collection is placed in a separate time bucket.<a href="#section-9.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="on-change-events">
<section id="section-9.4">
        <h3 id="name-on-change-events">
<a href="#section-9.4" class="section-number selfRef">9.4. </a><a href="#name-on-change-events" class="section-name selfRef">On-Change events</a>
        </h3>
<p id="section-9.4-1">In an on-change subscription, update records indicate updated values or when a monitored data node or list node has been deleted.<a href="#section-9.4-1" class="pilcrow">¶</a></p>
<p id="section-9.4-2"><strong>TODO, give more indication that the delete applies to the path object, rather than a child node</strong>.<a href="#section-9.4-2" class="pilcrow">¶</a></p>
<p id="section-9.4-3">Publishers are not required to notify every change or value for an on-change monitored data node.  Instead, publishers <span class="bcp14">MAY</span> limit the rate at which changes are reported for a given data node, suppressing further updates for a short time interval.  If a data node changes value and then reverts back to the original value then the publisher <span class="bcp14">MAY</span> suppress reporting the change entirely.  However, if the data node changes to a new value for a longer period than any internal dampening interval, then the change and latest state <span class="bcp14">MUST</span> be reported to the receiver.<a href="#section-9.4-3" class="pilcrow">¶</a></p>
<p id="section-9.4-4">For example, if the interface link state reported by hardware is changing state hundreds of times per second, then it would be entirely reasonable to limit those interface state changes to a much lower cadence, e.g., perhaps every 100 milliseconds.  In the particular case of interfaces, there may also be data model specific forms of more advanced dampening that are more appropriate, e.g., that notify interface down events immediately, but rate limit how quickly the interface is allowed to transition to up state, which overall acts as a limit on the rate at which the interface state may change, and hence also act as a limit on the rate at which change notifications could be generated.<a href="#section-9.4-4" class="pilcrow">¶</a></p>
<div id="on-change-notifiable-datastore-nodes">
<section id="section-9.4.1">
          <h4 id="name-on-change-notifiable-datast">
<a href="#section-9.4.1" class="section-number selfRef">9.4.1. </a><a href="#name-on-change-notifiable-datast" class="section-name selfRef">On-Change Notifiable Datastore Nodes</a>
          </h4>
<p id="section-9.4.1-1">In some cases, a publisher supporting on-change notifications may not
be able to push on-change updates for some object types.  Reasons for
this might be that the value of the datastore node changes frequently
(e.g., the in-octets counter as defined in <span>[<a href="#RFC8343" class="cite xref">RFC8343</a>]</span>), small object
changes are frequent and meaningless (e.g., a temperature gauge
changing 0.1 degrees), or the implementation is not capable of
on-change notification for a particular object.<a href="#section-9.4.1-1" class="pilcrow">¶</a></p>
<p id="section-9.4.1-2">The information about what nodes support on-change notifications is reported using capabilities operational data model.  This is further described in <a href="#ConformanceAndCapabilities" class="auto internal xref">Section 14</a>.<a href="#section-9.4.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="on-change-considerations">
<section id="section-9.4.2">
          <h4 id="name-on-change-considerations">
<a href="#section-9.4.2" class="section-number selfRef">9.4.2. </a><a href="#name-on-change-considerations" class="section-name selfRef">On-Change Considerations</a>
          </h4>
<p id="section-9.4.2-1">On-change subscriptions allow receivers to receive updates whenever
changes to targeted objects occur.  As such, on-change subscriptions
are particularly effective for data that changes infrequently but for
which applications need to be quickly notified, with minimal delay,
whenever a change does occur.<a href="#section-9.4.2-1" class="pilcrow">¶</a></p>
<p id="section-9.4.2-2">On-change subscriptions tend to be more difficult to implement than
periodic subscriptions.  Accordingly, on-change subscriptions may not
be supported by all implementations or for every object.<a href="#section-9.4.2-2" class="pilcrow">¶</a></p>
<p id="section-9.4.2-3">Whether or not to accept or reject on-change subscription requests
when the scope of the subscription contains objects for which
on-change is not supported is up to the publisher implementation.  A
publisher <span class="bcp14">MAY</span> accept an on-change subscription even when the scope of
the subscription contains objects for which on-change is not
supported.  In that case, updates are sent only for those objects
within the scope of the subscription that do support on-change
updates, whereas other objects are excluded from update records, even
if their values change.  In order for a subscriber to determine
whether objects support on-change subscriptions, objects are marked
accordingly on a publisher.  Accordingly, when subscribing, it is the
responsibility of the subscriber to ensure that it is aware of which
objects support on-change and which do not.  For more on how objects
are so marked, see Section 3.10.<a href="#section-9.4.2-3" class="pilcrow">¶</a></p>
<p id="section-9.4.2-4">Alternatively, a publisher <span class="bcp14">MAY</span> decide to simply reject an on-change
subscription if the scope of the subscription contains objects for
which on-change is not supported.  In the case of a configured
subscription, the publisher <span class="bcp14">MAY</span> suspend the subscription.<a href="#section-9.4.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="combined-period-and-on-change-subscriptions">
<section id="section-9.5">
        <h3 id="name-combined-period-and-on-chan">
<a href="#section-9.5" class="section-number selfRef">9.5. </a><a href="#name-combined-period-and-on-chan" class="section-name selfRef">Combined period and on-change subscriptions</a>
        </h3>
<p id="section-9.5-1">A single subscription may created to generate notifications both when changes occur and when changes occur.  Such subscriptions are equivalent to having separate periodic and on-change subscriptions on the same path, except that they share the same subscription-id and filter paths.<a href="#section-9.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="streaming-updates">
<section id="section-9.6">
        <h3 id="name-streaming-updates">
<a href="#section-9.6" class="section-number selfRef">9.6. </a><a href="#name-streaming-updates" class="section-name selfRef">Streaming Updates</a>
        </h3>
<p id="section-9.6-1">Contrary to traditional data retrieval requests, datastore
subscription enables an unbounded series of update records to be
streamed over time.  Two generic YANG notifications for update
records have been defined for this scenario: "push-update" and
"push-change-update".<a href="#section-9.6-1" class="pilcrow">¶</a></p>
<p id="section-9.6-2">A "push-update" notification defines a complete, filtered update of
the datastore per the terms of a subscription.  This type of YANG
notification is used for continuous updates of periodic
subscriptions.  A "push-update" notification can also be used for the
on-change subscriptions in two cases.  First, it <span class="bcp14">MUST</span> be used as the
initial "push-update" if there is a need to synchronize the receiver
at the start of a new subscription.  Second, it <span class="bcp14">MAY</span> be sent if the
publisher later chooses to resync an on-change subscription.  The
"push-update" update record contains an instantiated datastore
subtree with all of the subscribed contents.  The content of the
update record is equivalent to the contents that would be obtained
had the same data been explicitly retrieved using a datastore
retrieval operation using the same transport with the same filters
applied.<a href="#section-9.6-2" class="pilcrow">¶</a></p>
<p id="section-9.6-3">A "push-change-update" notification is the most common type of update
for on-change subscriptions.  The update record in this case contains
the set of changes that datastore nodes have undergone since the last
notification message.  In other words, this indicates which datastore
nodes have been created, have been deleted, or have had changes to
their values.  In cases where multiple changes have occurred over the
course of a dampening period and the object has not been deleted, the
object's most current value is reported.  (In other words, for each
object, only one change is reported, not its entire history.  Doing
so would defeat the purpose of the dampening period.)<a href="#section-9.6-3" class="pilcrow">¶</a></p>
<p id="section-9.6-4">"push-update" and "push-change-update" are encoded and placed in
notification messages and are ultimately queued for egress over the
specified transport.<a href="#section-9.6-4" class="pilcrow">¶</a></p>
<p id="section-9.6-5">Figure 1 provides an example of a notification message for a
subscription tracking the operational status of a single Ethernet
interface (per <span>[<a href="#RFC8343" class="cite xref">RFC8343</a>]</span>).  This notification message is encoded XML
<em>W3C.REC-xml-20081126</em> over the Network Configuration Protocol
(NETCONF) as per <em>RFC8640</em>.<a href="#section-9.6-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.6-6">
<pre>
&lt;notification xmlns="urn:ietf:params:xml:ns:netconf:notification:1.0"&gt;
&lt;eventTime&gt;2017-10-25T08:00:11.22Z&lt;/eventTime&gt;
&lt;push-update xmlns="urn:ietf:params:xml:ns:yang:ietf-yang-push"&gt;
  &lt;id&gt;1011&lt;/id&gt;
  &lt;datastore-contents&gt;
    &lt;interfaces xmlns="urn:ietf:params:xml:ns:yang:ietf-interfaces"&gt;
      &lt;interface&gt;
        &lt;name&gt;eth0&lt;/name&gt;
        &lt;oper-status&gt;up&lt;/oper-status&gt;
      &lt;/interface&gt;
    &lt;/interfaces&gt;
  &lt;/datastore-contents&gt;
&lt;/push-update&gt;
&lt;/notification&gt;

                      Figure 1: Push Example
</pre><a href="#section-9.6-6" class="pilcrow">¶</a>
</div>
<p id="section-9.6-7">Figure 2 provides an example of an on-change notification message for
the same subscription.<a href="#section-9.6-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-9.6-8">
<pre>
&lt;notification xmlns="urn:ietf:params:xml:ns:netconf:notification:1.0"&gt;
&lt;eventTime&gt;2017-10-25T08:22:33.44Z&lt;/eventTime&gt;
&lt;push-change-update
    xmlns="urn:ietf:params:xml:ns:yang:ietf-yang-push"&gt;
  &lt;id&gt;89&lt;/id&gt;
  &lt;datastore-changes&gt;
    &lt;yang-patch&gt;
      &lt;patch-id&gt;0&lt;/patch-id&gt;
      &lt;edit&gt;
        &lt;edit-id&gt;edit1&lt;/edit-id&gt;
        &lt;operation&gt;replace&lt;/operation&gt;
        &lt;target&gt;/ietf-interfaces:interfaces&lt;/target&gt;
        &lt;value&gt;
          &lt;interfaces
              xmlns="urn:ietf:params:xml:ns:yang:ietf-interfaces"&gt;
            &lt;interface&gt;
              &lt;name&gt;eth0&lt;/name&gt;
              &lt;oper-status&gt;down&lt;/oper-status&gt;
            &lt;/interface&gt;
          &lt;/interfaces&gt;
        &lt;/value&gt;
      &lt;/edit&gt;
    &lt;/yang-patch&gt;
  &lt;/datastore-changes&gt;
&lt;/push-change-update&gt;
&lt;/notification&gt;

    Figure 2: Push Example for an On-Change Notification Message
</pre><a href="#section-9.6-8" class="pilcrow">¶</a>
</div>
<p id="section-9.6-9">Of note in the above example is the "patch-id" with a value of "0".
Per <span>[<a href="#RFC8072" class="cite xref">RFC8072</a>]</span>, the "patch-id" is an arbitrary string.  With
YANG-Push, the publisher <span class="bcp14">SHOULD</span> put into the "patch-id" a counter
starting at "0" that increments with every "push-change-update"
generated for a subscription.  If used as a counter, this counter
<span class="bcp14">MUST</span> be reset to "0" any time a resynchronization occurs (i.e., with
the sending of a "push-update").  Also, if used as a counter, the
counter <span class="bcp14">MUST</span> be reset to "0" after passing a maximum value of
"4294967295" (i.e., the maximum value that can be represented using
the uint32 data type).  Such a mechanism allows easy identification
of lost or out-of-sequence update records.<a href="#section-9.6-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="receivers">
<section id="section-10">
      <h2 id="name-receivers">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-receivers" class="section-name selfRef">Receivers</a>
      </h2>
<p id="section-10-1">Text moved from configured subscriptions.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">In addition to the subscription parameters available to dynamic
subscriptions as described in Section 2.4.2, the following additional
parameters are also available to configured subscriptions:<a href="#section-10-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10-3.1">
          <p id="section-10-3.1.1">A "transport", which identifies the transport protocol to use to
connect with all subscription receivers.<a href="#section-10-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-10-3.2">
          <p id="section-10-3.2.1">One or more receivers, each intended as the destination for event
records.  Note that each individual receiver is identifiable by
its "name".<a href="#section-10-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-10-3.3">
          <p id="section-10-3.3.1">Optional parameters to identify where traffic should egress a
publisher:<a href="#section-10-3.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10-3.3.2.1">
              <p id="section-10-3.3.2.1.1">A "source-interface", which identifies the egress interface to
  use from the publisher.  Publisher support for this parameter
  is optional and advertised using the "interface-designation"
  feature.<a href="#section-10-3.3.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10-3.3.2.2">
              <p id="section-10-3.3.2.2.1">A "source-address" address, which identifies the IP address to
  stamp on notification messages destined for the receiver.<a href="#section-10-3.3.2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-10-3.3.2.3">
              <p id="section-10-3.3.2.3.1">A "source-vrf", which identifies the Virtual Routing and
  Forwarding (VRF) instance on which to reach receivers.  This
  VRF is a network instance as defined in <span>[<a href="#RFC8529" class="cite xref">RFC8529</a>]</span>.  Publisher
  support for VRFs is optional and advertised using the
  "supports-vrf" feature.<a href="#section-10-3.3.2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-10-3.3.3">
If none of the above parameters are set, notification messages
<span class="bcp14">MUST</span> egress the publisher's default interface.<a href="#section-10-3.3.3" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="transports">
<section id="section-10.1">
        <h3 id="name-transports">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-transports" class="section-name selfRef">Transports</a>
        </h3>
<p id="section-10.1-1">This document describes a transport-agnostic mechanism for subscribing to and receiving content from an event stream in a publisher.  This mechanism operates through the use of a subscription.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<p id="section-10.1-2">Also note that transport-specific specifications based on this specification <span class="bcp14">MUST</span> detail the lifecycle of dynamic subscriptions as well as the lifecycle of configured subscriptions (if supported).<a href="#section-10.1-2" class="pilcrow">¶</a></p>
<p id="section-10.1-3">A subscriber that includes a "dscp" leaf in an "establish-subscription" request will need to understand and consider what the corresponding DSCP value represents in the domain of the publisher.<a href="#section-10.1-3" class="pilcrow">¶</a></p>
<div id="requirements-for-yang-push-lite-transport-specifications">
<section id="section-10.1.1">
          <h4 id="name-requirements-for-yang-push-">
<a href="#section-10.1.1" class="section-number selfRef">10.1.1. </a><a href="#name-requirements-for-yang-push-" class="section-name selfRef">Requirements for Yang Push Lite Transport Specifications</a>
          </h4>
<p id="section-10.1.1-1">This section provides requirements for any transport specifications supporting the YANG Push Lite solution presented in this document.<a href="#section-10.1.1-1" class="pilcrow">¶</a></p>
<p id="section-10.1.1-2">The transport selected by the subscriber to reach the publisher <span class="bcp14">SHOULD</span> be able to support multiple "establish-subscription" requests made in the same transport session.<a href="#section-10.1.1-2" class="pilcrow">¶</a></p>
<p id="section-10.1.1-3">For both configured and dynamic subscriptions, the publisher <span class="bcp14">SHOULD</span> authenticate a receiver via some transport-level mechanism before sending any event records that the receiver is authorized to see.  In addition, the receiver <span class="bcp14">SHOULD</span> authenticate the publisher at the
transport level.  The result is mutual authentication between the two.<a href="#section-10.1.1-3" class="pilcrow">¶</a></p>
<p id="section-10.1.1-4">A secure transport is <span class="bcp14">RECOMMENDED</span>.  For dynamic subscriptions, the publisher <span class="bcp14">MUST</span> ensure that the receiver has sufficient authorization to perform the function it is requesting against the specific subset of content involved.<a href="#section-10.1.1-4" class="pilcrow">¶</a></p>
<p id="section-10.1.1-5">A specification for a transport built upon this document may or may not choose to require the use of the same logical channel for the RPCs and the event records.  However, the event records and the subscription state change notifications <span class="bcp14">MUST</span> be sent on the same transport session to ensure properly ordered delivery.<a href="#section-10.1.1-5" class="pilcrow">¶</a></p>
<p id="section-10.1.1-6">A specification for a transport <span class="bcp14">MUST</span> identify any encodings that are supported.  If a configured subscription's transport allows different encodings, the specification <span class="bcp14">MUST</span> identify the default encoding.<a href="#section-10.1.1-6" class="pilcrow">¶</a></p>
<p id="section-10.1.1-7">Additional transport requirements may be dictated by the choice of transport used with a subscription.  For an example of such requirements, see <span>[<a href="#RFC8640" class="cite xref">RFC8640</a>]</span>.<a href="#section-10.1.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="transport-connectivity-for-a-configured-subscription">
<section id="section-10.1.2">
          <h4 id="name-transport-connectivity-for-">
<a href="#section-10.1.2" class="section-number selfRef">10.1.2. </a><a href="#name-transport-connectivity-for-" class="section-name selfRef">Transport Connectivity for a Configured Subscription</a>
          </h4>
<p id="section-10.1.2-1"><strong>TODO Next paragraph is from section 2.</strong><a href="#section-10.1.2-1" class="pilcrow">¶</a></p>
<p id="section-10.1.2-2">Because there is no explicit association with an existing transport session, configuration operations include additional parameters beyond those of dynamic subscriptions.  These parameters identify each receiver, how to connect with that receiver, and possibly whether the notification messages need to come from a specific egress interface on the publisher.  Receiver-specific transport connectivity parameters <span class="bcp14">MUST</span> be configured via transport-specific augmentations to this specification.  See Section 2.5.7 for details.<a href="#section-10.1.2-2" class="pilcrow">¶</a></p>
<p id="section-10.1.2-3">This specification is transport independent.  However, supporting a configured subscription will normally require the establishment of transport connectivity.  Some parameters used for this transport connectivity establishment are transport specific.  As a result, the
YANG module defined in <a href="#yp-lite-yang-module" class="auto internal xref">Section 15.2</a> is not able to directly define and expose these transport parameters.<a href="#section-10.1.2-3" class="pilcrow">¶</a></p>
<p id="section-10.1.2-4">It is necessary for an implementation to support the connection establishment process.  To support this function, the YANG data model defined in this document includes a YANG choice node where transport-specific parameters for a particular receiver may be augmented.  This node is <em>/datastore-telemetry/receivers/receiver/transport-type</em>.<a href="#section-10.1.2-4" class="pilcrow">¶</a></p>
<p id="section-10.1.2-5">A publisher supporting the feature "configured" <span class="bcp14">MUST</span> also support at least one
YANG data model that augments transport connectivity parameters on
<em>/datastore-telemetry/receivers/receiver/transport-type</em>.  For an example of
such an augmentation, see <strong>TODO Appendix A</strong>. <strong>TODO - Should this be put under the configured subscription</strong>.<a href="#section-10.1.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="encodings">
<section id="section-10.2">
        <h3 id="name-encodings">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-encodings" class="section-name selfRef">Encodings</a>
        </h3>
<div id="new-encoding-format">
<section id="section-10.2.1">
          <h4 id="name-new-encoding-format">
<a href="#section-10.2.1" class="section-number selfRef">10.2.1. </a><a href="#name-new-encoding-format" class="section-name selfRef">New encoding format</a>
          </h4>
<p id="section-10.2.1-1">This document proposes a new opt-in YANG-Push encoding format to use instead of the "push-update" and "push-change-update" notifications defined in <span>[<a href="#RFC8641" class="cite xref">RFC8641</a>]</span>.<a href="#section-10.2.1-1" class="pilcrow">¶</a></p>
<p id="section-10.2.1-2">There are a few reasons for specifying a new encoding format:<a href="#section-10.2.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-10.2.1-3">
<li id="section-10.2.1-3.1">
              <p id="section-10.2.1-3.1.1">To use the same encoding format for both periodic and on-change messages, allowing the same messages to be easily received and stored in a time-series database, making use of the same message schema when traversing message buses, such as Apache Kafka.<a href="#section-10.2.1-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-10.2.1-3.2">
              <p id="section-10.2.1-3.2.1">To allow the schema of the notifications to be rooted to the subscription point rather than always being to the root of the operational datastore schema.  This allows messages to be slightly less indented, and makes it easier to convert from a YANG schema to an equivalent message bus schema, where each message is defined with its own schema, rather than a single datastore schema.<a href="#section-10.2.1-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-10.2.1-3.3">
              <p id="section-10.2.1-3.3.1">To move away from the somewhat verbose YANG Patch format <span>[<a href="#RFC8072" class="cite xref">RFC8072</a>]</span>, that is not really a great fit for encoding changes of operational data.  Many systems cannot necessarily distinguish between create versus update events (particularly for new subscriptions or after recovering from internal failures within the system), and hence cannot faithfully implement the full YANG Patch semantics defined in <span>[<a href="#RFC8641" class="cite xref">RFC8641</a>]</span>.<a href="#section-10.2.1-3.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-10.2.1-3.4">
              <p id="section-10.2.1-3.4.1">To allow the device to split a subscription into smaller child subscriptions for more efficient independent and concurrent processing.  I.e., reusing the ideas from <span>[<a href="#I-D.ietf-netconf-distributed-notif" class="cite xref">I-D.ietf-netconf-distributed-notif</a>]</span>.  However, all child subscriptions are still encoded from the same subscription point.<a href="#section-10.2.1-3.4.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-10.2.1-4">The practical differences in the encodings may be better illustrated via the examples in <a href="#Examples" class="auto internal xref">Appendix C</a>.<a href="#section-10.2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="combined-periodic-and-on-change-subscription">
<section id="section-10.2.2">
          <h4 id="name-combined-periodic-and-on-ch">
<a href="#section-10.2.2" class="section-number selfRef">10.2.2. </a><a href="#name-combined-periodic-and-on-ch" class="section-name selfRef">Combined periodic and on-change subscription</a>
          </h4>
<p id="section-10.2.2-1">Sometimes it is helpful to have a single subscription that covers both periodic and on-change notifications (perhaps with dampening).<a href="#section-10.2.2-1" class="pilcrow">¶</a></p>
<p id="section-10.2.2-2">There are two ways in which this may be useful:<a href="#section-10.2.2-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-10.2.2-3">
<li id="section-10.2.2-3.1">
              <p id="section-10.2.2-3.1.1">For generally slow changing data (e.g., a device's physical inventory), then on-change notifications may be most appropriate.  However, in case there is any lost notification that isn't always detected, for any reason, then it may also be helpful to have a slow cadence periodic backup notification of the data (e.g., once every 24 hours), to ensure that the management systems should always eventually converge on the current state in the network.<a href="#section-10.2.2-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-10.2.2-3.2">
              <p id="section-10.2.2-3.2.1">For data that is generally polled on a periodic basis (e.g., once every 10 minutes) and put into a time series database, then it may be helpful for some data trees to also get more immediate notifications that the data has changed.  Hence, a combined periodic and on-change subscription, potentially with some dampening, would facilitate more frequent notifications of changes of the state, to reduce the need of having to always wait for the next periodic event.<a href="#section-10.2.2-3.2.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-10.2.2-4">Hence, this document introduces the fairly intuitive "periodic-and-on-change" update trigger that creates a combined periodic and on-change subscription, and allows the same parameters to be configured.  For some use cases, e.g., where a time-series database is being updated, the new encoding format proposed previously may be most useful.<a href="#section-10.2.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dscp-marking">
<section id="section-10.2.3">
          <h4 id="name-dscp-marking">
<a href="#section-10.2.3" class="section-number selfRef">10.2.3. </a><a href="#name-dscp-marking" class="section-name selfRef">DSCP Marking</a>
          </h4>
<p id="section-10.2.3-1">YANG Push Lite supports "dscp" marking to differentiate prioritization of notification messages during network transit.<a href="#section-10.2.3-1" class="pilcrow">¶</a></p>
<p id="section-10.2.3-2">If the publisher supports the "dscp" feature, then a subscription with a "dscp" leaf results in a corresponding Differentiated Services Code Point (DSCP) marking [RFC2474] being placed in the IP header of any resulting notification messages and subscription state change notifications.  A publisher <span class="bcp14">MUST</span> respect the DSCP markings for subscription traffic egressing that publisher.<a href="#section-10.2.3-2" class="pilcrow">¶</a></p>
<p id="section-10.2.3-3"><strong>TODO - Is this still relevant?</strong> Different DSCP code points require different transport connections.  As a result, where TCP is used, a publisher that supports the "dscp" feature must ensure that a subscription's notification messages are returned in a single TCP transport session where all traffic shares the subscription's "dscp" leaf value.  If this cannot be guaranteed, any "establish-subscription" RPC request <span class="bcp14">SHOULD</span> be rejected with a "dscp-unavailable" error.<a href="#section-10.2.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="ConfiguredAndDynamic">
<section id="section-11">
      <h2 id="name-setting-up-and-managing-sub">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-setting-up-and-managing-sub" class="section-name selfRef">Setting up and Managing Subscriptions</a>
      </h2>
<p id="section-11-1">Subscriptions can be set up and managed in two ways:<a href="#section-11-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-11-2">
<li id="section-11-2.1">
          <p id="section-11-2.1.1">Configured Subscriptions - a subscription created and controlled solely by configuration.<a href="#section-11-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-11-2.2">
          <p id="section-11-2.2.1">Dynamic Subscriptions - a subscription created and controlled via a YANG RPC from a telemetry receiver.<a href="#section-11-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<p id="section-11-3">Both configured and dynamic subscriptions are represented in the list
<em>datastore-telemetry/subscriptions/subscription</em>, and most of the functionality and behavior of configured and dynamic subscriptions described in this document is specified to be the same or very similar.  However, they differ in how they are created and in the associated lifecycle management, described in the following sections:<a href="#section-11-3" class="pilcrow">¶</a></p>
<p id="section-11-4">Additional characteristics differentiating configured from dynamic
subscriptions include the following:<a href="#section-11-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11-5.1">
          <p id="section-11-5.1.1">The lifetime of a dynamic subscription is bound by the transport
session used to establish it.  For connection-oriented stateful
transports like NETCONF, the loss of the transport session will
result in the immediate termination of any associated dynamic
subscriptions.  For connectionless or stateless transports like
HTTP, a lack of receipt acknowledgment of a sequential set of
notification messages and/or keep-alives can be used to trigger a
termination of a dynamic subscription.  Contrast this to the
lifetime of a configured subscription.  This lifetime is driven by
relevant configuration being present in the publisher's applied
configuration.  Being tied to configuration operations implies
that (1) configured subscriptions can be configured to persist
across reboots and (2) a configured subscription can persist even
when its publisher is fully disconnected from any network.<a href="#section-11-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-11-5.2">
          <p id="section-11-5.2.1">Configured subscriptions can be modified by any configuration
client with write permission on the configuration of the
subscription.  Dynamic subscriptions can only be modified via an
RPC request made by the original subscriber or by a change to
configuration data referenced by the subscription.<a href="#section-11-5.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-11-6">Note that there is no mixing and matching of dynamic and configured
operations on a single subscription.  Specifically, a configured
subscription cannot be modified or deleted using RPCs defined in this
document.  Similarly, a dynamic subscription cannot be directly
modified or deleted by configuration operations.  It is, however,
possible to perform a configuration operation that indirectly impacts
a dynamic subscription.  By changing the value of a preconfigured
filter referenced by an existing dynamic subscription, the selected
event records passed to a receiver might change.<a href="#section-11-6" class="pilcrow">¶</a></p>
<p id="section-11-7">A publisher <span class="bcp14">MAY</span> terminate a dynamic subscription at any time.
Similarly, it <span class="bcp14">MAY</span> decide to temporarily suspend the sending of
notification messages for any dynamic subscription, or for one or
more receivers of a configured subscription.  Such termination or
suspension is driven by internal considerations of the publisher.<a href="#section-11-7" class="pilcrow">¶</a></p>
<div id="configured-subscriptions">
<section id="section-11.1">
        <h3 id="name-configured-subscriptions">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-configured-subscriptions" class="section-name selfRef">Configured Subscriptions</a>
        </h3>
<p id="section-11.1-1">Configured subscriptions allow the management of subscriptions via configuration so that a publisher can send notification messages to a receiver.  Support for configured subscriptions is optional, with its availability advertised via the <em>configured</em> YANG feature in the ietf-yp-lite YANG model (<strong>TODO and also in the capabilities model?</strong>).<a href="#section-11.1-1" class="pilcrow">¶</a></p>
<p id="section-11.1-2">A configured subscription comprises:<a href="#section-11.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.1-3.1">
            <p id="section-11.1-3.1.1">the target datastore for the subscription, as per <span>[<a href="#RFC8342" class="cite xref">RFC8342</a>]</span>.<a href="#section-11.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.1-3.2">
            <p id="section-11.1-3.2.1">a set of selection filters to choose which datastore nodes the subscription is monitoring or sampling, as described in <a href="#pathsAndFilters" class="auto internal xref">Section 8</a><a href="#section-11.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.1-3.3">
            <p id="section-11.1-3.3.1">configuration for how update notifications for the data nodes are triggered.  I.e., either periodic sampling, on-change event-driven, or both. (<strong>TODO add section reference</strong>)<a href="#section-11.1-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.1-3.4">
            <p id="section-11.1-3.4.1">a set of associated receivers (as described in <a href="#receivers" class="auto internal xref">Section 10</a>) that specify transport, receiver, and encoding parameters.<a href="#section-11.1-3.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-11.1-4">Configured subscriptions have several characteristics distinguishing them from dynamic subscriptions:<a href="#section-11.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.1-5.1">
            <p id="section-11.1-5.1.1">persistence across publisher reboots,<a href="#section-11.1-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.1-5.2">
            <p id="section-11.1-5.2.1">a reference to receiver, is explicitly configured rather than being implicitly associated with the transport session, as would be the case for a dynamic subscription.<a href="#section-11.1-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.1-5.3">
            <p id="section-11.1-5.3.1">an ability to send notification messages to more than one receiver.  All receivers for a given subscription must use the same encoding and type of transport (<strong>TODO What about DSCP settings?</strong>).  <em>Note that receivers are unaware of the existence of any other receivers.</em><a href="#section-11.1-5.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-11.1-5.4">
            <p id="section-11.1-5.4.1">persistence even when transport or receiver is unavailable.  In this scenario, the publishers will terminate a subscription that it cannot keep active, but it will periodically attempt to restablish connection to the receiver and re-activate the configured subscription.<a href="#section-11.1-5.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-11.1-6">Multiple configured subscriptions <span class="bcp14">MUST</span> be supportable over a single transport session.<a href="#section-11.1-6" class="pilcrow">¶</a></p>
<p id="section-11.1-7">Below is a tree diagram for the "subscriptions" container.  All objects contained in this tree are described in the YANG module in <a href="#yp-lite-yang-module" class="auto internal xref">Section 15.2</a>.  In the operational datastore <span>[<a href="#RFC8342" class="cite xref">RFC8342</a>]</span>, the "subscription" list contains entries both for configured and dynamic subscriptions.<a href="#section-11.1-7" class="pilcrow">¶</a></p>
<span id="name-subscriptions-container-tre"></span><figure id="figure-4">
          <div class="lang-yangtree sourcecode" id="section-11.1-8.1">
<pre>
module: ietf-yp-lite
  +--rw datastore-telemetry
     +--rw subscriptions
        +--rw subscription* [id]
           +--rw id                               subscription-id
           +--rw target
           |  +--rw datastore?             identityref
           |  +--rw (filter)?
           |     +--:(by-reference)
           |     |  +--rw filter-ref       filter-ref
           |     +--:(within-subscription)
           |        +--rw (filter-spec)?
           |           +--:(paths)
           |           |  +--rw paths*     string
           |           +--:(subtree)
           |           |  +--rw subtree?   &lt;anydata&gt; {ypl:subtree}?
           |           +--:(xpaths)
           |              +--rw xpaths*    yang:xpath1.0 {ypl:xpath}?
           +--rw dscp?                            inet:dscp {dscp}?
           +--rw purpose?                         string
           |       {configured}?
           +--ro configured-subscription-state?   enumeration
           |       {configured}?
           +--rw receivers
           |  +--rw receiver* [name]
           |     +--rw name                      leafref
           |     +--ro sent-event-records?
           |     |       yang:zero-based-counter64
           |     +--ro excluded-event-records?
           |     |       yang:zero-based-counter64
           |     +--ro state                     enumeration
           |     +---x reset {configured}?
           |        +--ro output
           |           +--ro time    yang:date-and-time
           +--rw update-trigger
              +--rw periodic!
              |  +--rw period         centiseconds
              |  +--rw anchor-time?   yang:date-and-time
              +--rw on-change! {on-change}?
                 +--rw sync-on-start?   boolean
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-subscriptions-container-tre" class="selfRef">subscriptions container Tree Diagram</a>
          </figcaption></figure>
<div id="configured-subscription-state-machine">
<section id="section-11.1.1">
          <h4 id="name-configured-subscription-sta">
<a href="#section-11.1.1" class="section-number selfRef">11.1.1. </a><a href="#name-configured-subscription-sta" class="section-name selfRef">Configured Subscription State Machine</a>
          </h4>
<p id="section-11.1.1-1">Below is the state machine for a configured subscription on the publisher.  This state machine describes the three states (<em>valid</em>, <em>invalid</em>, and <em>concluded</em>) as well as the transitions between these states.  Start and end states are depicted to reflect configured subscription creation and deletion events.  The creation or modification of a configured subscription, referenced filter or receiver initiates an evaluation by the publisher to determine if the subscription is in the <em>valid</em> state or the <em>invalid</em> state.  The publisher uses its own criteria in making this determination.  If in the <em>valid</em> state, the subscription becomes operational.  See (1) in the diagram below.<a href="#section-11.1.1-1" class="pilcrow">¶</a></p>
<p id="section-11.1.1-2">**TODO - Add a new 'Active state' to the subscription state machine.  I.e., a subscription is active as long as it has at least one valid receiver (in some cases this would mean that negotiation with the receiver is complete, for others, such as simple UDP, is just requires configuration to be valid.)<a href="#section-11.1.1-2" class="pilcrow">¶</a></p>
<span id="name-publishers-state-machine-fo"></span><figure id="figure-5">
            <div class="alignLeft art-text artwork" id="section-11.1.1-3.1">
<pre>
.........
: start :-.
:.......: |
     create  .---modify----&lt;-----.
          |  |                   |
          V  V               .-------.         .......
 .----[evaluate]--no--------&gt;|invalid|-delete-&gt;: end :
 |                           '-------'         :.....:
 |-[re-evaluate]--no--(2)-.      ^                ^
 |        ^               |      |                |
yes       |               '-&gt;unsupportable      delete
 |      modify             (subscription-   (subscription-
 |        |                 terminated*)     terminated*)
 |        |                      |                |
(1)       |                     (3)              (4)
 |   .---------------------------------------------------.
 '--&gt;|                     valid                         |
     '---------------------------------------------------'

Legend:
  Dotted boxes: subscription added or removed via configuration
  Dashed boxes: states for a subscription
  [evaluate]: decision point on whether the subscription
              is supportable
  (*): resulting subscription state change notification
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-publishers-state-machine-fo" class="selfRef">Publisher's State Machine for a Configured Subscription</a>
            </figcaption></figure>
<p id="section-11.1.1-4">A subscription in the <em>valid</em> state may move to the <em>invalid</em> state in one of two ways.  First, it may be modified in a way that fails a re-evaluation.  See (2) in the diagram.  Second, the publisher might determine that the subscription is no longer supportable.  This could be because of an unexpected but sustained increase in an event stream's event records, degraded CPU capacity, a more complex referenced filter, or other subscriptions that have usurped
resources.  See (3) in the diagram.  No matter the case, a <em>subscription-terminated</em> notification is sent to any receivers in the <em>active</em> or state.  Finally, a subscription may be
deleted by configuration (4).<a href="#section-11.1.1-4" class="pilcrow">¶</a></p>
<p id="section-11.1.1-5">When a subscription is in the <em>valid</em> state, a publisher will attempt to connect with all receivers of a configured subscription and deliver notification messages.  Below is the state machine for each receiver of a configured subscription.  This receiver state machine is fully contained in the state machine of the configured subscription and is only relevant when the configured subscription is in the <em>valid</em> state.<a href="#section-11.1.1-5" class="pilcrow">¶</a></p>
<span id="name-receiver-state-machine-for-"></span><figure id="figure-6">
            <div class="alignLeft art-text artwork" id="section-11.1.1-6.1">
<pre>
.-----------------------------------------------------------.
|                         valid                             |
|   .----------.                           .------------.   |
|   | receiver |---timeout----------------&gt;|  receiver  |   |
|   |connecting|&lt;----------------reset--(c)|disconnected|   |
|   |          |&lt;-transport                '------------'   |
|   '----------'  loss,reset                                |
|      (a)          |                                       |
|  subscription-   (b)                                      |
|  started*    .--------.                                   |
|       '-----&gt;|        |                                   |
|              |receiver|                                   |
| subscription-| active |                                   |
|   modified*  |        |                                   |
|        '----&gt;'--------'                                   |
'-----------------------------------------------------------'

Legend:
  Dashed boxes that include the word *receiver* show the possible
  states for an individual receiver of a valid configured
  subscription.

* indicates a subscription state change notification
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-receiver-state-machine-for-" class="selfRef">Receiver State Machine for a Configured Subscription on a Publisher</a>
            </figcaption></figure>
<p id="section-11.1.1-7">When a configured subscription first moves to the <em>valid</em> state, the <em>state</em> leaf of each receiver is initialized to the <em>connecting</em> state.  If transport connectivity is not available to any receivers and there are any notification messages to deliver, a transport session is established (e.g., per [RFC8071]).  Individual receivers are moved to the <em>active</em> state when a <em>subscription-started</em> subscription state change notification is successfully passed to that
receiver (a).  Event records are only sent to active receivers. Receivers of a configured subscription remain active on the publisher if both (1) transport connectivity to the receiver is active and (2) event records are not being dropped due to a publisher's sending capacity being reached.  In addition, a configured subscription's receiver <span class="bcp14">MUST</span> be moved to the "connecting" state if the receiver is reset via the "reset" action (b), (c).  For more on the "reset" action, see Section 2.5.5.  If transport connectivity cannot be achieved while in the "connecting" state, the receiver <span class="bcp14">MAY</span> be moved to the "disconnected" state.<a href="#section-11.1.1-7" class="pilcrow">¶</a></p>
<p id="section-11.1.1-8">A configured subscription's receiver <span class="bcp14">MUST</span> be moved to the "suspended" state if there is transport connectivity between the publisher and receiver but (1) delivery of notification messages is failing due to a publisher's buffer capacity being reached or (2) notification
messages cannot be generated for that receiver due to insufficient CPU (d).  This is indicated to the receiver by the "subscription-suspended" subscription state change notification.<a href="#section-11.1.1-8" class="pilcrow">¶</a></p>
<p id="section-11.1.1-9">A configured subscription's receiver <span class="bcp14">MUST</span> be returned to the "active" state from the "suspended" state when notification messages can be generated, bandwidth is sufficient to handle the notification messages, and a receiver has successfully been sent a "subscription-
resumed" or "subscription-modified" subscription state change notification (e).  The choice as to which of these two subscription state change notifications is sent is determined by whether the subscription was modified during the period of suspension.<a href="#section-11.1.1-9" class="pilcrow">¶</a></p>
<p id="section-11.1.1-10">Modification of a configured subscription is possible at any time.  A "subscription-modified" subscription state change notification will be sent to all active receivers, immediately followed by notification messages conforming to the new parameters.  Suspended receivers will
also be informed of the modification.  However, this notification will await the end of the suspension for that receiver (e).<a href="#section-11.1.1-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="creating-a-configured-subscription">
<section id="section-11.1.2">
          <h4 id="name-creating-a-configured-subsc">
<a href="#section-11.1.2" class="section-number selfRef">11.1.2. </a><a href="#name-creating-a-configured-subsc" class="section-name selfRef">Creating a Configured Subscription</a>
          </h4>
<p id="section-11.1.2-1">Configured subscriptions are created using configuration operations against the top-level <em>subscriptions</em> subtree.<a href="#section-11.1.2-1" class="pilcrow">¶</a></p>
<p id="section-11.1.2-2">After a subscription is successfully established, the publisher immediately sends a "subscription-started" subscription state change notification to each receiver.  It is quite possible that upon configuration, reboot, or even steady-state operations, a transport
session may not be currently available to the receiver.  In this case, when there is something to transport for an active subscription, transport-specific "call home" operations [RFC8071]
will be used to establish the connection.  When transport connectivity is available, notification messages may then be pushed.<a href="#section-11.1.2-2" class="pilcrow">¶</a></p>
<p id="section-11.1.2-3">With active configured subscriptions, it is allowable to buffer event records even after a <em>subscription-started</em> has been sent.  However, if events are lost (rather than just delayed) due to buffer capacity being reached, a <em>subscription-terminated</em> notification must be sent, followed by a new subscription-started" notification. These notifications indicate an event record discontinuity has occurred.<a href="#section-11.1.2-3" class="pilcrow">¶</a></p>
<p id="section-11.1.2-4"><strong>TODO, to see an example of subscription creation using configuration operations over NETCONF, see Appendix A.</strong><a href="#section-11.1.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="modifying-a-configured-subscription">
<section id="section-11.1.3">
          <h4 id="name-modifying-a-configured-subs">
<a href="#section-11.1.3" class="section-number selfRef">11.1.3. </a><a href="#name-modifying-a-configured-subs" class="section-name selfRef">Modifying a Configured Subscription</a>
          </h4>
<p id="section-11.1.3-1">Configured subscriptions may end up being modified due to configuration changes in the <em>datastore-telemetry</em> container.<a href="#section-11.1.3-1" class="pilcrow">¶</a></p>
<p id="section-11.1.3-2">If the modification involves adding receivers, then those receivers are placed in the <em>connecting</em> state.  If a receiver is removed, the subscription state change notification <em>subscription-terminated</em> is sent to that receiver if that receiver is active or suspended.<a href="#section-11.1.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="deleting-a-configured-subscription">
<section id="section-11.1.4">
          <h4 id="name-deleting-a-configured-subsc">
<a href="#section-11.1.4" class="section-number selfRef">11.1.4. </a><a href="#name-deleting-a-configured-subsc" class="section-name selfRef">Deleting a Configured Subscription</a>
          </h4>
<p id="section-11.1.4-1">Configured subscriptions can be deleted via configuration.  After a subscription has been removed from configuration, the publisher <span class="bcp14">MAY</span> complete their current collection if one is in progress, then the publisher sends <em>subscription-terminated</em> notification to all of the subscription's receivers to indicate that the subscription is no longer active.<a href="#section-11.1.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="resetting-a-configured-subscriptions-receiver">
<section id="section-11.1.5">
          <h4 id="name-resetting-a-configured-subs">
<a href="#section-11.1.5" class="section-number selfRef">11.1.5. </a><a href="#name-resetting-a-configured-subs" class="section-name selfRef">Resetting a Configured Subscription's Receiver</a>
          </h4>
<p id="section-11.1.5-1"><strong>TODO: Is this RPC needed?  It may possibly be useful for a UDP based receiver.</strong><a href="#section-11.1.5-1" class="pilcrow">¶</a></p>
<p id="section-11.1.5-2">It is possible that a configured subscription to a receiver needs to be reset.  This is accomplished via the <em>reset</em> action in the YANG module at <em>/subscriptions/subscription/receivers/receiver/reset</em>.  This action may be useful in cases where a publisher has timed out
trying to reach a receiver.  When such a reset occurs, a transport session will be initiated if necessary, and a new <em>subscription-started</em> notification will be sent.  This action does not have any effect on transport connectivity if the needed connectivity already exists.<a href="#section-11.1.5-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="dynamic-subscriptions">
<section id="section-11.2">
        <h3 id="name-dynamic-subscriptions">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-dynamic-subscriptions" class="section-name selfRef">Dynamic Subscriptions</a>
        </h3>
<p id="section-11.2-1">Dynamic subscriptions, where a subscriber initiates a subscription negotiation with a publisher via an RPC.  If the publisher is able to serve this request, it accepts it and then starts pushing notification messages back to the subscriber.  If the publisher is not able to serve it as requested, then an error response is returned.<a href="#section-11.2-1" class="pilcrow">¶</a></p>
<p id="section-11.2-2">Dynamic subscriptions are managed via protocol operations (in the form of RPCs, per <span>[<a href="#RFC7950" class="cite xref">RFC7950</a>]</span>, Section 7.14) made against targets located in the publisher.  These RPCs have been designed extensibly so that they may be augmented for subscription targets beyond event streams.  For examples of such augmentations, see the RPC augmentations in the YANG data model provided in <span>[<a href="#RFC8641" class="cite xref">RFC8641</a>]</span>.<a href="#section-11.2-2" class="pilcrow">¶</a></p>
<div id="dynamic-subscription-state-machine">
<section id="section-11.2.1">
          <h4 id="name-dynamic-subscription-state-">
<a href="#section-11.2.1" class="section-number selfRef">11.2.1. </a><a href="#name-dynamic-subscription-state-" class="section-name selfRef">Dynamic Subscription State Machine</a>
          </h4>
<p id="section-11.2.1-1">Below is the publisher's state machine for a dynamic subscription. Each state is shown in its own box.  It is important to note that such a subscription doesn't exist at the publisher until an <em>establish-subscription</em> RPC is accepted.  The mere request by a subscriber to establish a subscription is not sufficient for that subscription to be externally visible.  Start and end states are depicted to reflect subscription creation and deletion events.<a href="#section-11.2.1-1" class="pilcrow">¶</a></p>
<span id="name-publishers-state-machine-for"></span><figure id="figure-7">
            <div class="alignLeft art-text artwork" id="section-11.2.1-2.1">
<pre>
                  .........
                  : start :
                  :.......:
                      |
              establish-subscription
                      |
                      |
                      v
                 .-----------.
                 | receiver  |
                 |  active   |
                 |           |
                 '-----------'
                      |
            delete/kill-subscription
                      |
                      v
                  .........
                  :  end  :
                  :.......:
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-publishers-state-machine-for" class="selfRef">Publisher's State Machine for a Dynamic Subscription</a>
            </figcaption></figure>
<p id="section-11.2.1-3">Of interest in this state machine are the following:<a href="#section-11.2.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.2.1-4.1">
              <p id="section-11.2.1-4.1.1">Successful "establish-subscription" RPCs move the subscription to the "active" state.<a href="#section-11.2.1-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.2.1-4.2">
              <p id="section-11.2.1-4.2.1">A "delete-subscription" or "kill-subscription" RPC will end the subscription.<a href="#section-11.2.1-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-11.2.1-4.3">
              <p id="section-11.2.1-4.3.1">A publisher may choose to end a subscription when there is not sufficient CPU or bandwidth available to service the subscription.  This is announced to the subscriber via the <em>subscription-terminated</em> subscription state change notification.  The receiver will need to establish a new subscription.<a href="#section-11.2.1-4.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="establishing-a-dynamic-subscription">
<section id="section-11.2.2">
          <h4 id="name-establishing-a-dynamic-subs">
<a href="#section-11.2.2" class="section-number selfRef">11.2.2. </a><a href="#name-establishing-a-dynamic-subs" class="section-name selfRef">Establishing a Dynamic Subscription</a>
          </h4>
<p id="section-11.2.2-1">The "establish-subscription" RPC allows a subscriber to request the creation of a subscription.<a href="#section-11.2.2-1" class="pilcrow">¶</a></p>
<p id="section-11.2.2-2">The input parameters of the operation are:<a href="#section-11.2.2-2" class="pilcrow">¶</a></p>
<p id="section-11.2.2-3">o  A "stream" name, which identifies the targeted event stream
  against which the subscription is applied.<a href="#section-11.2.2-3" class="pilcrow">¶</a></p>
<p id="section-11.2.2-4">o  An event stream filter, which may reduce the set of event records
  pushed.<a href="#section-11.2.2-4" class="pilcrow">¶</a></p>
<p id="section-11.2.2-5">o  If the transport used by the RPC supports multiple encodings, an
  optional "encoding" for the event records pushed.  If no
  "encoding" is included, the encoding of the RPC <span class="bcp14">MUST</span> be used.<a href="#section-11.2.2-5" class="pilcrow">¶</a></p>
<p id="section-11.2.2-6">If the publisher can satisfy the "establish-subscription" request, it
replies with an identifier for the subscription and then immediately
starts streaming notification messages.<a href="#section-11.2.2-6" class="pilcrow">¶</a></p>
<p id="section-11.2.2-7">Below is a tree diagram for "establish-subscription".  All objects
contained in this tree are described in the YANG module in <a href="#yp-lite-yang-module" class="auto internal xref">Section 15.2</a>.<a href="#section-11.2.2-7" class="pilcrow">¶</a></p>
<span id="name-establish-subscription-yang"></span><figure id="figure-8">
            <div class="lang-yangtree sourcecode" id="section-11.2.2-8.1">
<pre>
    +---x establish-subscription
    |  +---w input
    |  |  +---w target
    |  |  |  +---w datastore?             identityref
    |  |  |  +---w (filter)?
    |  |  |     +--:(by-reference)
    |  |  |     |  +---w filter-ref       filter-ref
    |  |  |     +--:(within-subscription)
    |  |  |        +---w (filter-spec)?
    |  |  |           +--:(paths)
    |  |  |           |  +---w paths*     string
    |  |  |           +--:(subtree)
    |  |  |           |  +---w subtree?   &lt;anydata&gt; {ypl:subtree}?
    |  |  |           +--:(xpaths)
    |  |  |              +---w xpaths*    yang:xpath1.0 {ypl:xpath}?
    |  |  +---w dscp?       inet:dscp {dscp}?
    |  |  +---w encoding?   encoding
    |  +--ro output
    |     +--ro id    subscription-id
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-establish-subscription-yang" class="selfRef">establish-subscription YANG RPC</a>
            </figcaption></figure>
<p id="section-11.2.2-9">A publisher <span class="bcp14">MAY</span> reject the "establish-subscription" RPC for many
reasons, as described in Section 2.4.6.<a href="#section-11.2.2-9" class="pilcrow">¶</a></p>
<p id="section-11.2.2-10">Below is a tree diagram for "establish-subscription-stream-error-
info" RPC yang-data.  All objects contained in this tree are
described in the YANG module in Section 4.<a href="#section-11.2.2-10" class="pilcrow">¶</a></p>
<span id="name-establish-subscription-stre"></span><figure id="figure-9">
            <div class="alignLeft art-text artwork" id="section-11.2.2-11.1">
<pre>
    yang-data establish-subscription-stream-error-info
      +--ro establish-subscription-stream-error-info
        +--ro reason?                   identityref
        +--ro filter-failure-hint?      string

        Figure 3: "establish-subscription-stream-error-info"
                    RPC yang-data Tree Diagram
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-establish-subscription-stre" class="selfRef">"establish-subscription-stream-error-info" Tree Diagram</a>
            </figcaption></figure>
<div id="negotiation-of-subscription-policies">
<section id="section-11.2.2.1">
            <h5 id="name-negotiation-of-subscription">
<a href="#section-11.2.2.1" class="section-number selfRef">11.2.2.1. </a><a href="#name-negotiation-of-subscription" class="section-name selfRef">Negotiation of Subscription Policies</a>
            </h5>
<p id="section-11.2.2.1-1">A dynamic subscription request <span class="bcp14">SHOULD</span> be declined if a publisher
determines that it may be unable to provide update records meeting
the terms of an "establish-subscription" RPC request.<a href="#section-11.2.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="deleting-a-dynamic-subscription">
<section id="section-11.2.3">
          <h4 id="name-deleting-a-dynamic-subscrip">
<a href="#section-11.2.3" class="section-number selfRef">11.2.3. </a><a href="#name-deleting-a-dynamic-subscrip" class="section-name selfRef">Deleting a Dynamic Subscription</a>
          </h4>
<p id="section-11.2.3-1">The <em>delete-subscription</em> operation permits canceling an existing
dynamic subscription that was established on the same transport session connecting to the subscriber.<a href="#section-11.2.3-1" class="pilcrow">¶</a></p>
<p id="section-11.2.3-2">If the publisher accepts the request, which it <span class="bcp14">MUST</span>, if the subscription-id matches a dynamic subscription established in the same transport session, then it should stop the subscription and send a <em>subscription-terminated</em> notification.<a href="#section-11.2.3-2" class="pilcrow">¶</a></p>
<p id="section-11.2.3-3">The publisher <span class="bcp14">MAY</span> reply back to the client before the subscription has been terminated, i.e., it may act asynchronously with respect to the request.  The publisher <span class="bcp14">SHOULD NOT</span> send any further events related to the subscription after the <em>subscription-terminated</em> notification and<a href="#section-11.2.3-3" class="pilcrow">¶</a></p>
<p id="section-11.2.3-4"><strong>TODO, I think that we should relax this to a <span class="bcp14">SHOULD</span></strong>  If the publisher accepts the request and the publisher
has indicated success, the publisher <span class="bcp14">MUST NOT</span> send any more
notification messages for this subscription.<a href="#section-11.2.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="killing-a-dynamic-subscription">
<section id="section-11.2.4">
          <h4 id="name-killing-a-dynamic-subscript">
<a href="#section-11.2.4" class="section-number selfRef">11.2.4. </a><a href="#name-killing-a-dynamic-subscript" class="section-name selfRef">Killing a Dynamic Subscription</a>
          </h4>
<p id="section-11.2.4-1">The "kill-subscription" RPC operation permits a client to forcibly end any arbitrary dynamic subscription, identified by subscription-id, including those not associated with the transport session used for the RPC.  Note, configured subscriptions cannot be killed using this RPC, and requests to do <span class="bcp14">MUST</span> be rejected.<a href="#section-11.2.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rpc-failures">
<section id="section-11.2.5">
          <h4 id="name-rpc-failures">
<a href="#section-11.2.5" class="section-number selfRef">11.2.5. </a><a href="#name-rpc-failures" class="section-name selfRef">RPC Failures</a>
          </h4>
<p id="section-11.2.5-1">Whenever an RPC is unsuccessful, the publisher returns relevant
information as part of the RPC error response.  Transport-level error
processing <span class="bcp14">MUST</span> be done before the RPC error processing described in
this section.  In all cases, RPC error information returned by the
publisher will use existing transport-layer RPC structures, such as
those seen with NETCONF (Appendix A of <span>[<a href="#RFC6241" class="cite xref">RFC6241</a>]</span>) or RESTCONF
(Section 7.1 of <span>[<a href="#RFC8040" class="cite xref">RFC8040</a>]</span>).  These structures <span class="bcp14">MUST</span> be able to encode
subscription-specific errors identified below and defined in this
document's YANG data model.<a href="#section-11.2.5-1" class="pilcrow">¶</a></p>
<p id="section-11.2.5-2">As a result of this variety, how subscription errors are encoded in
an RPC error response is transport dependent.  Valid errors that can
occur for each RPC are as follows:<a href="#section-11.2.5-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-11.2.5-3">
<pre>
  establish-subscription         modify-subscription
  ----------------------         ----------------------
  dscp-unavailable               filter-unsupported
  encoding-unsupported           insufficient-resources
  filter-unsupported             no-such-subscription
  insufficient-resources

  delete-subscription            kill-subscription
  ----------------------         ----------------------
  no-such-subscription           no-such-subscription
</pre><a href="#section-11.2.5-3" class="pilcrow">¶</a>
</div>
<p id="section-11.2.5-4">To see a NETCONF-based example of an error response from the list
above, see the "no-such-subscription" error response illustrated in
<span>[<a href="#RFC8640" class="cite xref">RFC8640</a>]</span>, Figure 10.<a href="#section-11.2.5-4" class="pilcrow">¶</a></p>
<p id="section-11.2.5-5">There is one final set of transport-independent RPC error elements
included in the YANG data model defined in this document: three
yang-data structures that enable the publisher to provide to the
receiver any error information that does not fit into existing
transport-layer RPC structures.  These structures are:<a href="#section-11.2.5-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-11.2.5-6">
<li id="section-11.2.5-6.1">
              <p id="section-11.2.5-6.1.1">"establish-subscription-stream-error-info": This <span class="bcp14">MUST</span> be returned
 with the leaf "reason" populated if an RPC error reason has not
 been placed elsewhere in the transport portion of a failed
 "establish-subscription" RPC response.  This <span class="bcp14">MUST</span> be sent if
 hints on how to overcome the RPC error are included.<a href="#section-11.2.5-6.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-11.2.5-6.2">
              <p id="section-11.2.5-6.2.1">"modify-subscription-stream-error-info": This <span class="bcp14">MUST</span> be returned
 with the leaf "reason" populated if an RPC error reason has not
 been placed elsewhere in the transport portion of a failed
 "modify-subscription" RPC response.  This <span class="bcp14">MUST</span> be sent if hints
 on how to overcome the RPC error are included.<a href="#section-11.2.5-6.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-11.2.5-6.3">
              <p id="section-11.2.5-6.3.1">"delete-subscription-error-info": This <span class="bcp14">MUST</span> be returned with the
 leaf "reason" populated if an RPC error reason has not been
 placed elsewhere in the transport portion of a failed
 "delete-subscription" or "kill-subscription" RPC response.<a href="#section-11.2.5-6.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
</section>
</div>
<div id="implementation-considerations-from-rfc-8639">
<section id="section-11.3">
        <h3 id="name-implementation-consideratio">
<a href="#section-11.3" class="section-number selfRef">11.3. </a><a href="#name-implementation-consideratio" class="section-name selfRef">Implementation Considerations (from RFC 8639)</a>
        </h3>
<p id="section-11.3-1">To support deployments that include both configured and dynamic
subscriptions, it is recommended that the subscription "id" domain be
split into static and dynamic halves.  This will eliminate the
possibility of collisions if the configured subscriptions attempt to
set a "subscription-id" that might have already been dynamically
allocated.  A best practice is to use the lower half of the "id"
object's integer space when that "id" is assigned by an external
entity (such as with a configured subscription).  This leaves the
upper half of the subscription integer space available to be
dynamically assigned by the publisher.<a href="#section-11.3-1" class="pilcrow">¶</a></p>
<p id="section-11.3-2">If a subscription is unable to marshal a series of filtered event
records into transmittable notification messages, the receiver should
be suspended with the reason "unsupportable-volume".<a href="#section-11.3-2" class="pilcrow">¶</a></p>
<p id="section-11.3-3">For configured subscriptions, operations are performed against the
set of receivers using the subscription "id" as a handle for that
set.  But for streaming updates, subscription state change
notifications are local to a receiver.  In the case of this
specification, receivers do not get any information from the
publisher about the existence of other receivers.  But if a network
operator wants to let the receivers correlate results, it is useful
to use the subscription "id" across the receivers to allow that
correlation.  Note that due to the possibility of different access
control permissions per receiver, each receiver may actually get a
different set of event records.<a href="#section-11.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="event-record-delivery">
<section id="section-11.4">
        <h3 id="name-event-record-delivery">
<a href="#section-11.4" class="section-number selfRef">11.4. </a><a href="#name-event-record-delivery" class="section-name selfRef">Event Record Delivery</a>
        </h3>
<p id="section-11.4-1">Whether dynamic or configured, once a subscription has been set up,
the publisher streams event records via notification messages per the
terms of the subscription.  For dynamic subscriptions, notification
messages are sent over the session used to establish the
subscription.  For configured subscriptions, notification messages
are sent over the connections specified by the transport and each
receiver of a configured subscription.<a href="#section-11.4-1" class="pilcrow">¶</a></p>
<p id="section-11.4-2">A notification message is sent to a receiver when an event record is
not blocked by either the specified filter criteria or receiver
permissions.  This notification message <span class="bcp14">MUST</span> include an &lt;eventTime&gt;
object, as shown in <span>[<a href="#RFC5277" class="cite xref">RFC5277</a>]</span>, Section 4.  This &lt;eventTime&gt; <span class="bcp14">MUST</span> be
at the top level of a YANG structured event record.<a href="#section-11.4-2" class="pilcrow">¶</a></p>
<p id="section-11.4-3">The following example of XML [W3C.REC-xml-20081126], adapted from
Section 4.2.10 of <span>[<a href="#RFC7950" class="cite xref">RFC7950</a>]</span>, illustrates a compliant message:<a href="#section-11.4-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-11.4-4">
<pre>
  &lt;notification
          xmlns="urn:ietf:params:xml:ns:netconf:notification:1.0"&gt;
      &lt;eventTime&gt;2007-09-01T10:00:00Z&lt;/eventTime&gt;
      &lt;link-failure xmlns="https://acme.example.com/system"&gt;
          &lt;if-name&gt;so-1/2/3.0&lt;/if-name&gt;
          &lt;if-admin-status&gt;up&lt;/if-admin-status&gt;
          &lt;if-oper-status&gt;down&lt;/if-oper-status&gt;
      &lt;/link-failure&gt;
  &lt;/notification&gt;

            Figure 10: Subscribed Notification Message
</pre><a href="#section-11.4-4" class="pilcrow">¶</a>
</div>
<p id="section-11.4-5"><span>[<a href="#RFC5277" class="cite xref">RFC5277</a>]</span>, Section 2.2.1 states that a notification message is to be
sent to a subscriber that initiated a &lt;create-subscription&gt;.  With
this document, this statement from <span>[<a href="#RFC5277" class="cite xref">RFC5277</a>]</span> should be more broadly
interpreted to mean that notification messages can also be sent to a
subscriber that initiated an "establish-subscription" or to a
configured receiver that has been sent a "subscription-started".<a href="#section-11.4-5" class="pilcrow">¶</a></p>
<p id="section-11.4-6">When a dynamic subscription has been started or modified with
"establish-subscription" or "modify-subscription", respectively,
event records matching the newly applied filter criteria <span class="bcp14">MUST NOT</span> be
sent until after the RPC reply has been sent.<a href="#section-11.4-6" class="pilcrow">¶</a></p>
<p id="section-11.4-7">When a configured subscription has been started or modified, event
records matching the newly applied filter criteria <span class="bcp14">MUST NOT</span> be sent
until after the "subscription-started" or "subscription-modified"
notification has been sent, respectively.<a href="#section-11.4-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="LifecycleNotifications">
<section id="section-12">
      <h2 id="name-subscription-lifecycle-noti">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-subscription-lifecycle-noti" class="section-name selfRef">Subscription Lifecycle Notifications</a>
      </h2>
<p id="section-12-1">In addition to sending event records to receivers, a publisher also sends subscription lifecycle state change notifications when lifecycle events related to subscription management occur.<a href="#section-12-1" class="pilcrow">¶</a></p>
<p id="section-12-2">Subscription state change notifications are generated per receiver, and are injected into the event stream of datastore update notifications for that receiver.  These notifications <span class="bcp14">MUST NOT</span> be dropped or filtered.<a href="#section-12-2" class="pilcrow">¶</a></p>
<p id="section-12-3">The complete set of subscription state change notifications is
described in the following subsections.<a href="#section-12-3" class="pilcrow">¶</a></p>
<p id="section-12-4">Future extensions, or implementations <span class="bcp14">MAY</span> provide additional details in the notifications through the use of YANG augmentations to add data nodes into the notification structures.<a href="#section-12-4" class="pilcrow">¶</a></p>
<div id="subscription-started">
<section id="section-12.1">
        <h3 id="name-subscription-started">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-subscription-started" class="section-name selfRef">"subscription-started"</a>
        </h3>
<p id="section-12.1-1">The subscription started notification is sent to a receiver to indicate that a subscription is active and they may start to receive <em>update</em> records from the publisher.<a href="#section-12.1-1" class="pilcrow">¶</a></p>
<p id="section-12.1-2">The subscription started notification may be sent to a receiver for any of these reasons:<a href="#section-12.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-12.1-3">
<li id="section-12.1-3.1">
            <p id="section-12.1-3.1.1">A new subscription has been configured.<a href="#section-12.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-12.1-3.2">
            <p id="section-12.1-3.2.1">A receiver has been added to a configured subscription.<a href="#section-12.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-12.1-3.3">
            <p id="section-12.1-3.3.1">The configuration for a configured subscription has been changed, in which case a <em>subscription-terminated</em> notification should be sent, followed by a <em>subscription-started</em> notification if the new configuration is valid.<a href="#section-12.1-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-12.1-3.4">
            <p id="section-12.1-3.4.1">A configured subscription previously failed, and was terminated.  After the publisher has successfully re-established a connection to the receiver and is starting to send datastore event records again.<a href="#section-12.1-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-12.1-3.5">
            <p id="section-12.1-3.5.1">A dynamic subscription has been established.<a href="#section-12.1-3.5.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-12.1-4">Below is the tree diagram for "subscription-started".  All objects
contained in this tree diagram are described in the YANG module in <a href="#yp-lite-yang-module" class="auto internal xref">Section 15.2</a>.<a href="#section-12.1-4" class="pilcrow">¶</a></p>
<span id="name-subscription-started-notifi"></span><figure id="figure-10">
          <div class="lang-yangtree sourcecode" id="section-12.1-5.1">
<pre>
    +---n subscription-started
    |  +--ro id         subscription-id
    |  +--ro target
    |  |  +--ro datastore?             identityref
    |  |  +--ro (filter)?
    |  |     +--:(by-reference)
    |  |     |  +--ro filter-ref       filter-ref
    |  |     +--:(within-subscription)
    |  |        +--ro (filter-spec)?
    |  |           +--:(paths)
    |  |           |  +--ro paths*     string
    |  |           +--:(subtree)
    |  |           |  +--ro subtree?   &lt;anydata&gt; {ypl:subtree}?
    |  |           +--:(xpaths)
    |  |              +--ro xpaths*    yang:xpath1.0 {ypl:xpath}?
    |  +--ro dscp?      inet:dscp {dscp}?
    |  +--ro purpose?   string {configured}?
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-subscription-started-notifi" class="selfRef">subscription-started Notification Tree Diagram</a>
          </figcaption></figure>
</section>
</div>
<div id="subscription-terminated">
<section id="section-12.2">
        <h3 id="name-subscription-terminated">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-subscription-terminated" class="section-name selfRef">"subscription-terminated"</a>
        </h3>
<p id="section-12.2-1">For a receiver, this notification indicates that no further event records for an active subscription should be expected from the publisher.<a href="#section-12.2-1" class="pilcrow">¶</a></p>
<p id="section-12.2-2">A <em>subscription-terminated</em> notification <span class="bcp14">SHOULD</span> only be sent by a publisher to a receiver if a <em>subscription-started</em> notification was previously sent.<a href="#section-12.2-2" class="pilcrow">¶</a></p>
<p id="section-12.2-3">A publisher <span class="bcp14">SHOULD NOT</span> send any further event records after the <em>subscription-terminated</em> notification.<a href="#section-12.2-3" class="pilcrow">¶</a></p>
<p id="section-12.2-4">The subscription terminated notification may be sent to a receiver for any of these reasons:<a href="#section-12.2-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-12.2-5">
<li id="section-12.2-5.1">
            <p id="section-12.2-5.1.1">A receiver has been removed from a configured subscription.<a href="#section-12.2-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-12.2-5.2">
            <p id="section-12.2-5.2.1">A configured subscription has been removed.<a href="#section-12.2-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-12.2-5.3">
            <p id="section-12.2-5.3.1">The configuration for a configured subscription has been changed, in which case a <em>subscription-terminated</em> notification should be sent, followed by a <em>subscription-started</em> notification if the new configuration is valid.<a href="#section-12.2-5.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-12.2-5.4">
            <p id="section-12.2-5.4.1">A dynamic subscription was deleted via a "delete-subscription* or <em>kill-subscription</em> RPC.<a href="#section-12.2-5.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-12.2-5.5">
            <p id="section-12.2-5.5.1">A subscription has failed for any reason, e.g.,:<a href="#section-12.2-5.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-12.2-5.5.2.1">
                <p id="section-12.2-5.5.2.1.1">The publisher is no longer able to honor the subscription, due to resource constraints, or the filter is no longer valid.<a href="#section-12.2-5.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-12.2-5.5.2.2">
                <p id="section-12.2-5.5.2.2.1">Any transport level buffer to the receiver has become full, and the hence the publisher is dropping <em>update</em> notifications.<a href="#section-12.2-5.5.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ol>
<p id="section-12.2-6">Below is a tree diagram for "subscription-terminated".  All objects
contained in this tree are described in the YANG module in <a href="#yp-lite-yang-module" class="auto internal xref">Section 15.2</a>.<a href="#section-12.2-6" class="pilcrow">¶</a></p>
<span id="name-subscription-terminated-not"></span><figure id="figure-11">
          <div class="lang-yangtree sourcecode" id="section-12.2-7.1">
<pre>
    +---n subscription-terminated
    |  +--ro id        subscription-id
    |  +--ro reason    identityref
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-subscription-terminated-not" class="selfRef">subscription-terminated Notification Tree Diagram</a>
          </figcaption></figure>
<p id="section-12.2-8"><strong>TODO Augmenting extra fields is better for clients?</strong>  The <em>reason</em> datanode identifyref indicates why a subcription has been terminated, and could be extended with further reasons in future.<a href="#section-12.2-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="replay-completed">
<section id="section-12.3">
        <h3 id="name-replay-completed">
<a href="#section-12.3" class="section-number selfRef">12.3. </a><a href="#name-replay-completed" class="section-name selfRef">"replay-completed"</a>
        </h3>
<p id="section-12.3-1"><strong>TODO: Need to consider how this works when notifications are split up.</strong><a href="#section-12.3-1" class="pilcrow">¶</a></p>
<p id="section-12.3-2">This notification indicates that all of the event records prior to
the current time have been passed to a receiver.  It is sent before
any notification messages containing an event record with a timestamp
later than (1) the subscription's start time.<a href="#section-12.3-2" class="pilcrow">¶</a></p>
<p id="section-12.3-3">After the "replay-completed" notification has been sent, additional event records will be sent in sequence as they arise naturally on the publisher.<a href="#section-12.3-3" class="pilcrow">¶</a></p>
<p id="section-12.3-4">Below is a tree diagram for "replay-completed".  All objects
contained in this tree are described in the YANG module in Section 4.<a href="#section-12.3-4" class="pilcrow">¶</a></p>
<span id="name-replay-completed-notificati"></span><figure id="figure-12">
          <div class="lang-yangtree sourcecode" id="section-12.3-5.1">
<pre>
    +---n replay-completed
    |  +--ro id    subscription-id
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-replay-completed-notificati" class="selfRef">replay-completed Notification Tree Diagram</a>
          </figcaption></figure>
</section>
</div>
</section>
</div>
<div id="performance-reliability-and-subscription-monitoring">
<section id="section-13">
      <h2 id="name-performance-reliability-and">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-performance-reliability-and" class="section-name selfRef">Performance, Reliability, and Subscription Monitoring</a>
      </h2>
<p id="section-13-1"><strong>TODO.  Not sure if this text doesn't end up elsewhere?</strong><a href="#section-13-1" class="pilcrow">¶</a></p>
<p id="section-13-2">A subscription to updates from a datastore is intended to obviate the
need for polling.  However, in order to do so, it is critical that
subscribers can rely on the subscription and have confidence that
they will indeed receive the subscribed updates without having to
worry about updates being silently dropped.  In other words, a
subscription constitutes a promise on the side of the publisher to
provide the receivers with updates per the terms of the subscription.<a href="#section-13-2" class="pilcrow">¶</a></p>
<p id="section-13-3">Now, there are many reasons why a publisher may at some point no
longer be able to fulfill the terms of the subscription, even if the
subscription had been initiated in good faith.  For example, the
volume of datastore nodes may be larger than anticipated, the
interval may prove too short to send full updates in rapid
succession, or an internal problem may prevent objects from being
collected.  For this reason, the solution defined in this document
(1) mandates that a publisher notify receivers immediately and
reliably whenever it encounters a situation in which it is unable to
keep the terms of the subscription and (2) provides the publisher
with the option to suspend the subscription in such a case.  This
includes indicating the fact that an update is incomplete as part of
a "push-update" or "push-change-update" notification, as well as
emitting a "subscription-suspended" notification as applicable.  This
is described further in Section 3.11.1.<a href="#section-13-3" class="pilcrow">¶</a></p>
<p id="section-13-4">A publisher <span class="bcp14">SHOULD</span> reject a request for a subscription if it is
unlikely that the publisher will be able to fulfill the terms of that
subscription request.  In such cases, it is preferable to have a
subscriber request a less resource-intensive subscription than to
deal with frequently degraded behavior.<a href="#section-13-4" class="pilcrow">¶</a></p>
<p id="section-13-5">The solution builds on <span>[<a href="#RFC8639" class="cite xref">RFC8639</a>]</span>.  As defined therein, any loss of an
underlying transport connection will be detected and result in
subscription termination (in the case of dynamic subscriptions) or
suspension (in the case of configured subscriptions), ensuring that
situations where the loss of update notifications would go unnoticed
will not occur.<a href="#section-13-5" class="pilcrow">¶</a></p>
<div id="subscription-monitoring">
<section id="section-13.1">
        <h3 id="name-subscription-monitoring">
<a href="#section-13.1" class="section-number selfRef">13.1. </a><a href="#name-subscription-monitoring" class="section-name selfRef">Subscription Monitoring</a>
        </h3>
<p id="section-13.1-1">In the operational state datastore, the "subscriptions" container
maintains the state of all dynamic subscriptions as well as all
configured subscriptions.  Using datastore retrieval operations
<span>[<a href="#RFC8641" class="cite xref">RFC8641</a>]</span> or subscribing to the "subscriptions" container
(Section 3.3) allows the state of subscriptions and their
connectivity to receivers to be monitored.<a href="#section-13.1-1" class="pilcrow">¶</a></p>
<p id="section-13.1-2">Each subscription in the operational state datastore is represented
as a list element.  Included in this list are event counters for each
receiver, the state of each receiver, and the subscription parameters
currently in effect.  The appearance of the leaf "configured-
subscription-state" indicates that a particular subscription came<a href="#section-13.1-2" class="pilcrow">¶</a></p>
<p id="section-13.1-3">into being via configuration.  This leaf also indicates whether the
current state of that subscription is "valid", "invalid", or
"concluded".<a href="#section-13.1-3" class="pilcrow">¶</a></p>
<p id="section-13.1-4">To understand the flow of event records in a subscription, there are
two counters available for each receiver.  The first counter is
"sent-event-records", which shows the number of events identified for
sending to a receiver.  The second counter is "excluded-event-
records", which shows the number of event records not sent to a
receiver.  "excluded-event-records" shows the combined results of
both access control and per-subscription filtering.  For configured
subscriptions, counters are reset whenever the subscription's state
is evaluated as "valid" (see (1) in Figure 8).<a href="#section-13.1-4" class="pilcrow">¶</a></p>
<p id="section-13.1-5">Dynamic subscriptions are removed from the operational state
datastore when they are terminated.  While many subscription objects
are shown as configurable, dynamic subscriptions are only included
in the operational state datastore and as a result are not configurable.<a href="#section-13.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="robustness-and-reliability">
<section id="section-13.2">
        <h3 id="name-robustness-and-reliability">
<a href="#section-13.2" class="section-number selfRef">13.2. </a><a href="#name-robustness-and-reliability" class="section-name selfRef">Robustness and Reliability</a>
        </h3>
<p id="section-13.2-1">It is important that updates as discussed in this document, and
on-change updates in particular, do not get lost.  If the loss of an
update is unavoidable, it is critical that the receiver be notified
accordingly.<a href="#section-13.2-1" class="pilcrow">¶</a></p>
<p id="section-13.2-2">Update records for a single subscription <span class="bcp14">MUST NOT</span> be resequenced
prior to transport.<a href="#section-13.2-2" class="pilcrow">¶</a></p>
<p id="section-13.2-3">It is conceivable that, under certain circumstances, a publisher will
recognize that it is unable to include in an update record the full
set of objects desired per the terms of a subscription.  In this
case, the publisher <span class="bcp14">MUST</span> act as follows:<a href="#section-13.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.2-4.1">
            <p id="section-13.2-4.1.1">The publisher <span class="bcp14">MUST</span> set the "incomplete-update" flag on any update
    record that is known to be missing information.<a href="#section-13.2-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-13.2-4.2">
            <p id="section-13.2-4.2.1">The publisher <span class="bcp14">MAY</span> choose to suspend the subscription as per
    <span>[<a href="#RFC8639" class="cite xref">RFC8639</a>]</span>.  If the publisher does not create an update record at
    all, it <span class="bcp14">MUST</span> suspend the subscription.<a href="#section-13.2-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-13.2-4.3">
            <p id="section-13.2-4.3.1">When resuming an on-change subscription, the publisher <span class="bcp14">SHOULD</span>
    generate a complete patch from the previous update record.  If
    this is not possible and the "sync-on-start" option is set to
    "true" for the subscription, then the full datastore contents <span class="bcp14">MAY</span>
    be sent via a "push-update" instead (effectively replacing the
    previous contents).  If neither scenario above is possible, then
    an "incomplete-update" flag <span class="bcp14">MUST</span> be included on the next
    "push-change-update".<a href="#section-13.2-4.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-13.2-5">Note: It is perfectly acceptable to have a series of "push-change-
update" notifications (and even "push-update" notifications) serially
queued at the transport layer awaiting transmission.  It is not
required for the publisher to merge pending update records sent at
the same time.<a href="#section-13.2-5" class="pilcrow">¶</a></p>
<p id="section-13.2-6">On the receiver side, what action to take when a record with an
"incomplete-update" flag is received depends on the application.  It
could simply choose to wait and do nothing.  It could choose to
resync, actively retrieving all subscribed information.  It could
also choose to tear down the subscription and start a new one,
perhaps with a smaller scope that contains fewer objects.<a href="#section-13.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="publisher-capacity">
<section id="section-13.3">
        <h3 id="name-publisher-capacity">
<a href="#section-13.3" class="section-number selfRef">13.3. </a><a href="#name-publisher-capacity" class="section-name selfRef">Publisher Capacity</a>
        </h3>
<p id="section-13.3-1">It is far preferable to decline a subscription request than to accept
such a request when it cannot be met.<a href="#section-13.3-1" class="pilcrow">¶</a></p>
<p id="section-13.3-2">Whether or not a subscription can be supported will be determined by
a combination of several factors, such as the subscription update
trigger (on-change or periodic), the period in which to report
changes (one-second periods will consume more resources than one-hour
periods), the amount of data in the datastore subtree that is being
subscribed to, and the number and combination of other subscriptions
that are concurrently being serviced.<a href="#section-13.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ConformanceAndCapabilities">
<section id="section-14">
      <h2 id="name-conformance-and-capabilitie">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-conformance-and-capabilitie" class="section-name selfRef">Conformance and Capabilities</a>
      </h2>
<p id="section-14-1">The capabilities model (documented at XXX) should be used by devices to advertise likely subscription capabilities.  In addition, the YANG Push Lite operational data gives an indication of the overall telemetry load on the device and hence gives an indication to whether a particular telemetry request is likely to be accepted, and honored.<a href="#section-14-1" class="pilcrow">¶</a></p>
<p id="section-14-2"><strong>TODO Text needs updating, taken from on-change section</strong><a href="#section-14-2" class="pilcrow">¶</a></p>
<p id="section-14-3">In those cases, it will be important for client applications to have
a way to identify for which objects on-change notifications are
supported and for which ones they are not supported.  Otherwise,
client applications will have no way of knowing whether they can
indeed rely on their on-change subscription to provide them with the
change updates that they are interested in.  In other words, if
implementations do not provide a solution and do not support
comprehensive on-change notifiability, clients of those
implementations will have no way of knowing what their on-change
subscription actually covers.<a href="#section-14-3" class="pilcrow">¶</a></p>
<p id="section-14-4">Implementations are therefore strongly advised to provide a solution
to this problem.  One solution might involve making discoverable to
clients which objects are on-change notifiable, specified using
another YANG data model.  Such a solution is specified in
<strong>Yang-Push-Notif-Cap</strong>.  Until this solution is standardized,
implementations <span class="bcp14">SHOULD</span> provide their own solution.<a href="#section-14-4" class="pilcrow">¶</a></p>
<p id="section-14-5">**TODO  Do we need to add capabilities to indicate:<a href="#section-14-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-14-6">
<li id="section-14-6.1">
          <p id="section-14-6.1.1">Which fields are on-change notifiable.<a href="#section-14-6.1.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-14-6.2">
          <p id="section-14-6.2.1">At which level <em>bags</em> exist internally (for performance reasons).<a href="#section-14-6.2.1" class="pilcrow">¶</a></p>
</li>
        <li id="section-14-6.3">
          <p id="section-14-6.3.1">The points at which subscriptions are decomposed to.**<a href="#section-14-6.3.1" class="pilcrow">¶</a></p>
</li>
      </ol>
<div id="subscription-content-schema-identification">
<section id="section-14.1">
        <h3 id="name-subscription-content-schema">
<a href="#section-14.1" class="section-number selfRef">14.1. </a><a href="#name-subscription-content-schema" class="section-name selfRef">Subscription Content Schema Identification</a>
        </h3>
<p id="section-14.1-1">YANG Module Synchronization<a href="#section-14.1-1" class="pilcrow">¶</a></p>
<p id="section-14.1-2">To make subscription requests, the subscriber needs to know the YANG
datastore schemas used by the publisher.  These schemas are available
in the YANG library module ietf-yang-library.yang as defined in
[RFC8525].  The receiver is expected to know the YANG library
information before starting a subscription.<a href="#section-14.1-2" class="pilcrow">¶</a></p>
<p id="section-14.1-3">The set of modules, revisions, features, and deviations can change at
runtime (if supported by the publisher implementation).  For this
purpose, the YANG library provides a simple "ya8639ng-library-change"
notification that informs the subscriber that the library has
changed.  In this case, a subscription may need to be updated to take
the updates into account.  The receiver may also need to be informed
of module changes in order to process updates regarding datastore<a href="#section-14.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ietf-yp-lite-yang">
<section id="section-15">
      <h2 id="name-yang">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-yang" class="section-name selfRef">YANG</a>
      </h2>
<div id="yp-lite-tree">
<section id="section-15.1">
        <h3 id="name-ietf-yp-lite-yang-tree">
<a href="#section-15.1" class="section-number selfRef">15.1. </a><a href="#name-ietf-yp-lite-yang-tree" class="section-name selfRef">ietf-yp-lite YANG tree</a>
        </h3>
<p id="section-15.1-1">This section shows the full tree output for ietf-yp-lite YANG module.<a href="#section-15.1-1" class="pilcrow">¶</a></p>
<p id="section-15.1-2">Note, this output does not include support for any transport configuration, and at least one would expect to be configurable.<a href="#section-15.1-2" class="pilcrow">¶</a></p>
<p id="section-15.1-3"><strong>TODO What about capabilities?  Perhaps further explanation is needed here?</strong><a href="#section-15.1-3" class="pilcrow">¶</a></p>
<span id="name-yang-tree-for-yang-push-lit"></span><figure id="figure-13">
          <div class="breakable lang-yangtree sourcecode" id="section-15.1-4.1">
<pre>
module: ietf-yp-lite
  +--rw datastore-telemetry
     +--rw filters
     |  +--rw filter* [name]
     |     +--rw name             string
     |     +--rw (filter-spec)?
     |        +--:(paths)
     |        |  +--rw paths*     string
     |        +--:(subtree)
     |        |  +--rw subtree?   &lt;anydata&gt; {ypl:subtree}?
     |        +--:(xpaths)
     |           +--rw xpaths*    yang:xpath1.0 {ypl:xpath}?
     +--rw subscriptions
     |  +--rw subscription* [id]
     |     +--rw id                               subscription-id
     |     +--rw target
     |     |  +--rw datastore?             identityref
     |     |  +--rw (filter)?
     |     |     +--:(by-reference)
     |     |     |  +--rw filter-ref       filter-ref
     |     |     +--:(within-subscription)
     |     |        +--rw (filter-spec)?
     |     |           +--:(paths)
     |     |           |  +--rw paths*     string
     |     |           +--:(subtree)
     |     |           |  +--rw subtree?   &lt;anydata&gt; {ypl:subtree}?
     |     |           +--:(xpaths)
     |     |              +--rw xpaths*    yang:xpath1.0 {ypl:xpath}?
     |     +--rw dscp?                            inet:dscp {dscp}?
     |     +--rw purpose?                         string
     |     |       {configured}?
     |     +--ro configured-subscription-state?   enumeration
     |     |       {configured}?
     |     +--rw receivers
     |     |  +--rw receiver* [name]
     |     |     +--rw name                      leafref
     |     |     +--ro sent-event-records?
     |     |     |       yang:zero-based-counter64
     |     |     +--ro excluded-event-records?
     |     |     |       yang:zero-based-counter64
     |     |     +--ro state                     enumeration
     |     |     +---x reset {configured}?
     |     |        +--ro output
     |     |           +--ro time    yang:date-and-time
     |     +--rw update-trigger
     |        +--rw periodic!
     |        |  +--rw period         centiseconds
     |        |  +--rw anchor-time?   yang:date-and-time
     |        +--rw on-change! {on-change}?
     |           +--rw sync-on-start?   boolean
     +--rw receivers
        +--rw receiver* [name]
           +--rw name                      string
           +--rw encoding?                 encoding
           +--rw dscp?                     inet:dscp {dscp}?
           +--rw (notification-message-origin)? {configured}?
           |  +--:(interface-originated)
           |  |  +--rw source-interface?   if:interface-ref
           |  |          {interface-designation}?
           |  +--:(address-originated)
           |     +--rw source-vrf?         leafref {supports-vrf}?
           |     +--rw source-address?     inet:ip-address-no-zone
           +--rw (transport-type)

  rpcs:
    +---x establish-subscription
    |  +---w input
    |  |  +---w target
    |  |  |  +---w datastore?             identityref
    |  |  |  +---w (filter)?
    |  |  |     +--:(by-reference)
    |  |  |     |  +---w filter-ref       filter-ref
    |  |  |     +--:(within-subscription)
    |  |  |        +---w (filter-spec)?
    |  |  |           +--:(paths)
    |  |  |           |  +---w paths*     string
    |  |  |           +--:(subtree)
    |  |  |           |  +---w subtree?   &lt;anydata&gt; {ypl:subtree}?
    |  |  |           +--:(xpaths)
    |  |  |              +---w xpaths*    yang:xpath1.0 {ypl:xpath}?
    |  |  +---w dscp?       inet:dscp {dscp}?
    |  |  +---w encoding?   encoding
    |  +--ro output
    |     +--ro id    subscription-id
    +---x delete-subscription
    |  +---w input
    |     +---w id    subscription-id
    +---x kill-subscription
       +---w input
          +---w id    subscription-id

  notifications:
    +---n replay-completed
    |  +--ro id    subscription-id
    +---n subscription-started
    |  +--ro id         subscription-id
    |  +--ro target
    |  |  +--ro datastore?             identityref
    |  |  +--ro (filter)?
    |  |     +--:(by-reference)
    |  |     |  +--ro filter-ref       filter-ref
    |  |     +--:(within-subscription)
    |  |        +--ro (filter-spec)?
    |  |           +--:(paths)
    |  |           |  +--ro paths*     string
    |  |           +--:(subtree)
    |  |           |  +--ro subtree?   &lt;anydata&gt; {ypl:subtree}?
    |  |           +--:(xpaths)
    |  |              +--ro xpaths*    yang:xpath1.0 {ypl:xpath}?
    |  +--ro dscp?      inet:dscp {dscp}?
    |  +--ro purpose?   string {configured}?
    +---n subscription-terminated
    |  +--ro id        subscription-id
    |  +--ro reason    identityref
    +---n update
    |  +--ro id?                   subscription-id
    |  +--ro subscription-path?    yang:xpath1.0
    |  +--ro target-path?          string
    |  +--ro snapshot-type?        enumeration
    |  +--ro observation-time?     yang:date-and-time
    |  +--ro datastore-snapshot?   &lt;anydata&gt;
    |  +--ro incomplete?           empty
    +---n update-2
    |  +--ro id?                  subscription-id
    |  +--ro subscription-path?   yang:xpath1.0
    |  +--ro snapshot-type?       enumeration
    |  +--ro observation-time?    yang:date-and-time
    |  +--ro updates* [target-path]
    |  |  +--ro target-path           string
    |  |  +--ro datastore-snapshot?   &lt;anydata&gt;
    |  +--ro incomplete?          empty
    +---n datanode-delete
       +--ro id?                  subscription-id
       +--ro subscription-path?   yang:xpath1.0
       +--ro target-path?         string
       +--ro observation-time?    yang:date-and-time
</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-yang-tree-for-yang-push-lit" class="selfRef">YANG tree for YANG Push Lite Module Tree Output</a>
          </figcaption></figure>
</section>
</div>
<div id="yp-lite-yang-module">
<section id="section-15.2">
        <h3 id="name-ietf-yp-lite-yang-model">
<a href="#section-15.2" class="section-number selfRef">15.2. </a><a href="#name-ietf-yp-lite-yang-model" class="section-name selfRef">ietf-yp-lite YANG Model</a>
        </h3>
<p id="section-15.2-1">This module imports typedefs from <span>[<a href="#RFC6991" class="cite xref">RFC6991</a>]</span>, <span>[<a href="#RFC8343" class="cite xref">RFC8343</a>]</span>, <span>[<a href="#RFC8341" class="cite xref">RFC8341</a>]</span>, <span>[<a href="#RFC8529" class="cite xref">RFC8529</a>]</span>, and <span>[<a href="#RFC8342" class="cite xref">RFC8342</a>]</span>.  It references <span>[<a href="#RFC6241" class="cite xref">RFC6241</a>]</span>, <span>[<a href="#XPATH" class="cite xref">XPATH</a>]</span> ("XML Path Language (XPath) Version 1.0"), <span>[<a href="#RFC7049" class="cite xref">RFC7049</a>]</span>, <span>[<a href="#RFC8259" class="cite xref">RFC8259</a>]</span>, <span>[<a href="#RFC7950" class="cite xref">RFC7950</a>]</span>, <span>[<a href="#RFC7951" class="cite xref">RFC7951</a>]</span>, and <span>[<a href="#RFC7540" class="cite xref">RFC7540</a>]</span>.<a href="#section-15.2-1" class="pilcrow">¶</a></p>
<p id="section-15.2-2">This YANG module imports typedefs from <span>[<a href="#RFC6991" class="cite xref">RFC6991</a>]</span>, identities from
<span>[<a href="#RFC8342" class="cite xref">RFC8342</a>]</span>, and the "sx:structure" extension from <span>[<a href="#RFC8791" class="cite xref">RFC8791</a>]</span>. It also references <span>[<a href="#RFC6241" class="cite xref">RFC6241</a>]</span>, <span>[<a href="#XPATH" class="cite xref">XPATH</a>]</span>, and <span>[<a href="#RFC7950" class="cite xref">RFC7950</a>]</span>.<a href="#section-15.2-2" class="pilcrow">¶</a></p>
<span id="name-yang-module-ietf-yp-lite"></span><figure id="figure-14">
          <div class="breakable lang-yang sourcecode" id="section-15.2-3.1">
<pre>&lt;CODE BEGINS&gt; file "ietf-yp-lite.yang#0.1.0"

module ietf-yp-lite {
  yang-version 1.1;
  namespace "urn:ietf:params:xml:ns:yang:ietf-yp-lite";
  prefix ypl;

  import ietf-inet-types {
    prefix inet;
    reference
      "RFC 6991: Common YANG Data Types";
  }
  import ietf-interfaces {
    prefix if;
    reference
      "RFC 8343: A YANG Data Model for Interface Management";
  }
  import ietf-netconf-acm {
    prefix nacm;
    reference
      "RFC 8341: Network Configuration Access Control Model";
  }
  import ietf-network-instance {
    prefix ni;
    reference
      "RFC 8529: YANG Data Model for Network Instances";
  }
  import ietf-yang-structure-ext {
    prefix sx;
    reference
      "RFC 8525: YANG Data Structure Extensions";
  }
  import ietf-yang-types {
    prefix yang;
    reference
      "RFC 6991: Common YANG Data Types";
  }
  import ietf-datastores {
    prefix ds;
    reference
      "RFC 8342: Network Management Datastore Architecture (NMDA)";
  }

  organization
    "IETF NETCONF (Network Configuration) Working Group";
  contact
    "WG Web:  &lt;https:/datatracker.ietf.org/wg/netconf/&gt;
     WG List: &lt;mailto:netconf@ietf.org&gt;

     Author:  Robert Wilton
              &lt;mailto:rwilton@cisco.com&gt;";
  description
    "This module contains YANG specifications for YANG-Push lite,
     a simplified version of the YANG-Push [RFC 8641] protocol.

     The key words 'MUST', 'MUST NOT', 'REQUIRED', 'SHALL', 'SHALL
     NOT', 'SHOULD', 'SHOULD NOT', 'RECOMMENDED', 'NOT RECOMMENDED',
     'MAY', and 'OPTIONAL' in this document are to be interpreted as
     described in BCP 14 (RFC 2119) (RFC 8174) when, and only when,
     they appear in all capitals, as shown here.

     Copyright (c) 2024 IETF Trust and the persons identified as
     authors of the code.  All rights reserved.

     Redistribution and use in source and binary forms, with or
     without modification, is permitted pursuant to, and subject to
     the license terms contained in, the Simplified BSD License set
     forth in Section 4.c of the IETF Trust's Legal Provisions
     Relating to IETF Documents
     (https://trustee.ietf.org/license-info).

     This version of this YANG module is part of XXX; see the
     RFC itself for full legal notices.";

  revision 2024-11-11 {
    description
      "Initial revision.";
    reference
      "XXX: YANG Push Lite";
  }

  /*
   * FEATURES
   */

  feature configured {
    description
      "This feature indicates that configuration of subscriptions is
       supported.";
  }

  feature dscp {
    description
      "This feature indicates that a publisher supports the ability
       to set the Differentiated Services Code Point (DSCP) value in
       outgoing packets.";
  }

  feature encode-json {
    description
      "This feature indicates that JSON encoding of notification
       messages is supported.";
  }

  feature encode-xml {
    description
      "This feature indicates that XML encoding of notification
       messages is supported.";
  }

  feature interface-designation {
    description
      "This feature indicates that a publisher supports sourcing all
       receiver interactions for a configured subscription from a
       single designated egress interface.";
  }

  feature on-change {
    description
      "This feature indicates that on-change triggered subscriptions
       are supported.";
  }

  feature subtree {
    description
      "This feature indicates support for YANG subtree filtering.";
    reference
      "RFC 6241: Network Configuration Protocol (NETCONF),
                 Section 6";
  }

  feature supports-vrf {
    description
      "This feature indicates that a publisher supports VRF
       configuration for configured subscriptions.  VRF support for
       dynamic subscriptions does not require this feature.";
    reference
      "RFC 8529: YANG Data Model for Network Instances,
                 Section 6";
  }

  feature xpath {
    description
      "This feature indicates support for XPath filtering.";
    reference
      "XML Path Language (XPath) Version 1.0
       (https://www.w3.org/TR/1999/REC-xpath-19991116)";
  }

  /*
   * IDENTITIES
   */
  /* Identities for RPC and notification errors */

  identity delete-subscription-error {
    description
      "Base identity for the problem found while attempting to
       fulfill either a 'delete-subscription' RPC request or a
       'kill-subscription' RPC request.";
  }

  identity establish-subscription-error {
    description
      "Base identity for the problem found while attempting to
       fulfill an 'establish-subscription' RPC request.";
  }

  identity subscription-terminated-reason {
    description
      "Base identity for the problem condition communicated to a
       receiver as part of a 'subscription-terminated'
       notification.";
  }

  identity dscp-unavailable {
    base establish-subscription-error;
    if-feature "dscp";
    description
      "The publisher is unable to mark notification messages with
       prioritization information in a way that will be respected
       during network transit.";
  }

  identity encoding-unsupported {
    base establish-subscription-error;
    description
      "Unable to encode notification messages in the desired
       format.";
  }

  identity filter-unavailable {
    base subscription-terminated-reason;
    description
      "Referenced filter does not exist.  This means a receiver is
       referencing a filter that doesn't exist or to which it
       does not have access permissions.";
  }

  identity filter-unsupported {
    base establish-subscription-error;
    description
      "Cannot parse syntax in the filter.  This failure can be from
       a syntax error or a syntax too complex to be processed by the
       publisher.";
  }

  identity insufficient-resources {
    base establish-subscription-error;
    description
      "The publisher does not have sufficient resources to support
       the requested subscription.  An example might be that
       allocated CPU is too limited to generate the desired set of
       notification messages.";
  }

  identity no-such-subscription {
    base delete-subscription-error;
    base subscription-terminated-reason;
    description
      "Referenced subscription doesn't exist.  This may be as a
       result of a nonexistent subscription ID, an ID that belongs to
       another subscriber, or an ID for a configured subscription.";
  }

  identity stream-unavailable {
    base subscription-terminated-reason;
    description
      "Not a subscribable event stream.  This means the referenced
       event stream is not available for subscription by the
       receiver.";
  }

  identity suspension-timeout {
    base subscription-terminated-reason;
    description
      "Termination of a previously suspended subscription.  The
       publisher has eliminated the subscription, as it exceeded a
       time limit for suspension.";
  }

  identity unsupportable-volume {
    base subscription-terminated-reason;
    description
      "The publisher does not have the network bandwidth needed to
       get the volume of generated information intended for a
       receiver.";
  }

  /* Identities for encodings */

  identity configurable-encoding {
    description
      "If a transport identity derives from this identity, it means
       that it supports configurable encodings.  An example of a
       configurable encoding might be a new identity such as
       'encode-cbor'.  Such an identity could use
       'configurable-encoding' as its base.  This would allow a
       dynamic subscription encoded in JSON (RFC 8259) to request
       that notification messages be encoded via the Concise Binary
       Object Representation (CBOR) (RFC 7049).  Further details for
       any specific configurable encoding would be explored in a
       transport document based on this specification.

       TODO - Clear up this text or use YANG-CBOR reference";
    reference
      "RFC 8259: The JavaScript Object Notation (JSON) Data
                 Interchange Format
       RFC 7049: Concise Binary Object Representation (CBOR)";
  }

  identity encoding {
    description
      "Base identity to represent data encodings.";
  }

  identity encode-xml {
    base encoding;
    if-feature "encode-xml";
    description
      "Encode data using XML as described in RFC 7950.";
    reference
      "RFC 7950: The YANG 1.1 Data Modeling Language";
  }

  identity encode-json {
    base encoding;
    if-feature "encode-json";
    description
      "Encode data using JSON as described in RFC 7951.";
    reference
      "RFC 7951: JSON Encoding of Data Modeled with YANG";
  }

  /* Identities for transports */

  identity transport {
    description
      "An identity that represents the underlying mechanism for
       passing notification messages.";
  }

  /*
   * TYPEDEFs
   */

  typedef encoding {
    type identityref {
      base encoding;
    }
    description
      "Specifies a data encoding, e.g., for a data subscription.";
  }

  typedef subscription-id {
    type uint32;
    description
      "A type for subscription identifiers.";
  }

  typedef transport {
    type identityref {
      base transport;
    }
    description
      "Specifies the transport used to send notification messages
       to a receiver.";
  }

// TODO - Consider changes to list keys or reordering of user-ordered lists.

  typedef filter-ref {
    type leafref {
      path "/datastore-telemetry/filters/filter/name";
    }
    description
      "This type is used to reference a selection filter.";
  }

  typedef centiseconds {
    type uint32;
    description
      "A period of time, measured in units of 0.01 seconds.";
  }

  /*
   * GROUPINGS
   */

  grouping update-qos {
    description
      "This grouping describes QoS information concerning a
       subscription.  This information is passed to lower layers
       for transport prioritization and treatment.";
    leaf dscp {
      if-feature "dscp";
      type inet:dscp;
      default "0";
      description
        "The desired network transport priority level.  This is the
         priority set on notification messages encapsulating the
         results of the subscription.  This transport priority is
         shared for all receivers of a given subscription.";
    }
  }

  grouping subscription-policy-modifiable {
    description
      "This grouping describes all objects that may be changed
       in a subscription.";
    container target {
      description
        "Identifies the source of information against which a
         subscription is being applied as well as specifics on the
         subset of information desired from that source.";
      uses datastore-criteria;

    }
  }

  grouping subscription-policy-dynamic {
    description
      "This grouping describes the only information concerning a
       subscription that can be passed over the RPCs defined in this
       data model.";
    uses subscription-policy-modifiable;
    // TODO - The description should be updated to be hierarchical.
    uses update-qos;
  }

  grouping subscription-policy {
    description
      "This grouping describes the full set of policy information
       concerning both dynamic and configured subscriptions, with the
       exclusion of both receivers and networking information
       specific to the publisher, such as what interface should be
       used to transmit notification messages.";
    uses subscription-policy-dynamic;

    leaf purpose {
      if-feature "configured";
      type string;
      description
        "Open text allowing a configuring entity to embed the
         originator or other specifics of this subscription.";
    }
  }

grouping datastore-criteria {
    description
      "A grouping to define criteria for which selected objects from
       a targeted datastore should be included in push updates.";
    leaf datastore {
      type identityref {
        base ds:datastore;
      }
      default "ds:operational";
      description
        "Datastore from which to retrieve data, defaults to operational";
    }
    uses filter-objects;
  }

  grouping filter-types {
    description
      "This grouping defines the types of selectors for objects
       from a datastore.";
    choice filter-spec {
      description
        "The content filter specification for this request.";

      leaf-list paths {
        type string;
        description
          "A basic path filter that allows wildcard, regex, or
           fixed value for list keys.  Each format is TODO";
      }
      anydata subtree {
        if-feature "ypl:subtree";
        description
          "This parameter identifies the portions of the
           target datastore to retrieve.";
        reference
          "RFC 6241: Network Configuration Protocol (NETCONF),
                     Section 6";
      }
      leaf-list xpaths {
        if-feature "ypl:xpath";
        type yang:xpath1.0;
        description
          "This parameter contains an XPath expression identifying
           the portions of the target datastore to retrieve.

           If the expression returns a node set, all nodes in the
           node set are selected by the filter.  Otherwise, if the
           expression does not return a node set, the filter
           doesn't select any nodes.

           The expression is evaluated in the following XPath
           context:

           o  The set of namespace declarations is the set of prefix
              and namespace pairs for all YANG modules implemented
              by the server, where the prefix is the YANG module
              name and the namespace is as defined by the
              'namespace' statement in the YANG module.

              If the leaf is encoded in XML, all namespace
              declarations in scope on the 'stream-xpath-filter'
              leaf element are added to the set of namespace
              declarations.  If a prefix found in the XML is
              already present in the set of namespace declarations,
              the namespace in the XML is used.

           o  The set of variable bindings is empty.

           o  The function library is comprised of the core
              function library and the XPath functions defined in
              Section 10 in RFC 7950.

           o  The context node is the root node of the target
              datastore.";
        reference
          "XML Path Language (XPath) Version 1.0
           (https://www.w3.org/TR/1999/REC-xpath-19991116)
           RFC 7950: The YANG 1.1 Data Modeling Language,
                     Section 10";
      }
    }
  }

  grouping filter-objects {
    description
      "This grouping defines a selector for objects from a
       datastore.";
    choice filter {
      description
        "The source of the selection filter applied to the
         subscription.  This will either (1) come referenced from a
         global list or (2) be provided in the subscription itself.";
      case by-reference {
        description
          "Incorporates a filter that has been configured
           separately.";
        leaf filter-ref {
          type filter-ref;
          mandatory true;
          description
            "References an existing selection filter that is to be
             applied to the subscription.";
        }
      }
      case within-subscription {
        description
          "A local definition allows a filter to have the same
           lifecycle as the subscription.";
        uses filter-types;
      }
    }
  }

  grouping update-policy-modifiable {
    description
      "This grouping describes the datastore-specific subscription
       conditions that can be changed during the lifetime of the
       subscription.";

    container update-trigger {
      description
        "This container describes all conditions under which
         subscription update messages are generated";

      container periodic {
        presence "indicates a periodic subscription";
        description
          "The publisher is requested to periodically notify the
            receiver regarding the current values of the datastore
            as defined by the selection filter.";
        leaf period {
          type centiseconds;
          mandatory true;
          description
            "Duration of time that should occur between periodic
              push updates, in units of 0.01 seconds.";
        }
        leaf anchor-time {
          type yang:date-and-time;
          description
            "Designates a timestamp before or after which a series
              of periodic push updates are determined.  The next
              update will take place at a point in time that is a
              multiple of a period from the 'anchor-time'.
              For example, for an 'anchor-time' that is set for the
              top of a particular minute and a period interval of a
              minute, updates will be sent at the top of every
              minute that this subscription is active.";
        }
      }
      container on-change {
        if-feature "on-change";
        presence "indicates an on-change subscription";
        description
          "The publisher is requested to notify the receiver
            regarding changes in values in the datastore subset as
            defined by a selection filter.";
      }
    }
  }

  grouping update-policy {
    description
      "This grouping describes the datastore-specific subscription
       conditions of a subscription.";
    uses update-policy-modifiable {
      augment "update-trigger/on-change" {
        description
          "Includes objects that are not modifiable once a
           subscription is established.";
        leaf sync-on-start {
          type boolean;
          default "true";
          description
            "When this object is set to 'false', (1) it restricts an
             on-change subscription from sending 'push-update'
             notifications and (2) pushing a full selection per the
             terms of the selection filter MUST NOT be done for
             this subscription.  Only updates about changes
             (i.e., only 'push-change-update' notifications)
             are sent.  When set to 'true' (the default behavior),
             in order to facilitate a receiver's synchronization,
             a full update is sent, via a 'push-update' notification,
             when the subscription starts.  After that,
             'push-change-update' notifications are exclusively sent,
             unless the publisher chooses to resync the subscription
             via a new 'push-update' notification.";
        }
      }
    }
  }

  /*
   * RPCs
   */

  rpc establish-subscription {
    description
      "This RPC allows a subscriber to create (and possibly
       negotiate) a subscription on its own behalf.  If successful,
       the subscription remains in effect for the duration of the
       subscriber's association with the publisher or until the
       subscription is terminated.  If an error occurs or the
       publisher cannot meet the terms of a subscription, an RPC
       error is returned, and the subscription is not created.
       In that case, the RPC reply's 'error-info' MAY include
       suggested parameter settings that would have a higher
       likelihood of succeeding in a subsequent
       'establish-subscription' request.";
    input {
      uses subscription-policy-dynamic;
      leaf encoding {
        type encoding;
        description
          "The type of encoding for the subscribed data.  If not
           included as part of the RPC, the encoding MUST be set by
           the publisher to be the encoding used by this RPC.";
      }
    }
    output {
      leaf id {
        type subscription-id;
        mandatory true;
        description
          "Identifier used for this subscription.";
      }
    }
  }

  sx:structure establish-subscription-stream-error-info {
    container establish-subscription-stream-error-info {
      description
        "If any 'establish-subscription' RPC parameters are
         unsupportable against the event stream, a subscription
         is not created and the RPC error response MUST indicate the
         reason why the subscription failed to be created.  This
         yang-data MAY be inserted as structured data in a
         subscription's RPC error response to indicate the reason for
         the failure.  This yang-data MUST be inserted if hints are
         to be provided back to the subscriber.";
      leaf reason {
        type identityref {
          base establish-subscription-error;
        }
        description
          "Indicates the reason why the subscription has failed to
           be created to a targeted event stream.";
      }
      leaf filter-failure-hint {
        type string;
        description
          "Information describing where and/or why a provided
           filter was unsupportable for a subscription.  The
           syntax and semantics of this hint are
           implementation specific.";
      }
    }
  }

  rpc delete-subscription {
    description
      "This RPC allows a subscriber to delete a subscription that
       was previously created by that same subscriber using the
       'establish-subscription' RPC.

       Only subscriptions that were created using
       'establish-subscription' from the same origin as this RPC
       can be deleted via this RPC. // TODO - Why same origin?

       If an error occurs, the server replies with an 'rpc-error'
       where the 'error-info' field MAY contain a
       'delete-subscription-error-info' structure.";
    input {
      leaf id {
        type subscription-id;
        mandatory true;
        description
          "Identifier of the dynamic subscription that is to be deleted.";
      }
    }
    // TODO - Add result.
    // output {

    // }
  }

  rpc kill-subscription {
    nacm:default-deny-all;
    description
      "This RPC allows an operator to delete a dynamic subscription
       without restrictions on the originating subscriber or
       underlying transport session.

       Only dynamic subscriptions, i.e., those that were created using
       'establish-subscription', may be deleted via this RPC.

       If an error occurs, the server replies with an 'rpc-error'
       where the 'error-info' field MAY contain a
       'delete-subscription-error-info' structure.";
    input {
      leaf id {
        type subscription-id;
        mandatory true;
        description
          "Identifier of the dynamic subscription that is to be deleted.";
      }
    }
  }

  sx:structure delete-subscription-error-info {
    container delete-subscription-error-info {
      description
        "If a 'delete-subscription' RPC or a 'kill-subscription' RPC
         fails, the subscription is not deleted and the RPC error
         response MUST indicate the reason for this failure.  This
         yang-data MAY be inserted as structured data in a
         subscription's RPC error response to indicate the reason
         for the failure.";
      leaf reason {
        type identityref {
          base delete-subscription-error;
        }
        mandatory true;
        description
          "Indicates the reason why the subscription has failed to be
           deleted.";
      }
    }
  }

  /*
   * NOTIFICATIONS
   */

  // TODO - Need to signal when an initial replay has completed, or possibly
  //        when any period subscription has completed.  TODO, need to think
  //        about list key entries that are no longer present.
  notification replay-completed {
    //ypl:subscription-state-notification;
    //if-feature "replay";
    description
      "This notification is sent to indicate that all of the replay
       notifications have been sent.";
    leaf id {
      type subscription-id;
      mandatory true;
      description
        "This references the affected subscription.";
    }
  }

  notification subscription-started {
    //ypl:subscription-state-notification;
    description
      "This notification indicates that a configured subscription has
       started and notifications will now be sent.";
    leaf id {
      type subscription-id;
      mandatory true;
      description
        "This references the affected subscription.";
    }
    uses subscription-policy;
  }

  notification subscription-terminated {
    //ypl:subscription-state-notification;
    description
      "This notification indicates that a subscription has been
       terminated.";
    leaf id {
      type subscription-id;
      mandatory true;
      description
        "This references the affected subscription.";
    }
    leaf reason {
      type identityref {
        base subscription-terminated-reason;
      }
      mandatory true;
      description
        "Identifies the condition that resulted in the termination.";
    }
  }

  notification update {
    description
      "This notification contains a push update that in turn contains
       data subscribed to via a subscription.  In the case of a
       periodic subscription, this notification is sent for periodic
       updates.  It can also be used for synchronization updates of
       an on-change subscription.  This notification shall only be
       sent to receivers of a subscription.  It does not constitute
       a general-purpose notification that would be subscribable as
       part of the NETCONF event stream by any receiver.";
    leaf id {
      type subscription-id;
      description
        "This references the subscription that drove the
         notification to be sent.";
    }

    leaf subscription-path {
      type yang:xpath1.0;
      description
        "The subscription path indicates the schema path from the root of the
         schema tree to the node, for which the updated state is being
         notified, or a notification that is has been deleted.

         TODO - Make this an instance data ref";
    }

    leaf target-path {
      type string;
    }

    leaf snapshot-type {
      type enumeration {
        enum "periodic" {
          description
            "The update message is due to a periodic update.";
        }
        enum "on-change-update" {
          description
            "The update message is due to an on-change update.  This
             means that one or more fields have changed under the
             snapshot path.

             TODO - Split this into a on-change-delete msg?";
        }
        enum "on-change-delete" {
          description
            "The update message is due to an on-change event where
             the data node at the target path has been delete.";
        }
        enum "resync" {
          description
            "This indicates that the update is to resynchronize the
             state, e.g., after a subscription started notification.

             Ideally, the resync message SHOULD be the first
             notification sent when a subscription has started, but
             it is not gauranteed or required to be the first
             (e.g., if an on-change event occurs).

             These messages can be used to ensure that all state
             has been sent to the client, and can be used to purge
             stale data.

             TODO - In the distributed notification case, need a
             notification to indicate that all child subscriptions
             have been sent.";
        }
      }
      description
        "This indicates the type of notification message that is being sent.";
    }

    // Could add observation time here.
    leaf observation-time {
      type yang:date-and-time;
      description
        "The time that the update was observed by the publisher.";
    }

    anydata datastore-snapshot {
      description
        "This contains the updated data.  It constitutes a snapshot
        at the time of update of the set of data that has been
        subscribed to.  The snapshot corresponds to the same
        snapshot that would be returned in a corresponding 'get'
        operation with the same selection filter parameters
        applied.

        Used for snapshot types except for 'on-change-delete'.";
    }

    leaf incomplete {
      type empty;
      description
        "This is a flag that indicates that not all datastore
        nodes subscribed to are included with this update.  Receivers
        of this data SHOULD NOT assume that any missing data has been
        implicitly deleted.

        TODO - Do we still want this flag, or would it be
        better to notify this event out of band?";
    }
  }

  notification update-2 {
    description
      "This notification contains a push update that in turn contains
       data subscribed to via a subscription.  In the case of a
       periodic subscription, this notification is sent for periodic
       updates.  It can also be used for synchronization updates of
       an on-change subscription.  This notification shall only be
       sent to receivers of a subscription.  It does not constitute
       a general-purpose notification that would be subscribable as
       part of the NETCONF event stream by any receiver.";
    leaf id {
      type subscription-id;
      description
        "This references the subscription that drove the
         notification to be sent.";
    }

    leaf subscription-path {
      type yang:xpath1.0;
      description
        "The subscription path indicates the schema path from the root of the
         schema tree to the node, for which the updated state is being
         notified, or a notification that is has been deleted.

         TODO - Make this an instance data ref";
    }

    leaf snapshot-type {
      type enumeration {
        enum "periodic" {
          description
            "The update message is due to a periodic update.";
        }
        enum "on-change-update" {
          description
            "The update message is due to an on-change update.  This
             means that one or more fields have changed under the
             snapshot path.

             TODO - Split this into a on-change-delete msg?";
        }
        enum "on-change-delete" {
          description
            "The update message is due to an on-change event where
             the data node at the target path has been delete.";
        }
        enum "resync" {
          description
            "This indicates that the update is to resynchronize the
             state, e.g., after a subscription started notification.

             Ideally, the resync message SHOULD be the first
             notification sent when a subscription has started, but
             it is not gauranteed or required to be the first
             (e.g., if an on-change event occurs).

             These messages can be used to ensure that all state
             has been sent to the client, and can be used to purge
             stale data.

             TODO - In the distributed notification case, need a
             notification to indicate that all child subscriptions
             have been sent.";
        }
      }
      description
        "This indicates the type of notification message that is being sent.";
    }

    // Could add observation time here.
    leaf observation-time {
      type yang:date-and-time;
      description
        "The time that the update was observed by the publisher.";
    }

    list updates {
      key "target-path";
      description
        "This list contains the updated data.  It constitutes a snapshot
         at the time of update of the set of data that has been
         subscribed to.  The snapshot corresponds to the same
         snapshot that would be returned in a corresponding 'get'
         operation with the same selection filter parameters
         applied.";
      leaf target-path {
        type string;
      }

      anydata datastore-snapshot {
        description
          "This contains the updated data.  It constitutes a snapshot
          at the time of update of the set of data that has been
          subscribed to.  The snapshot corresponds to the same
          snapshot that would be returned in a corresponding 'get'
          operation with the same selection filter parameters
          applied.

          Used for snapshot types except for 'on-change-delete'.";
      }
    }

    leaf incomplete {
      type empty;
      description
        "This is a flag that indicates that not all datastore
        nodes subscribed to are included with this update.  Receivers
        of this data SHOULD NOT assume that any missing data has been
        implicitly deleted.

        TODO - Do we still want this flag, or would it be
        better to notify this event out of band?";
    }
  }

  notification datanode-delete {
    description
      "This on-change datanode-delete notification is used to indicate
       that the datanode at the path specified by the target path has been
       deleted.  This notification shall only be sent to receivers
       of a subscription.  It does not constitute a general-purpose
       notification that would be subscribable as part of the
       NETCONF event stream by any receiver.";
    leaf id {
      type subscription-id;
      description
        "This references the subscription that drove the
         notification to be sent.";
    }

    leaf subscription-path {
      type yang:xpath1.0;
      description
        "The subscription path indicates the schema path from the root of the
         schema tree to the data node that has been deleted.

         TODO - Make this an instance data ref";
    }

    leaf target-path {
      type string;
    }

    leaf observation-time {
      type yang:date-and-time;
      description
        "The time that the data node delete events was observed by
         the publisher.";
    }
  }

  /*
   * DATA NODES
   */

container datastore-telemetry {
    container filters {
      description
        "Contains a list of configurable filters that can be applied to
        subscriptions.  This facilitates the reuse of complex filters
        once defined.";
    }
    container subscriptions {
      description
        "Contains the list of currently active subscriptions, i.e.,
        subscriptions that are currently in effect, used for
        subscription management and monitoring purposes.  This
        includes subscriptions that have been set up via
        RPC primitives as well as subscriptions that have been
        established via configuration.";
      list subscription {
        key "id";
        description
          "The identity and specific parameters of a subscription.
          Subscriptions in this list can be created using a control
          channel or RPC or can be established through configuration.

          If the 'kill-subscription' RPC or configuration operations
          are used to delete a subscription, a
          'subscription-terminated' message is sent to any active or
          suspended receivers.";
        leaf id {
          type subscription-id;
          description
            "Identifier of a subscription; unique in a given
            publisher.";
        }
        uses subscription-policy;
        leaf configured-subscription-state {
          if-feature "configured";
          type enumeration {
            enum valid {
              value 1;
              description
                "The subscription is supportable with its current
                parameters.";
            }
            enum invalid {
              value 2;
              description
                "The subscription as a whole is unsupportable with its
                current parameters.";
            }
            enum concluded {
              value 3;
              description
                "A subscription is inactive, as it has hit a
                stop time.  It no longer has receivers in the
                'active' or 'suspended' state, but the subscription
                has not yet been removed from configuration.";
            }
          }
          config false;
          description
            "The presence of this leaf indicates that the subscription
            originated from configuration, not through a control
            channel or RPC.  The value indicates the state of the
            subscription as established by the publisher.";
        }
        container receivers {
          description
            "Set of receivers in a subscription.";
          list receiver {
            key "name";
            min-elements 1;
            description
              "A host intended as a recipient for the notification
              messages of a subscription.  For configured
              subscriptions, transport-specific network parameters
              (or a leafref to those parameters) may be augmented to a
              specific receiver in this list.";
            leaf name {
              type leafref {
                path "/datastore-telemetry/receivers/receiver/name";
              }
              description
                "Identifies a unique receiver for a subscription.";
            }
            leaf sent-event-records {
              type yang:zero-based-counter64;
              config false;
              description
                "The number of event records sent to the receiver.  The
                count is initialized when a dynamic subscription is
                established or when a configured receiver
                transitions to the 'valid' state.";
            }
            leaf excluded-event-records {
              type yang:zero-based-counter64;
              config false;
              description
                "The number of event records explicitly removed via
                either an event stream filter or an access control
                filter so that they are not passed to a receiver.
                This count is set to zero each time
                'sent-event-records' is initialized.";
            }
            leaf state {
              type enumeration {
                enum active {
                  value 1;
                  description
                    "The receiver is currently being sent any
                    applicable notification messages for the
                    subscription.";
                }
                enum suspended {
                  value 2;
                  description
                    "The receiver state is 'suspended', so the
                    publisher is currently unable to provide
                    notification messages for the subscription.";
                }
                enum connecting {
                  value 3;
                  if-feature "configured";
                  description
                    "A subscription has been configured, but a
                    'subscription-started' subscription state change
                    notification needs to be successfully received
                    before notification messages are sent.

                    If the 'reset' action is invoked for a receiver of
                    an active configured subscription, the state
                    must be moved to 'connecting'.";
                }
                enum disconnected {
                  value 4;
                  if-feature "configured";
                  description
                    "A subscription has failed to send a
                    'subscription-started' state change to the
                    receiver.  Additional connection attempts are not
                    currently being made.";
                }
              }
              config false;
              mandatory true;
              description
                "Specifies the state of a subscription from the
                perspective of a particular receiver.  With this
                information, it is possible to determine whether a
                publisher is currently generating notification
                messages intended for that receiver.";
            }
            // TODO - Do we want the reset action?
            action reset {
              if-feature "configured";
              description
                "Allows the reset of this configured subscription's
                receiver to the 'connecting' state.  This enables the
                connection process to be reinitiated.";
              output {
                leaf time {
                  type yang:date-and-time;
                  mandatory true;
                  description
                    "Time at which a publisher returned the receiver to
                    the 'connecting' state.";
                }
              }
            }
          }
        }
      }
    }
    container receivers {
      description
        "A container for all instances of receivers.";

      list receiver {
        key "name";

        leaf name {
          type string;
          description
            "An arbitrary but unique name for this receiver
            instance.";
        }

        leaf encoding {
  /*        when 'not(../transport) or derived-from(../transport,
          "ypl:configurable-encoding")';*/
          type encoding;
          description
            "The type of encoding for notification messages.  For a
              dynamic subscription, if not included as part of an
              'establish-subscription' RPC, the encoding will be populated
              with the encoding used by that RPC.  For a configured
              subscription, if not explicitly configured, the encoding
              will be the default encoding for an underlying transport.";
        }

        uses update-qos;

        choice notification-message-origin {
          if-feature "configured";
          description
            "Identifies the egress interface on the publisher
            from which notification messages are to be sent.";
          case interface-originated {
            description
              "When notification messages are to egress a specific,
              designated interface on the publisher.";
            leaf source-interface {
              if-feature "interface-designation";
              type if:interface-ref;
              description
                "References the interface for notification messages.";
            }
          }
          case address-originated {
            description
              "When notification messages are to depart from a
              publisher using a specific originating address and/or
              routing context information.";
            leaf source-vrf {
              if-feature "supports-vrf";
              type leafref {
                path "/ni:network-instances/ni:network-instance/ni:name";
              }
              description
                "VRF from which notification messages should egress a
                publisher.";
            }
            leaf source-address {
              type inet:ip-address-no-zone;
              description
                "The source address for the notification messages.
                If a source VRF exists but this object doesn't, a
                publisher's default address for that VRF must
                be used.";
            }
          }
        }

        choice transport-type {
          mandatory true;
          description
            "Choice of different types of transports used to
              send notifications.  The 'case' statements must
              be augmented in by other modules.";
        }

        description
          "A list of all receiver instances.";
      }
    }
  }

  augment "/datastore-telemetry/filters" {
    description
      "This augmentation allows the datastore to be included as part
       of the filtering criteria for a subscription.";
    list filter {
      key "name";
      description
        "A list of preconfigured filters that can be applied
         to datastore subscriptions.";
      leaf name {
        type string;
        description
          "A unique name to identify the selection filters.";
      }
      uses filter-types;
    }
  }

  augment "/datastore-telemetry/subscriptions/subscription" {
    description
      "This augmentation adds objects to a subscription that are
       specific to a datastore subscription, i.e., a subscription to
       a stream of datastore node updates.";
    uses update-policy;
  }
}

&lt;CODE ENDS&gt;</pre>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-yang-module-ietf-yp-lite" class="selfRef">YANG module ietf-yp-lite</a>
          </figcaption></figure>
</section>
</div>
</section>
</div>
<div id="security">
<section id="section-16">
      <h2 id="name-security-considerations">
<a href="#section-16" class="section-number selfRef">16. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-16-1">TODO.  New YANG models will be defined that need to document their security considerations, but otherwise the security considerations in YANG-Push should be sufficient.  Note, we should use the new security considerations template, which will allow this section to be considerable shorter.<a href="#section-16-1" class="pilcrow">¶</a></p>
<p id="section-16-2">With configured subscriptions, one or more publishers could be used
to overwhelm a receiver.  To counter this, notification messages
<span class="bcp14">SHOULD NOT</span> be sent to any receiver that does not support this
specification.  Receivers that do not want notification messages need
only terminate or refuse any transport sessions from the publisher.<a href="#section-16-2" class="pilcrow">¶</a></p>
<p id="section-16-3">When a receiver of a configured subscription gets a new
"subscription-started" message for a known subscription where it is
already consuming events, it may indicate that an attacker has done
something that has momentarily disrupted receiver connectivity.<a href="#section-16-3" class="pilcrow">¶</a></p>
<p id="section-16-4">For dynamic subscriptions, implementations need to protect against
malicious or buggy subscribers that may send a large number of
"establish-subscription" requests and thereby use up system
resources.  To cover this possibility, operators <span class="bcp14">SHOULD</span> monitor for
such cases and, if discovered, take remedial action to limit the
resources used, such as suspending or terminating a subset of the
subscriptions or, if the underlying transport is session based,
terminating the underlying transport session.<a href="#section-16-4" class="pilcrow">¶</a></p>
<p id="section-16-5">Using DNS names for configured subscription's receiver "name" lookups
can cause situations where the name resolves differently than
expected on the publisher, so the recipient would be different than
expected.<a href="#section-16-5" class="pilcrow">¶</a></p>
<div id="receiver-authorization">
<section id="section-16.1">
        <h3 id="name-receiver-authorization">
<a href="#section-16.1" class="section-number selfRef">16.1. </a><a href="#name-receiver-authorization" class="section-name selfRef">Receiver Authorization</a>
        </h3>
<p id="section-16.1-1"><strong>TODO Relax when access control must be checked.</strong><a href="#section-16.1-1" class="pilcrow">¶</a></p>
<p id="section-16.1-2"><strong>TODO Consider if this is the best place in the document</strong><a href="#section-16.1-2" class="pilcrow">¶</a></p>
<p id="section-16.1-3">A receiver of subscription data <span class="bcp14">MUST</span> only be sent updates for which
it has proper authorization.  A publisher <span class="bcp14">MUST</span> ensure that no
unauthorized data is included in push updates.  To do so, it needs to
apply all corresponding checks applicable at the time of a specific
pushed update and, if necessary, silently remove any unauthorized
data from datastore subtrees.  This enables YANG data that is pushed
based on subscriptions to be authorized in a way that is equivalent
to a regular data retrieval ("get") operation.<a href="#section-16.1-3" class="pilcrow">¶</a></p>
<p id="section-16.1-4">Each "push-update" and "push-change-update" <span class="bcp14">MUST</span> have access control
applied, as depicted in Figure 5.  This includes validating that read
access is permitted for any new objects selected since the last
notification message was sent to a particular receiver.  A publisher
<span class="bcp14">MUST</span> silently omit data nodes from the results that the client is not
authorized to see.  To accomplish this, implementations <span class="bcp14">SHOULD</span> apply
the conceptual authorization model of <span>[<a href="#RFC8341" class="cite xref">RFC8341</a>]</span>, specifically
Section 3.2.4, extended to apply analogously to data nodes included
in notifications, not just &lt;rpc-reply&gt; messages sent in response to
&lt;get&gt; and &lt;get-config&gt; requests.<a href="#section-16.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-16.1-5">
<pre>
                      +-----------------+      +--------------------+
  push-update or --&gt;  | datastore node  |  yes | add datastore node |
 push-change-update   | access allowed? | ---&gt; | to update record   |
                      +-----------------+      +--------------------+

              Figure 5: Access Control for Push Updates
</pre><a href="#section-16.1-5" class="pilcrow">¶</a>
</div>
<p id="section-16.1-6">A publisher <span class="bcp14">MUST</span> allow for the possibility that a subscription's
selection filter references nonexistent data or data that a receiver
is not allowed to access.  Such support permits a receiver the
ability to monitor the entire lifecycle of some datastore tree
without needing to explicitly enumerate every individual datastore
node.  If, after access control has been applied, there are no
objects remaining in an update record, then the effect varies given
if the subscription is a periodic or on-change subscription.  For a
periodic subscription, an empty "push-update" notification <span class="bcp14">MUST</span> be
sent, so that clients do not get confused into thinking that an
update was lost.  For an on-change subscription, a "push-update"
notification <span class="bcp14">MUST NOT</span> be sent, so that clients remain unaware of
changes made to nodes they don't have read-access for.  By the same
token, changes to objects that are filtered <span class="bcp14">MUST NOT</span> affect any
dampening intervals.<a href="#section-16.1-6" class="pilcrow">¶</a></p>
<p id="section-16.1-7">A publisher <span class="bcp14">MAY</span> choose to reject an "establish-subscription" request
that selects nonexistent data or data that a receiver is not allowed
to access.  The error identity "unchanging-selection" <span class="bcp14">SHOULD</span> be
returned as the reason for the rejection.  In addition, a publisher
<span class="bcp14">MAY</span> choose to terminate a dynamic subscription or suspend a
configured receiver when the authorization privileges of a receiver
change or the access controls for subscribed objects change.  In that
case, the publisher <span class="bcp14">SHOULD</span> include the error identity "unchanging-
selection" as the reason when sending the "subscription-terminated"
or "subscription-suspended" notification, respectively.  Such a
capability enables the publisher to avoid having to support
continuous and total filtering of a subscription's content for every
update record.  It also reduces the possibility of leakage of
access-controlled objects.<a href="#section-16.1-7" class="pilcrow">¶</a></p>
<p id="section-16.1-8">If read access into previously accessible nodes has been lost due to
a receiver permissions change, this <span class="bcp14">SHOULD</span> be reported as a patch
"delete" operation for on-change subscriptions.  If not capable of
handling such receiver permission changes with such a "delete",
publisher implementations <span class="bcp14">MUST</span> force dynamic subscription
re-establishment or configured subscription reinitialization so that
appropriate filtering is installed.<a href="#section-16.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="yang-module-security-considerations">
<section id="section-16.2">
        <h3 id="name-yang-module-security-consid">
<a href="#section-16.2" class="section-number selfRef">16.2. </a><a href="#name-yang-module-security-consid" class="section-name selfRef">YANG Module Security Considerations</a>
        </h3>
<p id="section-16.2-1"><strong>TODO - Check that this section is still correct at WG LC, and before/after IESG Evaluation, if the YANG data model changes at all</strong>.<a href="#section-16.2-1" class="pilcrow">¶</a></p>
<p id="section-16.2-2">This section is modeled after the template described in Section 3.7.1 of <span>[<a href="#I-D.draft-ietf-netmod-rfc8407bis" class="cite xref">I-D.draft-ietf-netmod-rfc8407bis</a>]</span>.<a href="#section-16.2-2" class="pilcrow">¶</a></p>
<p id="section-16.2-3">The "ietf-yp-lite" YANG module defines a data model that is designed to be accessed via YANG-based management protocols, such as NETCONF <span>[<a href="#RFC6241" class="cite xref">RFC6241</a>]</span> and RESTCONF <span>[<a href="#RFC8040" class="cite xref">RFC8040</a>]</span>. These protocols have to use a secure transport layer (e.g., SSH <span>[<a href="#RFC4252" class="cite xref">RFC4252</a>]</span>, TLS <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>, and QUIC <span>[<a href="#RFC9000" class="cite xref">RFC9000</a>]</span>) and have to use mutual authentication.<a href="#section-16.2-3" class="pilcrow">¶</a></p>
<p id="section-16.2-4">The Network Configuration Access Control Model (NACM) <span>[<a href="#RFC8341" class="cite xref">RFC8341</a>]</span> provides the means to restrict access for particular NETCONF or RESTCONF users to a preconfigured subset of all available NETCONF or RESTCONF protocol operations and content.<a href="#section-16.2-4" class="pilcrow">¶</a></p>
<p id="section-16.2-5">There are a number of data nodes defined in this YANG module that are writable/creatable/deletable (i.e., "config true", which is the default).  All writable data nodes are likely to be reasonably
sensitive or vulnerable in some network environments.  Write operations (e.g., edit-config) and delete operations to these data nodes without proper protection or authentication can have a negative effect on network operations.  The following subtrees and data nodes have particular sensitivities/vulnerabilities:<a href="#section-16.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-16.2-6.1">
            <p id="section-16.2-6.1.1">There are no particularly sensitive writable data nodes.<a href="#section-16.2-6.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-16.2-7">Some of the readable data nodes in this YANG module may be considered sensitive or vulnerable in some network environments.  It is thus important to control read access (e.g., via get, get-config, or notification) to these data nodes. Specifically, the following subtrees and data nodes have particular sensitivities/vulnerabilities:<a href="#section-16.2-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-16.2-8.1">
            <p id="section-16.2-8.1.1">There are no particularly sensitive readable data nodes.<a href="#section-16.2-8.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-16.2-9">Some of the RPC or action operations in this YANG module may be considered sensitive or vulnerable in some network environments. It is thus important to control access to these operations. Specifically, the following operations have particular sensitivities/vulnerabilities:<a href="#section-16.2-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-16.2-10.1">
            <p id="section-16.2-10.1.1">kill-subscription - this RPC operation allows the caller to kill any dynamic subscription, even those created via other users, or other transport sessions.<a href="#section-16.2-10.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-16.2-11"><strong>TODO - As per the template in <span>[<a href="#I-D.draft-ietf-netmod-rfc8407bis" class="cite xref">I-D.draft-ietf-netmod-rfc8407bis</a>]</span>, we would need to add text for groupings if we add any groupings from elsewhere, or the modules define groupings that are expected to be used by other modules.</strong><a href="#section-16.2-11" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-17">
      <h2 id="name-iana-considerations">
<a href="#section-17" class="section-number selfRef">17. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-17-1">This document registers the following namespace URI in the "IETF XML Registry" <span>[<a href="#RFC3688" class="cite xref">RFC3688</a>]</span>:<a href="#section-17-1" class="pilcrow">¶</a></p>
<p id="section-17-2">URI: urn:ietf:params:xml:ns:yang:ietf-yp-lite<a href="#section-17-2" class="pilcrow">¶</a></p>
<p id="section-17-3">Registrant Contact: The IESG.<a href="#section-17-3" class="pilcrow">¶</a></p>
<p id="section-17-4">XML: N/A; the requested URI is an XML namespace.<a href="#section-17-4" class="pilcrow">¶</a></p>
<p id="section-17-5">This document registers the following YANG module in the "YANG Module Names" registry <span>[<a href="#RFC6020" class="cite xref">RFC6020</a>]</span>:<a href="#section-17-5" class="pilcrow">¶</a></p>
<p id="section-17-6">Name: ietf-yp-lite<a href="#section-17-6" class="pilcrow">¶</a></p>
<p id="section-17-7">Namespace: urn:ietf:params:xml:ns:yang:ietf-yp-lite<a href="#section-17-7" class="pilcrow">¶</a></p>
<p id="section-17-8">Prefix: ypl<a href="#section-17-8" class="pilcrow">¶</a></p>
<p id="section-17-9">Reference: RFC XXXX<a href="#section-17-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledgments">
<section id="section-18">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-18-1">This inital draft is early work is based on discussions with various folk, particularly Thomas Graf, Holger Keller, Dan Voyer, Nils Warnke, and Alex Huang Feng; but also wider conversations that include: Benoit Claise, Pierre Francois, Paolo Lucente, Jean Quilbeuf, among others.<a href="#section-18-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-combined-references">
<section id="section-19">
      <h2 id="name-references">
<a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-19.1">
        <h3 id="name-normative-references">
<a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.draft-netana-netconf-notif-envelope">[I-D.draft-netana-netconf-notif-envelope]</dt>
        <dd>
<span class="refAuthor">Feng, A. H.</span>, <span class="refAuthor">Francois, P.</span>, <span class="refAuthor">Graf, T.</span>, and <span class="refAuthor">B. Claise</span>, <span class="refTitle">"Extensible YANG model for YANG-Push Notifications"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-netana-netconf-notif-envelope-01</span>, <time datetime="2024-11-03" class="refDate">3 November 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-netana-netconf-notif-envelope-01">https://datatracker.ietf.org/doc/html/draft-netana-netconf-notif-envelope-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5277">[RFC5277]</dt>
        <dd>
<span class="refAuthor">Chisholm, S.</span> and <span class="refAuthor">H. Trevino</span>, <span class="refTitle">"NETCONF Event Notifications"</span>, <span class="seriesInfo">RFC 5277</span>, <span class="seriesInfo">DOI 10.17487/RFC5277</span>, <time datetime="2008-07" class="refDate">July 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5277">https://www.rfc-editor.org/rfc/rfc5277</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6241">[RFC6241]</dt>
        <dd>
<span class="refAuthor">Enns, R., Ed.</span>, <span class="refAuthor">Bjorklund, M., Ed.</span>, <span class="refAuthor">Schoenwaelder, J., Ed.</span>, and <span class="refAuthor">A. Bierman, Ed.</span>, <span class="refTitle">"Network Configuration Protocol (NETCONF)"</span>, <span class="seriesInfo">RFC 6241</span>, <span class="seriesInfo">DOI 10.17487/RFC6241</span>, <time datetime="2011-06" class="refDate">June 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6241">https://www.rfc-editor.org/rfc/rfc6241</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6991">[RFC6991]</dt>
        <dd>
<span class="refAuthor">Schoenwaelder, J., Ed.</span>, <span class="refTitle">"Common YANG Data Types"</span>, <span class="seriesInfo">RFC 6991</span>, <span class="seriesInfo">DOI 10.17487/RFC6991</span>, <time datetime="2013-07" class="refDate">July 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6991">https://www.rfc-editor.org/rfc/rfc6991</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7950">[RFC7950]</dt>
        <dd>
<span class="refAuthor">Bjorklund, M., Ed.</span>, <span class="refTitle">"The YANG 1.1 Data Modeling Language"</span>, <span class="seriesInfo">RFC 7950</span>, <span class="seriesInfo">DOI 10.17487/RFC7950</span>, <time datetime="2016-08" class="refDate">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7950">https://www.rfc-editor.org/rfc/rfc7950</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8340">[RFC8340]</dt>
        <dd>
<span class="refAuthor">Bjorklund, M.</span> and <span class="refAuthor">L. Berger, Ed.</span>, <span class="refTitle">"YANG Tree Diagrams"</span>, <span class="seriesInfo">BCP 215</span>, <span class="seriesInfo">RFC 8340</span>, <span class="seriesInfo">DOI 10.17487/RFC8340</span>, <time datetime="2018-03" class="refDate">March 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8340">https://www.rfc-editor.org/rfc/rfc8340</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8341">[RFC8341]</dt>
        <dd>
<span class="refAuthor">Bierman, A.</span> and <span class="refAuthor">M. Bjorklund</span>, <span class="refTitle">"Network Configuration Access Control Model"</span>, <span class="seriesInfo">STD 91</span>, <span class="seriesInfo">RFC 8341</span>, <span class="seriesInfo">DOI 10.17487/RFC8341</span>, <time datetime="2018-03" class="refDate">March 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8341">https://www.rfc-editor.org/rfc/rfc8341</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8342">[RFC8342]</dt>
        <dd>
<span class="refAuthor">Bjorklund, M.</span>, <span class="refAuthor">Schoenwaelder, J.</span>, <span class="refAuthor">Shafer, P.</span>, <span class="refAuthor">Watsen, K.</span>, and <span class="refAuthor">R. Wilton</span>, <span class="refTitle">"Network Management Datastore Architecture (NMDA)"</span>, <span class="seriesInfo">RFC 8342</span>, <span class="seriesInfo">DOI 10.17487/RFC8342</span>, <time datetime="2018-03" class="refDate">March 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8342">https://www.rfc-editor.org/rfc/rfc8342</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8529">[RFC8529]</dt>
        <dd>
<span class="refAuthor">Berger, L.</span>, <span class="refAuthor">Hopps, C.</span>, <span class="refAuthor">Lindem, A.</span>, <span class="refAuthor">Bogdanovic, D.</span>, and <span class="refAuthor">X. Liu</span>, <span class="refTitle">"YANG Data Model for Network Instances"</span>, <span class="seriesInfo">RFC 8529</span>, <span class="seriesInfo">DOI 10.17487/RFC8529</span>, <time datetime="2019-03" class="refDate">March 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8529">https://www.rfc-editor.org/rfc/rfc8529</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8791">[RFC8791]</dt>
      <dd>
<span class="refAuthor">Bierman, A.</span>, <span class="refAuthor">Björklund, M.</span>, and <span class="refAuthor">K. Watsen</span>, <span class="refTitle">"YANG Data Structure Extensions"</span>, <span class="seriesInfo">RFC 8791</span>, <span class="seriesInfo">DOI 10.17487/RFC8791</span>, <time datetime="2020-06" class="refDate">June 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8791">https://www.rfc-editor.org/rfc/rfc8791</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-19.2">
        <h3 id="name-informative-references">
<a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="Consistency">[Consistency]</dt>
        <dd>
<span class="refAuthor">Wikipedia</span>, <span class="refTitle">"Consistency (database systems)"</span>, <span>&lt;<a href="https://en.wikipedia.org/wiki/Consistency_(database_systems)">https://en.wikipedia.org/wiki/Consistency_(database_systems)</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="EventualConsistency">[EventualConsistency]</dt>
        <dd>
<span class="refAuthor">Rouse, M.</span>, <span class="refTitle">"Eventual Consistency"</span>, <span>&lt;<a href="https://www.techopedia.com/definition/29165/eventual-consistency">https://www.techopedia.com/definition/29165/eventual-consistency</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="gNMI">[gNMI]</dt>
        <dd>
<span class="refAuthor">OpenConfig</span>, <span class="refTitle">"gRPC Network Management Interface (gNMI)"</span>, <span>&lt;<a href="https://github.com/openconfig/reference/blob/master/rpc/gnmi/gnmi-specification.md">https://github.com/openconfig/reference/blob/master/rpc/gnmi/gnmi-specification.md</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.draft-ietf-netconf-http-client-server">[I-D.draft-ietf-netconf-http-client-server]</dt>
        <dd>
<span class="refAuthor">Watsen, K.</span>, <span class="refTitle">"YANG Groupings for HTTP Clients and HTTP Servers"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-netconf-http-client-server-23</span>, <time datetime="2024-08-15" class="refDate">15 August 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-netconf-http-client-server-23">https://datatracker.ietf.org/doc/html/draft-ietf-netconf-http-client-server-23</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.draft-ietf-netconf-udp-notif">[I-D.draft-ietf-netconf-udp-notif]</dt>
        <dd>
<span class="refAuthor">Zheng, G.</span>, <span class="refAuthor">Zhou, T.</span>, <span class="refAuthor">Graf, T.</span>, <span class="refAuthor">Francois, P.</span>, <span class="refAuthor">Feng, A. H.</span>, and <span class="refAuthor">P. Lucente</span>, <span class="refTitle">"UDP-based Transport for Configured Subscriptions"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-netconf-udp-notif-18</span>, <time datetime="2025-01-13" class="refDate">13 January 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-netconf-udp-notif-18">https://datatracker.ietf.org/doc/html/draft-ietf-netconf-udp-notif-18</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.draft-ietf-netmod-rfc8407bis">[I-D.draft-ietf-netmod-rfc8407bis]</dt>
        <dd>
<span class="refAuthor">Bierman, A.</span>, <span class="refAuthor">Boucadair, M.</span>, and <span class="refAuthor">Q. Wu</span>, <span class="refTitle">"Guidelines for Authors and Reviewers of Documents Containing YANG Data Models"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-netmod-rfc8407bis-22</span>, <time datetime="2025-01-14" class="refDate">14 January 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-netmod-rfc8407bis-22">https://datatracker.ietf.org/doc/html/draft-ietf-netmod-rfc8407bis-22</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-netconf-distributed-notif">[I-D.ietf-netconf-distributed-notif]</dt>
        <dd>
<span class="refAuthor">Zhou, T.</span>, <span class="refAuthor">Zheng, G.</span>, <span class="refAuthor">Voit, E.</span>, <span class="refAuthor">Graf, T.</span>, and <span class="refAuthor">P. Francois</span>, <span class="refTitle">"Subscription to Distributed Notifications"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-netconf-distributed-notif-10</span>, <time datetime="2024-10-18" class="refDate">18 October 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-netconf-distributed-notif-10">https://datatracker.ietf.org/doc/html/draft-ietf-netconf-distributed-notif-10</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-nmop-network-anomaly-architecture">[I-D.ietf-nmop-network-anomaly-architecture]</dt>
        <dd>
<span class="refAuthor">Graf, T.</span>, <span class="refAuthor">Du, W.</span>, and <span class="refAuthor">P. Francois</span>, <span class="refTitle">"An Architecture for a Network Anomaly Detection Framework"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-nmop-network-anomaly-architecture-01</span>, <time datetime="2024-10-20" class="refDate">20 October 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-nmop-network-anomaly-architecture-01">https://datatracker.ietf.org/doc/html/draft-ietf-nmop-network-anomaly-architecture-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-nmop-yang-message-broker-integration">[I-D.ietf-nmop-yang-message-broker-integration]</dt>
        <dd>
<span class="refAuthor">Graf, T.</span> and <span class="refAuthor">A. Elhassany</span>, <span class="refTitle">"An Architecture for YANG-Push to Message Broker Integration"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-nmop-yang-message-broker-integration-05</span>, <time datetime="2024-10-19" class="refDate">19 October 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-nmop-yang-message-broker-integration-05">https://datatracker.ietf.org/doc/html/draft-ietf-nmop-yang-message-broker-integration-05</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.netana-netconf-notif-envelope">[I-D.netana-netconf-notif-envelope]</dt>
        <dd>
<span class="refAuthor">Feng, A. H.</span>, <span class="refAuthor">Francois, P.</span>, <span class="refAuthor">Graf, T.</span>, and <span class="refAuthor">B. Claise</span>, <span class="refTitle">"Extensible YANG model for YANG-Push Notifications"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-netana-netconf-notif-envelope-01</span>, <time datetime="2024-11-03" class="refDate">3 November 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-netana-netconf-notif-envelope-01">https://datatracker.ietf.org/doc/html/draft-netana-netconf-notif-envelope-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.tgraf-netconf-notif-sequencing">[I-D.tgraf-netconf-notif-sequencing]</dt>
        <dd>
<span class="refAuthor">Graf, T.</span>, <span class="refAuthor">Quilbeuf, J.</span>, and <span class="refAuthor">A. H. Feng</span>, <span class="refTitle">"Support of Hostname and Sequencing in YANG Notifications"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-tgraf-netconf-notif-sequencing-06</span>, <time datetime="2024-06-29" class="refDate">29 June 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-tgraf-netconf-notif-sequencing-06">https://datatracker.ietf.org/doc/html/draft-tgraf-netconf-notif-sequencing-06</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.tgraf-netconf-yang-push-observation-time">[I-D.tgraf-netconf-yang-push-observation-time]</dt>
        <dd>
<span class="refAuthor">Graf, T.</span>, <span class="refAuthor">Claise, B.</span>, and <span class="refAuthor">A. H. Feng</span>, <span class="refTitle">"Support of Observation Timestamp in YANG-Push Notifications"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-tgraf-netconf-yang-push-observation-time-03</span>, <time datetime="2024-12-14" class="refDate">14 December 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-tgraf-netconf-yang-push-observation-time-03">https://datatracker.ietf.org/doc/html/draft-tgraf-netconf-yang-push-observation-time-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Kafka">[Kafka]</dt>
        <dd>
<span class="refAuthor">Apache.org</span>, <span class="refTitle">"Apache Kafka"</span>, <span>&lt;<a href="https://kafka.apache.org/">https://kafka.apache.org/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3411">[RFC3411]</dt>
        <dd>
<span class="refAuthor">Harrington, D.</span>, <span class="refAuthor">Presuhn, R.</span>, and <span class="refAuthor">B. Wijnen</span>, <span class="refTitle">"An Architecture for Describing Simple Network Management Protocol (SNMP) Management Frameworks"</span>, <span class="seriesInfo">STD 62</span>, <span class="seriesInfo">RFC 3411</span>, <span class="seriesInfo">DOI 10.17487/RFC3411</span>, <time datetime="2002-12" class="refDate">December 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3411">https://www.rfc-editor.org/rfc/rfc3411</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3688">[RFC3688]</dt>
        <dd>
<span class="refAuthor">Mealling, M.</span>, <span class="refTitle">"The IETF XML Registry"</span>, <span class="seriesInfo">BCP 81</span>, <span class="seriesInfo">RFC 3688</span>, <span class="seriesInfo">DOI 10.17487/RFC3688</span>, <time datetime="2004-01" class="refDate">January 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3688">https://www.rfc-editor.org/rfc/rfc3688</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4252">[RFC4252]</dt>
        <dd>
<span class="refAuthor">Ylonen, T.</span> and <span class="refAuthor">C. Lonvick, Ed.</span>, <span class="refTitle">"The Secure Shell (SSH) Authentication Protocol"</span>, <span class="seriesInfo">RFC 4252</span>, <span class="seriesInfo">DOI 10.17487/RFC4252</span>, <time datetime="2006-01" class="refDate">January 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4252">https://www.rfc-editor.org/rfc/rfc4252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6020">[RFC6020]</dt>
        <dd>
<span class="refAuthor">Bjorklund, M., Ed.</span>, <span class="refTitle">"YANG - A Data Modeling Language for the Network Configuration Protocol (NETCONF)"</span>, <span class="seriesInfo">RFC 6020</span>, <span class="seriesInfo">DOI 10.17487/RFC6020</span>, <time datetime="2010-10" class="refDate">October 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6020">https://www.rfc-editor.org/rfc/rfc6020</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6536">[RFC6536]</dt>
        <dd>
<span class="refAuthor">Bierman, A.</span> and <span class="refAuthor">M. Bjorklund</span>, <span class="refTitle">"Network Configuration Protocol (NETCONF) Access Control Model"</span>, <span class="seriesInfo">RFC 6536</span>, <span class="seriesInfo">DOI 10.17487/RFC6536</span>, <time datetime="2012-03" class="refDate">March 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6536">https://www.rfc-editor.org/rfc/rfc6536</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7049">[RFC7049]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">RFC 7049</span>, <span class="seriesInfo">DOI 10.17487/RFC7049</span>, <time datetime="2013-10" class="refDate">October 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7049">https://www.rfc-editor.org/rfc/rfc7049</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7540">[RFC7540]</dt>
        <dd>
<span class="refAuthor">Belshe, M.</span>, <span class="refAuthor">Peon, R.</span>, and <span class="refAuthor">M. Thomson, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol Version 2 (HTTP/2)"</span>, <span class="seriesInfo">RFC 7540</span>, <span class="seriesInfo">DOI 10.17487/RFC7540</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7540">https://www.rfc-editor.org/rfc/rfc7540</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7951">[RFC7951]</dt>
        <dd>
<span class="refAuthor">Lhotka, L.</span>, <span class="refTitle">"JSON Encoding of Data Modeled with YANG"</span>, <span class="seriesInfo">RFC 7951</span>, <span class="seriesInfo">DOI 10.17487/RFC7951</span>, <time datetime="2016-08" class="refDate">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7951">https://www.rfc-editor.org/rfc/rfc7951</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8040">[RFC8040]</dt>
        <dd>
<span class="refAuthor">Bierman, A.</span>, <span class="refAuthor">Bjorklund, M.</span>, and <span class="refAuthor">K. Watsen</span>, <span class="refTitle">"RESTCONF Protocol"</span>, <span class="seriesInfo">RFC 8040</span>, <span class="seriesInfo">DOI 10.17487/RFC8040</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8040">https://www.rfc-editor.org/rfc/rfc8040</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8072">[RFC8072]</dt>
        <dd>
<span class="refAuthor">Bierman, A.</span>, <span class="refAuthor">Bjorklund, M.</span>, and <span class="refAuthor">K. Watsen</span>, <span class="refTitle">"YANG Patch Media Type"</span>, <span class="seriesInfo">RFC 8072</span>, <span class="seriesInfo">DOI 10.17487/RFC8072</span>, <time datetime="2017-02" class="refDate">February 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8072">https://www.rfc-editor.org/rfc/rfc8072</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8259">[RFC8259]</dt>
        <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <span class="seriesInfo">DOI 10.17487/RFC8259</span>, <time datetime="2017-12" class="refDate">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8259">https://www.rfc-editor.org/rfc/rfc8259</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8343">[RFC8343]</dt>
        <dd>
<span class="refAuthor">Bjorklund, M.</span>, <span class="refTitle">"A YANG Data Model for Interface Management"</span>, <span class="seriesInfo">RFC 8343</span>, <span class="seriesInfo">DOI 10.17487/RFC8343</span>, <time datetime="2018-03" class="refDate">March 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8343">https://www.rfc-editor.org/rfc/rfc8343</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8639">[RFC8639]</dt>
        <dd>
<span class="refAuthor">Voit, E.</span>, <span class="refAuthor">Clemm, A.</span>, <span class="refAuthor">Gonzalez Prieto, A.</span>, <span class="refAuthor">Nilsen-Nygaard, E.</span>, and <span class="refAuthor">A. Tripathy</span>, <span class="refTitle">"Subscription to YANG Notifications"</span>, <span class="seriesInfo">RFC 8639</span>, <span class="seriesInfo">DOI 10.17487/RFC8639</span>, <time datetime="2019-09" class="refDate">September 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8639">https://www.rfc-editor.org/rfc/rfc8639</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8640">[RFC8640]</dt>
        <dd>
<span class="refAuthor">Voit, E.</span>, <span class="refAuthor">Clemm, A.</span>, <span class="refAuthor">Gonzalez Prieto, A.</span>, <span class="refAuthor">Nilsen-Nygaard, E.</span>, and <span class="refAuthor">A. Tripathy</span>, <span class="refTitle">"Dynamic Subscription to YANG Events and Datastores over NETCONF"</span>, <span class="seriesInfo">RFC 8640</span>, <span class="seriesInfo">DOI 10.17487/RFC8640</span>, <time datetime="2019-09" class="refDate">September 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8640">https://www.rfc-editor.org/rfc/rfc8640</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8641">[RFC8641]</dt>
        <dd>
<span class="refAuthor">Clemm, A.</span> and <span class="refAuthor">E. Voit</span>, <span class="refTitle">"Subscription to YANG Notifications for Datastore Updates"</span>, <span class="seriesInfo">RFC 8641</span>, <span class="seriesInfo">DOI 10.17487/RFC8641</span>, <time datetime="2019-09" class="refDate">September 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8641">https://www.rfc-editor.org/rfc/rfc8641</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9000">[RFC9000]</dt>
        <dd>
<span class="refAuthor">Iyengar, J., Ed.</span> and <span class="refAuthor">M. Thomson, Ed.</span>, <span class="refTitle">"QUIC: A UDP-Based Multiplexed and Secure Transport"</span>, <span class="seriesInfo">RFC 9000</span>, <span class="seriesInfo">DOI 10.17487/RFC9000</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9000">https://www.rfc-editor.org/rfc/rfc9000</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9535">[RFC9535]</dt>
        <dd>
<span class="refAuthor">Gössner, S., Ed.</span>, <span class="refAuthor">Normington, G., Ed.</span>, and <span class="refAuthor">C. Bormann, Ed.</span>, <span class="refTitle">"JSONPath: Query Expressions for JSON"</span>, <span class="seriesInfo">RFC 9535</span>, <span class="seriesInfo">DOI 10.17487/RFC9535</span>, <time datetime="2024-02" class="refDate">February 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9535">https://www.rfc-editor.org/rfc/rfc9535</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="XPATH">[XPATH]</dt>
      <dd>
<span class="refAuthor">W3C</span>, <span class="refTitle">"XML Path Language (XPath) Version 1.0"</span>, <span>&lt;<a href="https://www.w3.org/TR/1999/REC-xpath-19991116/">https://www.w3.org/TR/1999/REC-xpath-19991116/</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="example-configured-transport-augmentation-from-rfc-8639">
<section id="appendix-A">
      <h2 id="name-example-configured-transpor">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-example-configured-transpor" class="section-name selfRef">Example Configured Transport Augmentation (from RFC 8639)</a>
      </h2>
<p id="appendix-A-1">This appendix provides a non-normative example of how the YANG module
defined in Section 4 may be enhanced to incorporate the configuration
parameters needed to support the transport connectivity process.
This example is not intended to be a complete transport model.  In
this example, connectivity via an imaginary transport type of "foo"
is explored.  For more on the overall objectives behind configuring
transport connectivity for a configured subscription, see
Section 2.5.7.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">The YANG module example defined in this appendix contains two main
elements.  First is a transport identity "foo".  This transport
identity allows a configuration agent to define "foo" as the selected
type of transport for a subscription.  Second is a YANG case
augmentation "foo", which is made to the
"/subscriptions/subscription/receivers/receiver" node of Section 4.
In this augmentation are the transport configuration parameters
"address" and "port", which are necessary to make the connection to
the receiver.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<div class="breakable lang-yang sourcecode" id="appendix-A-3">
<pre>
module example-foo-subscribed-notifications {
  yang-version 1.1;
  namespace
    "urn:example:foo-subscribed-notifications";

  prefix fsn;

  import ietf-subscribed-notifications {
    prefix sn;
  }
  import ietf-inet-types {
    prefix inet;
  }

  description
    "Defines 'foo' as a supported type of configured transport for
    subscribed event notifications.";

  identity foo {
    base sn:transport;
    description
      "Transport type 'foo' is available for use as a configured
      subscription's transport protocol for subscribed
      notifications.";
  }

  augment
    "/sn:subscriptions/sn:subscription/sn:receivers/sn:receiver" {
    when 'derived-from(../../../transport, "fsn:foo")';
    description
      "This augmentation makes transport parameters specific to 'foo'
      available for a receiver.";
    leaf address {
      type inet:host;
      mandatory true;
      description
        "Specifies the address to use for messages destined for a
        receiver.";
    }
    leaf port {
      type inet:port-number;
      mandatory true;
      description
        "Specifies the port number to use for messages destined for a
        receiver.";
    }
  }
}

              Figure 21: Example Transport Augmentation
                  for the Fictitious Protocol "foo"
</pre><a href="#appendix-A-3" class="pilcrow">¶</a>
</div>
<p id="appendix-A-4">This example YANG module for transport "foo" will not be seen in a
real-world deployment.  For a real-world deployment supporting an
actual transport technology, a similar YANG module must be defined.<a href="#appendix-A-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="subscription-errors-from-rfc-8641">
<section id="appendix-B">
      <h2 id="name-subscription-errors-from-rf">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-subscription-errors-from-rf" class="section-name selfRef">Subscription Errors (from RFC 8641)</a>
      </h2>
<div id="rpc-failures-1">
<section id="appendix-B.1">
        <h3 id="name-rpc-failures-2">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-rpc-failures-2" class="section-name selfRef">RPC Failures</a>
        </h3>
<p id="appendix-B.1-1">Rejection of an RPC for any reason is indicated via an RPC error
response from the publisher.  Valid RPC errors returned include both
(1) existing transport-layer RPC error codes, such as those seen with
NETCONF in <span>[<a href="#RFC6241" class="cite xref">RFC6241</a>]</span> and (2) subscription-specific errors, such as
those defined in the YANG data model.  As a result, how subscription
errors are encoded in an RPC error response is transport dependent.<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
<p id="appendix-B.1-2">References to specific identities in the ietf-subscribed-
notifications YANG module <span>[<a href="#RFC8639" class="cite xref">RFC8639</a>]</span> or the ietf-yang-push YANG module
may be returned as part of the error responses resulting from failed
attempts at datastore subscription.  For errors defined as part of
the ietf-subscribed-notifications YANG module, please refer to
<span>[<a href="#RFC8639" class="cite xref">RFC8639</a>]</span>.  The errors defined in this document, grouped per RPC, are
as follows:<a href="#appendix-B.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1-3">
<pre>
      establish-subscription          modify-subscription
      ---------------------------     ---------------------
       cant-exclude                    period-unsupported
       datastore-not-subscribable      update-too-big
       on-change-unsupported           sync-too-big
       on-change-sync-unsupported      unchanging-selection
       period-unsupported
       update-too-big                 resync-subscription
       sync-too-big                   ----------------------------
       unchanging-selection            no-such-subscription-resync
                                       sync-too-big
</pre><a href="#appendix-B.1-3" class="pilcrow">¶</a>
</div>
<p id="appendix-B.1-4">There is one final set of transport-independent RPC error elements
included in the YANG data model.  These are the four yang-data
structures for failed datastore subscriptions:<a href="#appendix-B.1-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-B.1-5">
<li id="appendix-B.1-5.1">
            <p id="appendix-B.1-5.1.1">yang-data "establish-subscription-error-datastore": This <span class="bcp14">MUST</span> be
returned if information identifying the reason for an RPC error
has not been placed elsewhere in the transport portion of a
failed "establish-subscription" RPC response.  This <span class="bcp14">MUST</span> be sent
if hints are included.<a href="#appendix-B.1-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-B.1-5.2">
            <p id="appendix-B.1-5.2.1">yang-data "modify-subscription-error-datastore": This <span class="bcp14">MUST</span> be
returned if information identifying the reason for an RPC error
has not been placed elsewhere in the transport portion of a
failed "modify-subscription" RPC response.  This <span class="bcp14">MUST</span> be sent if
hints are included.<a href="#appendix-B.1-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-B.1-5.3">
            <p id="appendix-B.1-5.3.1">yang-data "sn:delete-subscription-error": This <span class="bcp14">MUST</span> be returned
if information identifying the reason for an RPC error has not
been placed elsewhere in the transport portion of a failed
"delete-subscription" or "kill-subscription" RPC response.<a href="#appendix-B.1-5.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-B.1-5.4">
            <p id="appendix-B.1-5.4.1">yang-data "resync-subscription-error": This <span class="bcp14">MUST</span> be returned if
information identifying the reason for an RPC error has not been
placed elsewhere in the transport portion of a failed
"resync-subscription" RPC response.<a href="#appendix-B.1-5.4.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="failure-notifications">
<section id="appendix-B.2">
        <h3 id="name-failure-notifications">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-failure-notifications" class="section-name selfRef">Failure Notifications</a>
        </h3>
<p id="appendix-B.2-1">A subscription may be unexpectedly terminated or suspended
independently of any RPC or configuration operation.  In such cases,
indications of such a failure <span class="bcp14">MUST</span> be provided.  To accomplish this,
a number of errors can be returned as part of the corresponding
subscription state change notification.  For this purpose, the
following error identities are introduced in this document, in
addition to those that were already defined in <span>[<a href="#RFC8639" class="cite xref">RFC8639</a>]</span>:<a href="#appendix-B.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2-2">
<pre>
  subscription-terminated        subscription-suspended
  ---------------------------    ----------------------
  datastore-not-subscribable     period-unsupported
  unchanging-selection           update-too-big
                                  synchronization-size
</pre><a href="#appendix-B.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="Examples">
<section id="appendix-C">
      <h2 id="name-examples">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
      </h2>
<p id="appendix-C-1">Notes on examples:<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-2.1">
          <p id="appendix-C-2.1.1">These examples have been given using a JSON encoding of the regular YANG-Push notification format, i.e., encoded using <span>[<a href="#RFC5277" class="cite xref">RFC5277</a>]</span>, but it is anticipated that these notifications could be defined to exclusively use the new format proposed by <span>[<a href="#I-D.netana-netconf-notif-envelope" class="cite xref">I-D.netana-netconf-notif-envelope</a>]</span>.<a href="#appendix-C-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.2">
          <p id="appendix-C-2.2.1">Some additional meta data fields, e.g., like those defined in <span>[<a href="#I-D.tgraf-netconf-notif-sequencing" class="cite xref">I-D.tgraf-netconf-notif-sequencing</a>]</span> would also likely be included, but have also been excluded to allow for slightly more concise examples.<a href="#appendix-C-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.3">
          <p id="appendix-C-2.3.1">The examples include the <span>[<a href="#I-D.tgraf-netconf-yang-push-observation-time" class="cite xref">I-D.tgraf-netconf-yang-push-observation-time</a>]</span> field for the existing YANG-Push Notification format, and the proposed equivalent "observation-time" leaf for the new update notification format.<a href="#appendix-C-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-2.4">
          <p id="appendix-C-2.4.1">All these examples are created by hand, may contain errors, and may not parse correctly.<a href="#appendix-C-2.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="example-of-an-rfc8641-style-push-update-notification">
<section id="appendix-C.1">
        <h3 id="name-example-of-an-style-push-up">
<a href="#appendix-C.1" class="section-number selfRef">C.1. </a><a href="#name-example-of-an-style-push-up" class="section-name selfRef">Example of an <span class="cite xref">[RFC8641]</span> style push-update notification</a>
        </h3>
<p id="appendix-C.1-1">This example illustrates a periodic update message for a subscription at "Cisco-IOS-XR-pfi-im-cmd-oper:interfaces" that is returning data from two internal data providers, one of which is returning data for "interface-summary" and the other that is returning data for "interfaces".  The device resident management agents stitches the reply together from the two data providers into a single data tree before returning it in a single message.<a href="#appendix-C.1-1" class="pilcrow">¶</a></p>
<p id="appendix-C.1-2">For the periodic message to be correct, and to allow it to replace any previous periodic message published on that subscription, it must include <strong>all</strong> data below the subscription path.  This may increase the total amount of internal IPC within the device and make the timestamps less accurate, since the observation timestamp only reports when the device starts polling the data providers.  If those providers are distributed across multiple processes and linecards then it may take a bit of time to complete the periodic on-change.<a href="#appendix-C.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.1-3">
<pre>
{
  "ietf-notification:notification": {
    "eventTime": "2024-09-27T14:16:27.773Z",
    "ietf-yang-push:push-update": {
      "id": 1,
      "ietf-yp-observation:timestamp": "2024-09-27T14:16:27.773Z",
      "ietf-yp-observation:point-in-time": "current-accounting",
      "datastore-contents": {
        "Cisco-IOS-XR-pfi-im-cmd-oper:interfaces": {
          "interface-summary": {
            "interface-type": [
              {
                "interface-type-name": "IFT_GETHERNET",
                "interface-type-description": "GigabitEthernet",
                "interface-counts": {
                  "interface-count": 5,
                  "up-interface-count": 2,
                  "down-interface-count": 0,
                  "admin-down-interface-count": 3
                }
              }
            ],
            "interface-counts": {
              "interface-count": 8,
              "up-interface-count": 5,
              "down-interface-count": 0,
              "admin-down-interface-count": 3
            }
          },
          "interfaces": {
            "interface": [
              {
                "interface-name": "GigabitEthernet0/0/0/0",
                "interface": "GigabitEthernet0/0/0/0",
                "state": "im-state-admin-down",
                "line-state": "im-state-admin-down"
              },
              {
                "interface-name": "GigabitEthernet0/0/0/4",
                "interface": "GigabitEthernet0/0/0/4",
                "state": "im-state-admin-down",
                "line-state": "im-state-admin-down"
              },
            ]
          }
        }
      }
    }
  }
}
</pre><a href="#appendix-C.1-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="example-of-periodic-updates-using-the-new-style-update-message">
<section id="appendix-C.2">
        <h3 id="name-example-of-periodic-updates">
<a href="#appendix-C.2" class="section-number selfRef">C.2. </a><a href="#name-example-of-periodic-updates" class="section-name selfRef">Example of periodic updates using the new style update message</a>
        </h3>
<p id="appendix-C.2-1">The subscription was made on "Cisco-IOS-XR-pfi-im-cmd-oper:interfaces", but for efficiency reasons, the device has split the subscription into separate child subscriptions for the different data providers, and makes use of the new message format.<a href="#appendix-C.2-1" class="pilcrow">¶</a></p>
<p id="appendix-C.2-2">Hence, this first periodic message is being published for the "Cisco-IOS-XR-pfi-im-cmd-oper:interfaces/interface-summary" container, but it is encoded rooted relative to the schema for "Cisco-IOS-XR-pfi-im-cmd-oper:interfaces".<a href="#appendix-C.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2-3">
<pre>
{
  "ietf-notification:notification": {
    "eventTime": "2024-09-27T14:16:27.773Z",
    "ietf-yp-ext:update": {
      "id": 1,
      "subscription-path": "Cisco-IOS-XR-pfi-im-cmd-oper:interfaces",
      "target-path":
        "Cisco-IOS-XR-pfi-im-cmd-oper:interfaces/interface-summary",
      "snapshot-type": "periodic"
      "observation-time": "2024-09-27T14:16:27.773Z",
      "datastore-snapshot": {
        "interface-summary" : {
          "interface-type": [
            {
              "interface-type-name": "IFT_GETHERNET",
              "interface-type-description": "GigabitEthernet",
              "interface-counts": {
                "interface-count": 5,
                "up-interface-count": 2,
                "down-interface-count": 0,
                "admin-down-interface-count": 3
              }
            }
          ],
          "interface-counts": {
            "interface-count": 8,
            "up-interface-count": 5,
            "down-interface-count": 0,
            "admin-down-interface-count": 3
          }
        }
      }
    }
  }
}
</pre><a href="#appendix-C.2-3" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2-4">The second periodic message is being published for the "Cisco-IOS-XR-pfi-im-cmd-oper:interfaces/interfaces/interface" list, but again, it is encoded rooted relative to the schema for "Cisco-IOS-XR-pfi-im-cmd-oper:interfaces".  This message has a separate observation time that represents the more accurate time that this periodic date was read.<a href="#appendix-C.2-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.2-5">
<pre>
{
  "ietf-notification:notification": {
    "eventTime": "2024-09-27T14:16:27.973Z",
    "ietf-yp-ext:update": {
      "id": 1,
      "subscription-path": "Cisco-IOS-XR-pfi-im-cmd-oper:interfaces",
      "target-path":
        "Cisco-IOS-XR-pfi-im-cmd-oper:interfaces/interfaces/interface[]",
      "snapshot-type": "periodic"
      "observation-time": "2024-09-27T14:16:27.973Z",
      "datastore-snapshot": {
        "interfaces": {
          "interface": [
            {
              "interface-name": "GigabitEthernet0/0/0/0",
              "interface": "GigabitEthernet0/0/0/0",
              "state": "im-state-admin-down",
              "line-state": "im-state-admin-down"
            },
            {
              "interface-name": "GigabitEthernet0/0/0/4",
              "interface": "GigabitEthernet0/0/0/4",
              "state": "im-state-admin-down",
              "line-state": "im-state-admin-down"
            },
          ]
        }
      }
    }
  }
}
</pre><a href="#appendix-C.2-5" class="pilcrow">¶</a>
</div>
<p id="appendix-C.2-6">Each child subscription would use the same period and anchor time as the configured subscription, possibly with a little bit of initial jitter to avoid all daemons attempting to publish the data at exactly the same time.<a href="#appendix-C.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="example-of-an-on-change-update-notification-using-the-new-style-update-message">
<section id="appendix-C.3">
        <h3 id="name-example-of-an-on-change-upd">
<a href="#appendix-C.3" class="section-number selfRef">C.3. </a><a href="#name-example-of-an-on-change-upd" class="section-name selfRef">Example of an on-change-update notification using the new style update message</a>
        </h3>
<p id="appendix-C.3-1">If the subscription is for on-change notifications, or periodic-and-on-change-notifications, then, if the interface state changed (specifically if the 'state' leaf of the interface changed state), and if the device was capable of generating on-change notifications, then you may see the following message.  A few points of notes here:<a href="#appendix-C.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.3-2.1">
            <p id="appendix-C.3-2.1.1">The on-change notification contains <strong>all</strong> of the state at the "target-path"<a href="#appendix-C.3-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.3-2.1.2.1">
                <p id="appendix-C.3-2.1.2.1.1">Not present in the below example, but if the notification excluded some state under an interfaces list entry (e.g., the line-state leaf) then this would logically represent the implicit deletion of that field under the given list entry.<a href="#appendix-C.3-2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="appendix-C.3-2.1.2.2">
                <p id="appendix-C.3-2.1.2.2.1">In this example it is restricted to a single interface. It could also publish an on-change notification for all interfaces, by indicating a target-path without any keys specified.  TODO - Can it represent notifications for a subset of interfaces?<a href="#appendix-C.3-2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="appendix-C.3-2.2">
            <p id="appendix-C.3-2.2.1">The schema of the change message is exactly the same as for the equivalent periodic message.  It doesn't use the YANG Patch format <span>[<a href="#RFC8072" class="cite xref">RFC8072</a>]</span> for on-change messages.<a href="#appendix-C.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.3-2.3">
            <p id="appendix-C.3-2.3.1">The "observation time" leaf represents when the system first observed the on-change event occurring.<a href="#appendix-C.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.3-2.4">
            <p id="appendix-C.3-2.4.1">The on-change event doesn't differentiate the type of change to operational state.  The on-change-update snapshot type is used to indicate the creation of a new entry or some update to some existing state.  Basically, the message can be thought of as the state existing with some current value.<a href="#appendix-C.3-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div class="alignLeft art-text artwork" id="appendix-C.3-3">
<pre>
{
  "ietf-notification:notification": {
    "eventTime": "2024-09-27T14:16:30.973Z",
    "ietf-yp-ext:update": {
      "id": 1,
      "subscription-path": "Cisco-IOS-XR-pfi-im-cmd-oper:interfaces",
      "target-path":
        "Cisco-IOS-XR-pfi-im-cmd-oper:interfaces/interfaces/
         interface[interface=GigabitEthernet0/0/0/0]",
      "snapshot-type": "on-change-update"
      "observation-time": "2024-09-27T14:16:30.973Z",
      "datastore-snapshot": {
        "interfaces": {
          "interface": [
            {
              "interface-name": "GigabitEthernet0/0/0/0",
              "interface": "GigabitEthernet0/0/0/0",
              "state": "im-state-up",
              "line-state": "im-state-up"
            }
          ]
        }
      }
    }
  }
}
</pre><a href="#appendix-C.3-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="example-of-an-on-change-delete-notification-using-the-new-style-update-message">
<section id="appendix-C.4">
        <h3 id="name-example-of-an-on-change-del">
<a href="#appendix-C.4" class="section-number selfRef">C.4. </a><a href="#name-example-of-an-on-change-del" class="section-name selfRef">Example of an on-change-delete notification using the new style update message</a>
        </h3>
<p id="appendix-C.4-1">If the interface was deleted, and if the system was capable of reporting on-change events for the delete event, then an on-change delete message would be encoded as per the following message.  Of note:<a href="#appendix-C.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.4-2.1">
            <p id="appendix-C.4-2.1.1">The on-change-delete snapshot type doesn't include a "datastore-snapshot", instead it represents a delete of the list entry at the path identified by the target-path, which is similar to a YANG Patch delete notification.<a href="#appendix-C.4-2.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div class="alignLeft art-text artwork" id="appendix-C.4-3">
<pre>
{
  "ietf-notification:notification": {
    "eventTime": "2024-09-27T14:16:40.973Z",
    "ietf-yp-ext:update": {
      "id": 1,
      "subscription-path": "Cisco-IOS-XR-pfi-im-cmd-oper:interfaces",
      "target-path":
        "Cisco-IOS-XR-pfi-im-cmd-oper:interfaces/interfaces/
         interface[interface=GigabitEthernet0/0/0/0]",
      "snapshot-type": "on-change-delete"
      "observation-time": "2024-09-27T14:16:40.973Z",
    }
  }
}
</pre><a href="#appendix-C.4-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="subscription-rpc-examples-from-rfc-8641">
<section id="appendix-C.5">
        <h3 id="name-subscription-rpc-examples-f">
<a href="#appendix-C.5" class="section-number selfRef">C.5. </a><a href="#name-subscription-rpc-examples-f" class="section-name selfRef">Subscription RPC examples (from RFC 8641)</a>
        </h3>
<p id="appendix-C.5-1">YANG-Push subscriptions are established, modified, and deleted using
RPCs augmented from <span>[<a href="#RFC8639" class="cite xref">RFC8639</a>]</span>.<a href="#appendix-C.5-1" class="pilcrow">¶</a></p>
<div id="establish-subscription-rpc">
<section id="appendix-C.5.1">
          <h4 id="name-establish-subscription-rpc">
<a href="#appendix-C.5.1" class="section-number selfRef">C.5.1. </a><a href="#name-establish-subscription-rpc" class="section-name selfRef">"establish-subscription" RPC</a>
          </h4>
<p id="appendix-C.5.1-1">The subscriber sends an "establish-subscription" RPC with the
parameters listed in Section 3.1.  An example might look like:<a href="#appendix-C.5.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.5.1-2">
<pre>
 &lt;netconf:rpc message-id="101"
     xmlns:netconf="urn:ietf:params:xml:ns:netconf:base:1.0"&gt;
   &lt;establish-subscription
       xmlns="urn:ietf:params:xml:ns:yang:ietf-subscribed-notifications"
       xmlns:yp="urn:ietf:params:xml:ns:yang:ietf-yang-push"&gt;
     &lt;yp:datastore
          xmlns:ds="urn:ietf:params:xml:ns:yang:ietf-datastores"&gt;
       ds:operational
     &lt;/yp:datastore&gt;
     &lt;yp:datastore-xpath-filter
         xmlns:ex="https://example.com/sample-data/1.0"&gt;
       /ex:foo
     &lt;/yp:datastore-xpath-filter&gt;
     &lt;yp:periodic&gt;
       &lt;yp:period&gt;500&lt;/yp:period&gt;
     &lt;/yp:periodic&gt;
   &lt;/establish-subscription&gt;
 &lt;/netconf:rpc&gt;

                  Figure 10: "establish-subscription" RPC
</pre><a href="#appendix-C.5.1-2" class="pilcrow">¶</a>
</div>
<p id="appendix-C.5.1-3">A positive response includes the "id" of the accepted subscription.
In that case, a publisher may respond as follows:<a href="#appendix-C.5.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.5.1-4">
<pre>
 &lt;rpc-reply message-id="101"
    xmlns="urn:ietf:params:xml:ns:netconf:base:1.0"&gt;
    &lt;id
      xmlns="urn:ietf:params:xml:ns:yang:ietf-subscribed-notifications"&gt;
       52
    &lt;/id&gt;
 &lt;/rpc-reply&gt;

         Figure 11: "establish-subscription" Positive RPC Response
</pre><a href="#appendix-C.5.1-4" class="pilcrow">¶</a>
</div>
<p id="appendix-C.5.1-5">A subscription can be rejected for multiple reasons, including the
lack of authorization to establish a subscription, no capacity to
serve the subscription at the publisher, or the inability of the
publisher to select datastore content at the requested cadence.<a href="#appendix-C.5.1-5" class="pilcrow">¶</a></p>
<p id="appendix-C.5.1-6">If a request is rejected because the publisher is not able to serve
it, the publisher <span class="bcp14">SHOULD</span> include in the returned error hints that
help a subscriber understand what subscription parameters might have
been accepted for the request.  These hints would be included in the
yang-data structure "establish-subscription-error-datastore".
However, even with these hints, there are no guarantees that
subsequent requests will in fact be accepted.<a href="#appendix-C.5.1-6" class="pilcrow">¶</a></p>
<p id="appendix-C.5.1-7">The specific parameters to be returned as part of the RPC error
response depend on the specific transport that is used to manage the
subscription.  For NETCONF, those parameters are defined in
<span>[<a href="#RFC8640" class="cite xref">RFC8640</a>]</span>.  For example, for the following NETCONF request:<a href="#appendix-C.5.1-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.5.1-8">
<pre>
  &lt;rpc message-id="101"
      xmlns="urn:ietf:params:xml:ns:netconf:base:1.0"&gt;
    &lt;establish-subscription
        xmlns=
          "urn:ietf:params:xml:ns:yang:ietf-subscribed-notifications"
        xmlns:yp="urn:ietf:params:xml:ns:yang:ietf-yang-push"&gt;
      &lt;yp:datastore
          xmlns:ds="urn:ietf:params:xml:ns:yang:ietf-datastores"&gt;
        ds:operational
      &lt;/yp:datastore&gt;
      &lt;yp:datastore-xpath-filter
          xmlns:ex="https://example.com/sample-data/1.0"&gt;
        /ex:foo
      &lt;/yp:datastore-xpath-filter&gt;
      &lt;yp:on-change&gt;
        &lt;yp:dampening-period&gt;100&lt;/yp:dampening-period&gt;
      &lt;/yp:on-change&gt;
    &lt;/establish-subscription&gt;
  &lt;/rpc&gt;

      Figure 12: "establish-subscription" Request: Example 2
</pre><a href="#appendix-C.5.1-8" class="pilcrow">¶</a>
</div>
<p id="appendix-C.5.1-9">A publisher that cannot serve on-change updates but can serve
periodic updates might return the following NETCONF response:<a href="#appendix-C.5.1-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.5.1-10">
<pre>
 &lt;rpc-reply message-id="101"
   xmlns="urn:ietf:params:xml:ns:netconf:base:1.0"
   xmlns:yp="urn:ietf:params:xml:ns:yang:ietf-subscribed-notifications"&gt;
   &lt;rpc-error&gt;
     &lt;error-type&gt;application&lt;/error-type&gt;
     &lt;error-tag&gt;operation-failed&lt;/error-tag&gt;
     &lt;error-severity&gt;error&lt;/error-severity&gt;
     &lt;error-path&gt;/yp:periodic/yp:period&lt;/error-path&gt;
     &lt;error-info&gt;
       &lt;yp:establish-subscription-error-datastore&gt;
         &lt;yp:reason&gt;yp:on-change-unsupported&lt;/yp:reason&gt;
       &lt;/yp:establish-subscription-error-datastore&gt;
     &lt;/error-info&gt;
   &lt;/rpc-error&gt;
 &lt;/rpc-reply&gt;

       Figure 13: "establish-subscription" Error Response: Example 2
</pre><a href="#appendix-C.5.1-10" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="delete-subscription-rpc">
<section id="appendix-C.5.2">
          <h4 id="name-delete-subscription-rpc">
<a href="#appendix-C.5.2" class="section-number selfRef">C.5.2. </a><a href="#name-delete-subscription-rpc" class="section-name selfRef">"delete-subscription" RPC</a>
          </h4>
<p id="appendix-C.5.2-1">To stop receiving updates from a subscription and effectively delete
a subscription that had previously been established using an
"establish-subscription" RPC, a subscriber can send a
"delete-subscription" RPC, which takes as its only input the
subscription's "id".  This RPC is unmodified from <span>[<a href="#RFC8639" class="cite xref">RFC8639</a>]</span>.<a href="#appendix-C.5.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="resync-subscription-rpc">
<section id="appendix-C.5.3">
          <h4 id="name-resync-subscription-rpc">
<a href="#appendix-C.5.3" class="section-number selfRef">C.5.3. </a><a href="#name-resync-subscription-rpc" class="section-name selfRef">"resync-subscription" RPC</a>
          </h4>
<p id="appendix-C.5.3-1">This RPC is supported only for on-change subscriptions previously
established using an "establish-subscription" RPC.  For example:<a href="#appendix-C.5.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.5.3-2">
<pre>
  &lt;rpc message-id="103"
        xmlns="urn:ietf:params:xml:ns:netconf:base:1.0"&gt;
    &lt;resync-subscription
        xmlns="urn:ietf:params:xml:ns:yang:ietf-yang-push"&gt;
      &lt;id&gt;1011&lt;/id&gt;
    &lt;/resync-subscription&gt;
  &lt;/rpc&gt;

                  Figure 15: "resync-subscription"
</pre><a href="#appendix-C.5.3-2" class="pilcrow">¶</a>
</div>
<p id="appendix-C.5.3-3">On receipt, a publisher must either (1) accept the request and
quickly follow with a "push-update" or (2) send an appropriate error
in an RPC error response.  In its error response, the publisher <span class="bcp14">MAY</span>
include, in the yang-data structure "resync-subscription-error",
supplemental information about the reasons for the error.<a href="#appendix-C.5.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Robert Wilton</span></div>
<div dir="auto" class="left"><span class="org">Cisco Systems</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rwilton@cisco.com" class="email">rwilton@cisco.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
